<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Appendices | Practical Spatial Data</title>
  <meta name="description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Appendices | Practical Spatial Data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://lugoga.github.io/geomarine/" />
  <meta property="og:image" content="https://lugoga.github.io/geomarine/images/coverPage.svg" />
  <meta property="og:description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="github-repo" content="lugoga/geomarine" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Appendices | Practical Spatial Data" />
  
  <meta name="twitter:description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="twitter:image" content="https://lugoga.github.io/geomarine/images/coverPage.svg" />

<meta name="author" content="Masumbuko Semba" />


<meta name="date" content="2021-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="maps.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.16/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Practical Spatial Data: Coastal and Mrine in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-will-you-learn"><i class="fa fa-check"></i>What will you learn?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#audience"><i class="fa fa-check"></i>Audience</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-book-came-to-being"><i class="fa fa-check"></i>How this book came to being</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#gis-software"><i class="fa fa-check"></i><b>1.2</b> GIS software</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#arcgis"><i class="fa fa-check"></i><b>1.2.1</b> ArcGIS</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#qgis"><i class="fa fa-check"></i><b>1.2.2</b> QGIS</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#r"><i class="fa fa-check"></i><b>1.2.3</b> R</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#why-r"><i class="fa fa-check"></i><b>1.2.4</b> Why R?</a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>1.2.5</b> Rstudio</a></li>
<li class="chapter" data-level="1.2.6" data-path="intro.html"><a href="intro.html#why-rstudio"><i class="fa fa-check"></i><b>1.2.6</b> Why RStudio?</a></li>
<li class="chapter" data-level="1.2.7" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.2.7</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#communication-of-results"><i class="fa fa-check"></i><b>1.3</b> Communication of results</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html"><i class="fa fa-check"></i><b>2</b> A glimpse of R, Rstudio and Packages</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#the-data-analysis-workflow"><i class="fa fa-check"></i><b>2.1</b> The Data Analysis Workflow</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#data-wrangling"><i class="fa fa-check"></i><b>2.1.1</b> Data Wrangling</a></li>
<li class="chapter" data-level="2.1.2" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#importing-data"><i class="fa fa-check"></i><b>2.1.2</b> Importing Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#tidying-data"><i class="fa fa-check"></i><b>2.1.3</b> Tidying Data</a></li>
<li class="chapter" data-level="2.1.4" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#transforming-data"><i class="fa fa-check"></i><b>2.1.4</b> Transforming Data</a></li>
<li class="chapter" data-level="2.1.5" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#visualizing-data"><i class="fa fa-check"></i><b>2.1.5</b> Visualizing Data</a></li>
<li class="chapter" data-level="2.1.6" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#models"><i class="fa fa-check"></i><b>2.1.6</b> Models</a></li>
<li class="chapter" data-level="2.1.7" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#data-collaboration-and-publishing"><i class="fa fa-check"></i><b>2.1.7</b> Data Collaboration and Publishing</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#installation"><i class="fa fa-check"></i><b>2.2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#installing-r"><i class="fa fa-check"></i><b>2.2.1</b> Installing R</a></li>
<li class="chapter" data-level="2.2.2" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="2.2.3" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#installing-packages"><i class="fa fa-check"></i><b>2.2.3</b> Installing Packages</a></li>
<li class="chapter" data-level="2.2.4" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#other-packages"><i class="fa fa-check"></i><b>2.2.4</b> Other packages</a></li>
<li class="chapter" data-level="2.2.5" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#loading-installed-packages"><i class="fa fa-check"></i><b>2.2.5</b> Loading installed packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataTypes.html"><a href="dataTypes.html"><i class="fa fa-check"></i><b>3</b> Understanding Data in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataTypes.html"><a href="dataTypes.html#data-types"><i class="fa fa-check"></i><b>3.1</b> Data Types</a></li>
<li class="chapter" data-level="3.2" data-path="dataTypes.html"><a href="dataTypes.html#vectors"><i class="fa fa-check"></i><b>3.2</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dataTypes.html"><a href="dataTypes.html#numeric-vector"><i class="fa fa-check"></i><b>3.2.1</b> Numeric Vector</a></li>
<li class="chapter" data-level="3.2.2" data-path="dataTypes.html"><a href="dataTypes.html#integer-vector"><i class="fa fa-check"></i><b>3.2.2</b> Integer vector</a></li>
<li class="chapter" data-level="3.2.3" data-path="dataTypes.html"><a href="dataTypes.html#character-vector"><i class="fa fa-check"></i><b>3.2.3</b> Character vector</a></li>
<li class="chapter" data-level="3.2.4" data-path="dataTypes.html"><a href="dataTypes.html#factor-vector"><i class="fa fa-check"></i><b>3.2.4</b> Factor vector</a></li>
<li class="chapter" data-level="3.2.5" data-path="dataTypes.html"><a href="dataTypes.html#logical-vector"><i class="fa fa-check"></i><b>3.2.5</b> Logical Vector</a></li>
<li class="chapter" data-level="3.2.6" data-path="dataTypes.html"><a href="dataTypes.html#date-and-time"><i class="fa fa-check"></i><b>3.2.6</b> Date and Time</a></li>
<li class="chapter" data-level="3.2.7" data-path="dataTypes.html"><a href="dataTypes.html#indexing-the-element"><i class="fa fa-check"></i><b>3.2.7</b> Indexing the element</a></li>
<li class="chapter" data-level="3.2.8" data-path="dataTypes.html"><a href="dataTypes.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>3.2.8</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="3.2.9" data-path="dataTypes.html"><a href="dataTypes.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>3.2.9</b> Number of elements in a vector</a></li>
<li class="chapter" data-level="3.2.10" data-path="dataTypes.html"><a href="dataTypes.html#generating-sequence-of-vectors-numbers"><i class="fa fa-check"></i><b>3.2.10</b> Generating sequence of vectors Numbers</a></li>
<li class="chapter" data-level="3.2.11" data-path="dataTypes.html"><a href="dataTypes.html#generating-vector-of-normal-distribution"><i class="fa fa-check"></i><b>3.2.11</b> Generating vector of normal distribution</a></li>
<li class="chapter" data-level="3.2.12" data-path="dataTypes.html"><a href="dataTypes.html#rounding-off-numbers"><i class="fa fa-check"></i><b>3.2.12</b> Rounding off numbers</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataTypes.html"><a href="dataTypes.html#data-frame"><i class="fa fa-check"></i><b>3.3</b> Data Frame</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-data-frames"><i class="fa fa-check"></i><b>3.3.1</b> Creating data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataTypes.html"><a href="dataTypes.html#matrix"><i class="fa fa-check"></i><b>3.4</b> Matrix</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-matrices"><i class="fa fa-check"></i><b>3.4.1</b> Creating Matrices</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataTypes.html"><a href="dataTypes.html#adding-attributes-to-matrices"><i class="fa fa-check"></i><b>3.4.2</b> Adding attributes to Matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataTypes.html"><a href="dataTypes.html#arrays"><i class="fa fa-check"></i><b>3.5</b> Arrays</a></li>
<li class="chapter" data-level="3.6" data-path="dataTypes.html"><a href="dataTypes.html#dealing-with-misiing-values"><i class="fa fa-check"></i><b>3.6</b> Dealing with Misiing Values</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>4</b> Importing data with <strong>readr</strong></a>
<ul>
<li class="chapter" data-level="4.1" data-path="readr.html"><a href="readr.html#getting-data-into-r"><i class="fa fa-check"></i><b>4.1</b> Getting Data into R</a></li>
<li class="chapter" data-level="4.2" data-path="readr.html"><a href="readr.html#comma-separated-.csv"><i class="fa fa-check"></i><b>4.2</b> Comma-Separated (.csv)</a></li>
<li class="chapter" data-level="4.3" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>4.3</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="4.4" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>4.4</b> Writing t a File</a></li>
<li class="chapter" data-level="4.5" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>4.5</b> Basic Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>4.5.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="4.5.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>4.5.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>5</b> Reshaping data with <strong>tidyr</strong></a>
<ul>
<li class="chapter" data-level="5.1" data-path="tidy.html"><a href="tidy.html#what-is-tidy-data"><i class="fa fa-check"></i><b>5.1</b> What is Tidy Data?</a></li>
<li class="chapter" data-level="5.2" data-path="tidy.html"><a href="tidy.html#gatherfrom-wide-to-long-format."><i class="fa fa-check"></i><b>5.2</b> Gather—from wide to long format.</a></li>
<li class="chapter" data-level="5.3" data-path="tidy.html"><a href="tidy.html#spreadfrom-long-to-wide-format"><i class="fa fa-check"></i><b>5.3</b> spread—from long to wide format</a></li>
<li class="chapter" data-level="5.4" data-path="tidy.html"><a href="tidy.html#separate-columns"><i class="fa fa-check"></i><b>5.4</b> separate columns</a></li>
<li class="chapter" data-level="5.5" data-path="tidy.html"><a href="tidy.html#unite-columns"><i class="fa fa-check"></i><b>5.5</b> unite columns</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Manipulating Data with <strong>dplyr</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#why-use-dplyr"><i class="fa fa-check"></i><b>6.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#core-dplyr-functions"><i class="fa fa-check"></i><b>6.2</b> Core dplyr Functions</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#data"><i class="fa fa-check"></i><b>6.3</b> Data</a></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filtering-observations"><i class="fa fa-check"></i><b>6.4</b> Choosing rows: Filtering observations</a></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>6.5</b> select</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>6.5.1</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="6.5.2" data-path="dplyr.html"><a href="dplyr.html#arranging-rows"><i class="fa fa-check"></i><b>6.5.2</b> Arranging rows</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#summarizing-and-grouping"><i class="fa fa-check"></i><b>6.6</b> Summarizing and Grouping</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Plotting in R with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#a-dataset"><i class="fa fa-check"></i><b>7.1</b> A dataset</a></li>
<li class="chapter" data-level="7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#components-of-ggplot-objects-components"><i class="fa fa-check"></i><b>7.2</b> Components of ggplot objects {components}</a></li>
<li class="chapter" data-level="7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#building-a-plot"><i class="fa fa-check"></i><b>7.3</b> Building a plot</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#plotting-layers"><i class="fa fa-check"></i><b>7.3.1</b> Plotting layers</a></li>
<li class="chapter" data-level="7.3.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-legend"><i class="fa fa-check"></i><b>7.3.2</b> Customize legend</a></li>
<li class="chapter" data-level="7.3.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#working-with-titles-and-labels"><i class="fa fa-check"></i><b>7.3.3</b> Working with titles and labels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-glidline-and-axis-labels"><i class="fa fa-check"></i><b>7.4</b> Customize glidline and axis labels</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#remove-the-gray-box-of-points-on-legend"><i class="fa fa-check"></i><b>7.4.1</b> Remove the gray box of points on legend</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-the-position-of-the-legend"><i class="fa fa-check"></i><b>7.5</b> Modify the position of the legend</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-legend-background-and-stroke-color"><i class="fa fa-check"></i><b>7.5.1</b> Change the legend background and stroke color</a></li>
<li class="chapter" data-level="7.5.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-background-colors"><i class="fa fa-check"></i><b>7.5.2</b> Modify background colors</a></li>
<li class="chapter" data-level="7.5.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-gridlines"><i class="fa fa-check"></i><b>7.5.3</b> change the gridlines</a></li>
<li class="chapter" data-level="7.5.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-font-size-for-axis-labels-and-titles"><i class="fa fa-check"></i><b>7.5.4</b> Change the font size for axis, labels and titles</a></li>
<li class="chapter" data-level="7.5.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#limit-axis-to-a-range"><i class="fa fa-check"></i><b>7.5.5</b> Limit axis to a range</a></li>
<li class="chapter" data-level="7.5.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-labels"><i class="fa fa-check"></i><b>7.5.6</b> Adding labels</a></li>
<li class="chapter" data-level="7.5.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-text-annotation"><i class="fa fa-check"></i><b>7.5.7</b> Add text annotation</a></li>
<li class="chapter" data-level="7.5.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#make-the-x-and-y-axis-the-same"><i class="fa fa-check"></i><b>7.5.8</b> Make the x and y axis the same</a></li>
<li class="chapter" data-level="7.5.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#faceting-creating-multipanel-plots"><i class="fa fa-check"></i><b>7.5.9</b> Faceting —Creating multi–panel plots</a></li>
<li class="chapter" data-level="7.5.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#allow-scales-to-roam-free-scales"><i class="fa fa-check"></i><b>7.5.10</b> Allow scales to roam free (scales)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#basic-plots"><i class="fa fa-check"></i><b>7.6</b> Basic plots</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scatterplot"><i class="fa fa-check"></i><b>7.6.1</b> scatterplot</a></li>
<li class="chapter" data-level="7.6.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-regression-line"><i class="fa fa-check"></i><b>7.6.2</b> adding regression line</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#linegraph"><i class="fa fa-check"></i><b>7.7</b> Linegraph</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#histogram"><i class="fa fa-check"></i><b>7.7.1</b> histogram</a></li>
<li class="chapter" data-level="7.7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#boxplot"><i class="fa fa-check"></i><b>7.7.2</b> boxplot</a></li>
<li class="chapter" data-level="7.7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot"><i class="fa fa-check"></i><b>7.7.3</b> barplot</a></li>
<li class="chapter" data-level="7.7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot-for-values"><i class="fa fa-check"></i><b>7.7.4</b> barplot for values</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#advanced-plots"><i class="fa fa-check"></i><b>7.8</b> Advanced plots</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>7.8.1</b> Facets</a></li>
<li class="chapter" data-level="7.8.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#sea-surface-temperature"><i class="fa fa-check"></i><b>7.8.2</b> Sea Surface Temperature</a></li>
<li class="chapter" data-level="7.8.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#subplot"><i class="fa fa-check"></i><b>7.8.3</b> Subplot</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#colour"><i class="fa fa-check"></i><b>7.9</b> Colour</a></li>
<li class="chapter" data-level="7.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#size"><i class="fa fa-check"></i><b>7.10</b> size</a></li>
<li class="chapter" data-level="7.11" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scaling"><i class="fa fa-check"></i><b>7.11</b> scaling</a></li>
<li class="chapter" data-level="7.12" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#guides"><i class="fa fa-check"></i><b>7.12</b> Guides</a></li>
<li class="chapter" data-level="7.13" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>7.13</b> Add-on packages</a></li>
<li class="chapter" data-level="7.14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#ggridges"><i class="fa fa-check"></i><b>7.14</b> ggridges</a></li>
<li class="chapter" data-level="7.15" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#varying-fill-colors-along-the-x-axis"><i class="fa fa-check"></i><b>7.15</b> Varying fill colors along the x axis</a></li>
<li class="chapter" data-level="7.16" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#metr"><i class="fa fa-check"></i><b>7.16</b> metR</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html"><i class="fa fa-check"></i><b>8</b> A grammar for graphics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#geoms"><i class="fa fa-check"></i><b>8.1</b> geoms</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#regression-line"><i class="fa fa-check"></i><b>8.1.1</b> Regression Line</a></li>
<li class="chapter" data-level="8.1.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#horizontal-vertical-lines"><i class="fa fa-check"></i><b>8.1.2</b> Horizontal/ vertical lines</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#aes"><i class="fa fa-check"></i><b>8.2</b> aes()</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#color"><i class="fa fa-check"></i><b>8.2.1</b> Color</a></li>
<li class="chapter" data-level="8.2.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#shape"><i class="fa fa-check"></i><b>8.2.2</b> shape</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#axis-and-labels"><i class="fa fa-check"></i><b>8.3</b> Axis and labels</a></li>
<li class="chapter" data-level="8.4" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#text-annotaion"><i class="fa fa-check"></i><b>8.4</b> Text annotaion</a></li>
<li class="chapter" data-level="8.5" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#scales"><i class="fa fa-check"></i><b>8.5</b> Scales</a></li>
<li class="chapter" data-level="8.6" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#guides-1"><i class="fa fa-check"></i><b>8.6</b> Guides</a></li>
<li class="chapter" data-level="8.7" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#themes"><i class="fa fa-check"></i><b>8.7</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="feature.html"><a href="feature.html"><i class="fa fa-check"></i><b>9</b> Feature Representation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="feature.html"><a href="feature.html#vector"><i class="fa fa-check"></i><b>9.1</b> Vector</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="feature.html"><a href="feature.html#a-point"><i class="fa fa-check"></i><b>9.1.1</b> A point</a></li>
<li class="chapter" data-level="9.1.2" data-path="feature.html"><a href="feature.html#polyline"><i class="fa fa-check"></i><b>9.1.2</b> Polyline</a></li>
<li class="chapter" data-level="9.1.3" data-path="feature.html"><a href="feature.html#polygon"><i class="fa fa-check"></i><b>9.1.3</b> Polygon</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="feature.html"><a href="feature.html#raster"><i class="fa fa-check"></i><b>9.2</b> Raster</a></li>
<li class="chapter" data-level="9.3" data-path="feature.html"><a href="feature.html#important-gis-data-formats"><i class="fa fa-check"></i><b>9.3</b> Important GIS data formats</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="feature.html"><a href="feature.html#shapefiles"><i class="fa fa-check"></i><b>9.3.1</b> Shapefiles</a></li>
<li class="chapter" data-level="9.3.2" data-path="feature.html"><a href="feature.html#raster-1"><i class="fa fa-check"></i><b>9.3.2</b> Raster</a></li>
<li class="chapter" data-level="9.3.3" data-path="feature.html"><a href="feature.html#attribute-tables"><i class="fa fa-check"></i><b>9.3.3</b> Attribute Tables</a></li>
<li class="chapter" data-level="9.3.4" data-path="feature.html"><a href="feature.html#geodatabase"><i class="fa fa-check"></i><b>9.3.4</b> Geodatabase</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="feature.html"><a href="feature.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>9.4</b> Coordinate reference systems</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="feature.html"><a href="feature.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.4.1</b> Geographic coordinate systems</a></li>
<li class="chapter" data-level="9.4.2" data-path="feature.html"><a href="feature.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.4.2</b> Projected coordinate systems</a></li>
<li class="chapter" data-level="9.4.3" data-path="feature.html"><a href="feature.html#setting-coordinate-reference-systems-in-r"><i class="fa fa-check"></i><b>9.4.3</b> Setting Coordinate Reference Systems in R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="feature.html"><a href="feature.html#practicals"><i class="fa fa-check"></i><b>9.5</b> Practicals</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="feature.html"><a href="feature.html#plotting-point-data"><i class="fa fa-check"></i><b>9.5.1</b> Plotting Point Data</a></li>
<li class="chapter" data-level="9.5.2" data-path="feature.html"><a href="feature.html#geographic-coordinate-sytem"><i class="fa fa-check"></i><b>9.5.2</b> Geographic Coordinate Sytem</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="feature.html"><a href="feature.html#summary"><i class="fa fa-check"></i><b>9.6</b> Summary</a></li>
<li class="chapter" data-level="9.7" data-path="feature.html"><a href="feature.html#questions"><i class="fa fa-check"></i><b>9.7</b> Questions</a></li>
<li class="chapter" data-level="9.8" data-path="feature.html"><a href="feature.html#further-readings"><i class="fa fa-check"></i><b>9.8</b> FUrther readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html"><i class="fa fa-check"></i><b>10</b> Creating Geospatial Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#getting-data-from-the-web"><i class="fa fa-check"></i><b>10.1</b> Getting data from the web</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#usage"><i class="fa fa-check"></i><b>10.1.1</b> Usage</a></li>
<li class="chapter" data-level="10.1.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#to-download-natural-earth-data-not-already-in-the-package"><i class="fa fa-check"></i><b>10.1.2</b> To download Natural Earth data not already in the package</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-point-data"><i class="fa fa-check"></i><b>10.2</b> Creating Point Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-point-features"><i class="fa fa-check"></i><b>10.2.1</b> Creating point features</a></li>
<li class="chapter" data-level="10.2.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-line-features"><i class="fa fa-check"></i><b>10.2.2</b> Creating line features</a></li>
<li class="chapter" data-level="10.2.3" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-polygon-features"><i class="fa fa-check"></i><b>10.2.3</b> Creating Polygon features</a></li>
<li class="chapter" data-level="10.2.4" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#adding-features-to-vector-data"><i class="fa fa-check"></i><b>10.2.4</b> Adding features to vector data</a></li>
<li class="chapter" data-level="10.2.5" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#digitizing-a-map"><i class="fa fa-check"></i><b>10.2.5</b> Digitizing a map</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#summary-1"><i class="fa fa-check"></i><b>10.3</b> Summary</a></li>
<li class="chapter" data-level="10.4" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#questions-1"><i class="fa fa-check"></i><b>10.4</b> Questions</a></li>
<li class="chapter" data-level="10.5" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#further-reading"><i class="fa fa-check"></i><b>10.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html"><i class="fa fa-check"></i><b>11</b> Working with vector data in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#combining-shapefile-in-r"><i class="fa fa-check"></i><b>11.1</b> Combining shapefile in R</a></li>
<li class="chapter" data-level="11.2" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#clipping-in-r"><i class="fa fa-check"></i><b>11.2</b> Clipping in R</a></li>
<li class="chapter" data-level="11.3" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#differences-in-r"><i class="fa fa-check"></i><b>11.3</b> DIfferences in R</a></li>
<li class="chapter" data-level="11.4" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#area-calculation-in-r"><i class="fa fa-check"></i><b>11.4</b> Area calculation in R</a></li>
<li class="chapter" data-level="11.5" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#buffer"><i class="fa fa-check"></i><b>11.5</b> Buffer</a></li>
<li class="chapter" data-level="11.6" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#intersection"><i class="fa fa-check"></i><b>11.6</b> Intersection</a></li>
<li class="chapter" data-level="11.7" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#statistical-summary-of-vector-layers"><i class="fa fa-check"></i><b>11.7</b> Statistical summary of vector layers</a></li>
<li class="chapter" data-level="11.8" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#summary-2"><i class="fa fa-check"></i><b>11.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html"><i class="fa fa-check"></i><b>12</b> Working with raster data in R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#nc-data"><i class="fa fa-check"></i><b>12.1</b> NC data</a></li>
<li class="chapter" data-level="12.2" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#changing-the-projection-system-of-a-raster-file"><i class="fa fa-check"></i><b>12.2</b> Changing the projection system of a raster file</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#reading-tiff-format"><i class="fa fa-check"></i><b>12.2.1</b> Reading Tiff format</a></li>
<li class="chapter" data-level="12.2.2" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#reclassifying-rasters"><i class="fa fa-check"></i><b>12.2.2</b> Reclassifying rasters</a></li>
<li class="chapter" data-level="12.2.3" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#mapping-raster"><i class="fa fa-check"></i><b>12.2.3</b> Mapping raster</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#summary-3"><i class="fa fa-check"></i><b>12.3</b> Summary</a></li>
<li class="chapter" data-level="12.4" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#questions-2"><i class="fa fa-check"></i><b>12.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>13</b> Maps</a>
<ul>
<li class="chapter" data-level="13.1" data-path="maps.html"><a href="maps.html#geographical-data-in-a-tidy-format"><i class="fa fa-check"></i><b>13.1</b> Geographical data in a tidy format</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="maps.html"><a href="maps.html#create-simple-feature-from-data.frame"><i class="fa fa-check"></i><b>13.1.1</b> Create simple feature from data.frame</a></li>
<li class="chapter" data-level="13.1.2" data-path="maps.html"><a href="maps.html#importing-shapefile"><i class="fa fa-check"></i><b>13.1.2</b> Importing shapefile</a></li>
<li class="chapter" data-level="13.1.3" data-path="maps.html"><a href="maps.html#reading-other-format"><i class="fa fa-check"></i><b>13.1.3</b> Reading other format</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="maps.html"><a href="maps.html#introduction"><i class="fa fa-check"></i><b>13.2</b> Introduction</a></li>
<li class="chapter" data-level="13.3" data-path="maps.html"><a href="maps.html#static-maps"><i class="fa fa-check"></i><b>13.3</b> Static Maps</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="maps.html"><a href="maps.html#the-bathmetry-data"><i class="fa fa-check"></i><b>13.3.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="maps.html"><a href="maps.html#basemap"><i class="fa fa-check"></i><b>13.4</b> Basemap</a></li>
<li class="chapter" data-level="13.5" data-path="maps.html"><a href="maps.html#creating-contour-map"><i class="fa fa-check"></i><b>13.5</b> Creating contour map</a></li>
<li class="chapter" data-level="13.6" data-path="maps.html"><a href="maps.html#inset-maps"><i class="fa fa-check"></i><b>13.6</b> Inset maps</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="maps.html"><a href="maps.html#choropleth-maps"><i class="fa fa-check"></i><b>13.6.1</b> Choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="maps.html"><a href="maps.html#animated-maps"><i class="fa fa-check"></i><b>13.7</b> Animated maps</a></li>
<li class="chapter" data-level="13.8" data-path="maps.html"><a href="maps.html#interactive-maps"><i class="fa fa-check"></i><b>13.8</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="c20.html"><a href="c20.html"><i class="fa fa-check"></i><b>14</b> Appendices</a>
<ul>
<li class="chapter" data-level="14.1" data-path="c20.html"><a href="c20.html#practical-a-getting-started"><i class="fa fa-check"></i><b>14.1</b> Practical A: Getting started</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="c20.html"><a href="c20.html#install-necessary-packages"><i class="fa fa-check"></i><b>14.1.1</b> Install necessary packages</a></li>
<li class="chapter" data-level="14.1.2" data-path="c20.html"><a href="c20.html#create-an-rstudio-project"><i class="fa fa-check"></i><b>14.1.2</b> Create An Rstudio Project</a></li>
<li class="chapter" data-level="14.1.3" data-path="c20.html"><a href="c20.html#create-an-r-markdown-file"><i class="fa fa-check"></i><b>14.1.3</b> Create an R Markdown file</a></li>
<li class="chapter" data-level="14.1.4" data-path="c20.html"><a href="c20.html#create-new-folders"><i class="fa fa-check"></i><b>14.1.4</b> Create New folders</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="c20.html"><a href="c20.html#practical-b-working-with-climate-data"><i class="fa fa-check"></i><b>14.2</b> Practical B: Working with climate data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="c20.html"><a href="c20.html#part-1-rasters"><i class="fa fa-check"></i><b>14.2.1</b> Part 1: rasters</a></li>
<li class="chapter" data-level="14.2.2" data-path="c20.html"><a href="c20.html#part-2-descriptive-statistics"><i class="fa fa-check"></i><b>14.2.2</b> Part 2 descriptive statistics</a></li>
<li class="chapter" data-level="14.2.3" data-path="c20.html"><a href="c20.html#using-more-data"><i class="fa fa-check"></i><b>14.2.3</b> Using more data</a></li>
<li class="chapter" data-level="14.2.4" data-path="c20.html"><a href="c20.html#wind"><i class="fa fa-check"></i><b>14.2.4</b> Wind</a></li>
<li class="chapter" data-level="14.2.5" data-path="c20.html"><a href="c20.html#precipitation"><i class="fa fa-check"></i><b>14.2.5</b> Precipitation</a></li>
<li class="chapter" data-level="14.2.6" data-path="c20.html"><a href="c20.html#advanced-analysis"><i class="fa fa-check"></i><b>14.2.6</b> Advanced analysis</a></li>
<li class="chapter" data-level="14.2.7" data-path="c20.html"><a href="c20.html#stars-package"><i class="fa fa-check"></i><b>14.2.7</b> stars package</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="c20.html"><a href="c20.html#practical-c-handling-projections-and-coordinate-systems"><i class="fa fa-check"></i><b>14.3</b> Practical C: Handling Projections and Coordinate Systems</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="c20.html"><a href="c20.html#assigning-coordinate-reference-system"><i class="fa fa-check"></i><b>14.3.1</b> Assigning Coordinate reference system</a></li>
<li class="chapter" data-level="14.3.2" data-path="c20.html"><a href="c20.html#transforming-coordinate-system"><i class="fa fa-check"></i><b>14.3.2</b> Transforming coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="c20.html"><a href="c20.html#practical-d-finding-loading-and-cleaning-spatial-data"><i class="fa fa-check"></i><b>14.4</b> Practical D: Finding, loading, and cleaning Spatial data</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="c20.html"><a href="c20.html#thinking-about-map-data-the-way-r-does"><i class="fa fa-check"></i><b>14.4.1</b> Thinking about map data the way R does</a></li>
<li class="chapter" data-level="14.4.2" data-path="c20.html"><a href="c20.html#a-brief-introduction-to-simple-features-data-in-r"><i class="fa fa-check"></i><b>14.4.2</b> A brief introduction to simple features data in R</a></li>
<li class="chapter" data-level="14.4.3" data-path="c20.html"><a href="c20.html#finding-data"><i class="fa fa-check"></i><b>14.4.3</b> Finding data</a></li>
<li class="chapter" data-level="14.4.4" data-path="c20.html"><a href="c20.html#finding-non-geospatial-data"><i class="fa fa-check"></i><b>14.4.4</b> Finding non-geospatial data</a></li>
<li class="chapter" data-level="14.4.5" data-path="c20.html"><a href="c20.html#combining-spatial-data-with-non-spatial-data"><i class="fa fa-check"></i><b>14.4.5</b> Combining spatial data with non-spatial data</a></li>
<li class="chapter" data-level="14.4.6" data-path="c20.html"><a href="c20.html#conclusion"><i class="fa fa-check"></i><b>14.4.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="c20.html"><a href="c20.html#practical-e-making-maps-with-ggplot2"><i class="fa fa-check"></i><b>14.5</b> Practical E: Making maps with ggplot2</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="c20.html"><a href="c20.html#import-and-clean-the-datasets"><i class="fa fa-check"></i><b>14.5.1</b> Import and clean the datasets</a></li>
<li class="chapter" data-level="14.5.2" data-path="c20.html"><a href="c20.html#add-highlights-and-annotations"><i class="fa fa-check"></i><b>14.5.2</b> Add highlights and annotations</a></li>
<li class="chapter" data-level="14.5.3" data-path="c20.html"><a href="c20.html#inset-map"><i class="fa fa-check"></i><b>14.5.3</b> inset map</a></li>
<li class="chapter" data-level="14.5.4" data-path="c20.html"><a href="c20.html#final-beautification"><i class="fa fa-check"></i><b>14.5.4</b> Final beautification</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="c20.html"><a href="c20.html#practical-f-the-bathmetry-data"><i class="fa fa-check"></i><b>14.6</b> Practical F: The bathmetry data</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="c20.html"><a href="c20.html#zoom-in-on-a-region-of-interest"><i class="fa fa-check"></i><b>14.6.1</b> Zoom in on a region of interest</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="c20.html"><a href="c20.html#practical-g-drawing-maps-programmatically-with-r"><i class="fa fa-check"></i><b>14.7</b> Practical G: Drawing maps programmatically with R</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="c20.html"><a href="c20.html#a-solution-using-r-and-its-ecosystem-of-packages"><i class="fa fa-check"></i><b>14.7.1</b> A solution using R and its ecosystem of packages</a></li>
<li class="chapter" data-level="14.7.2" data-path="c20.html"><a href="c20.html#getting-started"><i class="fa fa-check"></i><b>14.7.2</b> Getting started</a></li>
<li class="chapter" data-level="14.7.3" data-path="c20.html"><a href="c20.html#data-and-basic-plot-ggplot-and-geom_sf"><i class="fa fa-check"></i><b>14.7.3</b> Data and basic plot (<code>ggplot</code> and <code>geom_sf</code>)</a></li>
<li class="chapter" data-level="14.7.4" data-path="c20.html"><a href="c20.html#title-subtitle-and-axis-labels-ggtitle-xlab-ylab"><i class="fa fa-check"></i><b>14.7.4</b> Title, subtitle, and axis labels (<code>ggtitle</code>, <code>xlab</code>, <code>ylab</code>)</a></li>
<li class="chapter" data-level="14.7.5" data-path="c20.html"><a href="c20.html#map-color-geom_sf"><i class="fa fa-check"></i><b>14.7.5</b> Map color (<code>geom_sf</code>)</a></li>
<li class="chapter" data-level="14.7.6" data-path="c20.html"><a href="c20.html#projection-and-extent-coord_sf"><i class="fa fa-check"></i><b>14.7.6</b> Projection and extent (<code>coord_sf</code>)</a></li>
<li class="chapter" data-level="14.7.7" data-path="c20.html"><a href="c20.html#scale-bar-and-north-arrow-package-ggspatial"><i class="fa fa-check"></i><b>14.7.7</b> Scale bar and North arrow (package <code>ggspatial</code>)</a></li>
<li class="chapter" data-level="14.7.8" data-path="c20.html"><a href="c20.html#country-names-and-other-names-geom_text-and-annotate"><i class="fa fa-check"></i><b>14.7.8</b> Country names and other names (<code>geom_text</code> and <code>annotate</code>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://lugoga.github.io/geomarine/" aria-label='Author Website Link'>
      <img src="images/geoR.svg" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a https://github.com/lugoga/geomarine/" aria-label='GitHub Link'>
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" aria-label="Creative commons CCBYSA link">
         <i class="fab fa-creative-commons fa-lg"></i> 
         <i class="fab fa-creative-commons-by fa-lg"></i> 
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>      

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practical Spatial Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c20" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> Appendices</h1>
<p>This chapter includes four practicals:</p>
<ul>
<li>Practical A: Getting started (associated with <a href="#c06">Chapter 6</a>)</li>
<li>Practical B: Working with climate data (associated with <a href="#c11">Chapter 11</a> and <a href="#c12">Chapter 12</a>)</li>
<li>Practical C: Finding, loading, and cleaning Spatial data (associated with <a href="#c12">Chapter 12</a>)</li>
<li>Practical D: Making maps with <strong>ggplot2</strong></li>
</ul>
<div id="practical-a-getting-started" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Practical A: Getting started</h2>
<p>Before we start, make sure that you have opened <strong>RStudio</strong> and <strong>ArcGIS</strong> on your computer.</p>
<div id="install-necessary-packages" class="section level3" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Install necessary packages</h3>
<p>The most important packages We will be using for the GIS work are <code>sf</code>, <code>raster</code>, <code>lubridate</code>, <code>oce</code>, <code>ocedata</code>, <code>leaflet</code>, <code>tmap</code>, and <code>tidyverse</code>. To install these and others that we will be using, enter at the R console prompt (or copy-and-paste):</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="c20.html#cb481-1"></a><span class="kw">install.packages</span>(</span>
<span id="cb481-2"><a href="c20.html#cb481-2"></a>    <span class="kw">c</span>(<span class="st">&quot;sf&quot;</span>, </span>
<span id="cb481-3"><a href="c20.html#cb481-3"></a>    <span class="st">&quot;raster&quot;</span>, </span>
<span id="cb481-4"><a href="c20.html#cb481-4"></a>    <span class="st">&quot;leaflet&quot;</span>, </span>
<span id="cb481-5"><a href="c20.html#cb481-5"></a>    <span class="st">&quot;tidyverse&quot;</span>, </span>
<span id="cb481-6"><a href="c20.html#cb481-6"></a>    <span class="st">&quot;kableExtra&quot;</span>, </span>
<span id="cb481-7"><a href="c20.html#cb481-7"></a>    <span class="st">&quot;leaflet&quot;</span>, </span>
<span id="cb481-8"><a href="c20.html#cb481-8"></a>    <span class="st">&quot;oce&quot;</span>,</span>
<span id="cb481-9"><a href="c20.html#cb481-9"></a>    <span class="st">&quot;pander&quot;</span>,</span>
<span id="cb481-10"><a href="c20.html#cb481-10"></a>    <span class="st">&quot;knitr&quot;</span>,</span>
<span id="cb481-11"><a href="c20.html#cb481-11"></a>    <span class="st">&quot;kableExtra&quot;</span>,</span>
<span id="cb481-12"><a href="c20.html#cb481-12"></a>    <span class="st">&quot;tidycensus&quot;</span>,</span>
<span id="cb481-13"><a href="c20.html#cb481-13"></a>    <span class="st">&quot;ocedata&quot;</span>,</span>
<span id="cb481-14"><a href="c20.html#cb481-14"></a>    <span class="st">&quot;forcats&quot;</span>,</span>
<span id="cb481-15"><a href="c20.html#cb481-15"></a>    <span class="st">&quot;mapedit&quot;</span>,</span>
<span id="cb481-16"><a href="c20.html#cb481-16"></a>    <span class="st">&quot;mapview&quot;</span>)</span>
<span id="cb481-17"><a href="c20.html#cb481-17"></a>)</span></code></pre></div>
<blockquote>
<p>This should only done once on any user R installation.</p>
</blockquote>
</div>
<div id="create-an-rstudio-project" class="section level3" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> Create An Rstudio Project</h3>
<p>Create a new RStudio project in a new folder on your desktop named <code>r_gis</code> (<code>File &gt; New Project)</code>.</p>
<p><img src="screenshots/rstudio_project_creation1.png" width="80%" /></p>
<p>Then choose New Project</p>
<p><img src="screenshots/rstudio_project_creation2.png" width="80%" />
Then Define the directory name and browse to specify the location you want folder of the project to live in your machine.</p>
<p><img src="screenshots/rstudio_project_creation3.png" width="80%" /></p>
</div>
<div id="create-an-r-markdown-file" class="section level3" number="14.1.3">
<h3><span class="header-section-number">14.1.3</span> Create an R Markdown file</h3>
<p>Steps to create a new R Markdown file are as <code>File &gt; New File &gt; R Markdown...</code>and assign the name as `GIS in R and specify the author name with your name and leave other option as default. We will come to the other parameters later.</p>
<p><img src="screenshots/rmarkdonw_file.png" width="80%" /></p>
<p>Delete most of the content in the rmarkdwon file you just created except the YAML header and the first chunk of setup and save it in your project working directory as <code>r_gis.Rmd</code>.</p>
</div>
<div id="create-new-folders" class="section level3" number="14.1.4">
<h3><span class="header-section-number">14.1.4</span> Create New folders</h3>
<p>We can organize our project by having a folder structure that allows us to organize our data, the scripts and output during the process. We can simply create the folder programmatically using a <code>dir.create</code> function, which simply create a folder in your working directory.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="c20.html#cb482-1"></a><span class="kw">dir.create</span>(<span class="st">&quot;data&quot;</span>)</span>
<span id="cb482-2"><a href="c20.html#cb482-2"></a><span class="kw">dir.create</span>(<span class="st">&quot;output&quot;</span>)</span>
<span id="cb482-3"><a href="c20.html#cb482-3"></a><span class="kw">dir.create</span>(<span class="st">&quot;script&quot;</span>)</span></code></pre></div>
<p>Create a new chunk and load the packages we will use using the <code>require()</code> function. We will load some packages we are going to use during this session as the chunk below highlight.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="c20.html#cb483-1"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb483-2"><a href="c20.html#cb483-2"></a><span class="kw">require</span>(leaflet)</span>
<span id="cb483-3"><a href="c20.html#cb483-3"></a><span class="kw">require</span>(sf)</span>
<span id="cb483-4"><a href="c20.html#cb483-4"></a><span class="kw">require</span>(tmap)</span></code></pre></div>
</div>
</div>
<div id="practical-b-working-with-climate-data" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Practical B: Working with climate data</h2>
<p>This practical is composed of three parts. To start with we’re going to load some global raster data into R. In the second part we extract data points (cities and towns) from this data and generate some descriptive statistics and histograms. In the final section we explore interpolation using point data.</p>
<div id="part-1-rasters" class="section level3" number="14.2.1">
<h3><span class="header-section-number">14.2.1</span> Part 1: rasters</h3>
<p>So far we’ve only really considered vector data. Within this practical we will explore some raster data sources and processing techniques. If you recall rasters are grids of cell with individual values. There are many, many possible sources to obtain raster data from as it is the data type used for the majority (basically all) of remote sensing data.</p>
<div id="worldclim-data" class="section level4" number="14.2.1.1">
<h4><span class="header-section-number">14.2.1.1</span> WorldClim data</h4>
<p>We will deal with historical climate data accessed from the worldClim Data website at this link: <a href="https://worldclim.org/data/worldclim21.html" class="uri">https://worldclim.org/data/worldclim21.html</a>. This is version 2.1 climate data for 1970-2000 released in January 2020. There are monthly climate data for minimum, mean, and maximum temperature, precipitation, solar radiation, wind speed, water vapor pressure, and for total precipitation. There are also 19 “bioclimatic” variables. The data is available at the four spatial resolutions, between 30 seconds (~1 km2) to 10 minutes (~340 km2). Each download is a “zip” file containing 12 GeoTiff (.tif) files, one for each month of the year (January is 1; December is 12).</p>
<ol style="list-style-type: decimal">
<li>Download the data from: <a href="https://worldclim.org/data/worldclim21.html" class="uri">https://worldclim.org/data/worldclim21.html</a></li>
<li>Select any variable you want at the 5 minute second resolution<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</li>
<li>Unzip and move the data to your project folder. Now load the data. We could do this individually….</li>
</ol>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="c20.html#cb484-1"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb484-2"><a href="c20.html#cb484-2"></a><span class="kw">require</span>(sf)</span></code></pre></div>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="c20.html#cb485-1"></a>jan =<span class="st"> </span>raster<span class="op">::</span><span class="kw">raster</span>(<span class="st">&quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_01.tif&quot;</span>)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Then have a guick look</li>
</ol>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="c20.html#cb486-1"></a>jan <span class="op">%&gt;%</span><span class="st"> </span>raster<span class="op">::</span><span class="kw">plot</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-360-1.png" width="672" /></p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="c20.html#cb487-1"></a>jan.tb =<span class="st"> </span>jan <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb487-2"><a href="c20.html#cb487-2"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">as.data.frame</span>(<span class="dt">xy =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb487-3"><a href="c20.html#cb487-3"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb487-4"><a href="c20.html#cb487-4"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">lon =</span> <span class="dv">1</span>, <span class="dt">lat =</span> <span class="dv">2</span>, <span class="dt">temperature =</span> <span class="dv">3</span>)</span>
<span id="cb487-5"><a href="c20.html#cb487-5"></a></span>
<span id="cb487-6"><a href="c20.html#cb487-6"></a>jan.tb <span class="op">%&gt;%</span></span>
<span id="cb487-7"><a href="c20.html#cb487-7"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb487-8"><a href="c20.html#cb487-8"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> temperature)) <span class="op">+</span></span>
<span id="cb487-9"><a href="c20.html#cb487-9"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>),</span>
<span id="cb487-10"><a href="c20.html#cb487-10"></a>                       <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">10</span>), <span class="dt">label =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">10</span>),</span>
<span id="cb487-11"><a href="c20.html#cb487-11"></a>                       <span class="dt">guide =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Average<span class="op">~</span>temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb487-12"><a href="c20.html#cb487-12"></a>                                              <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</span>
<span id="cb487-13"><a href="c20.html#cb487-13"></a>                                              <span class="dt">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb487-14"><a href="c20.html#cb487-14"></a>                                              <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,<span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">8</span>, <span class="st">&quot;cm&quot;</span>)))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-361-1.png" width="672" />
1. A better and more efficient way is to firstly list all the files stored within our directory</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="c20.html#cb488-1"></a>files =<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data/raster/wc2.1_10m_tavg/&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;.tif&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>We notice that since we opened the file in ArcGIS and allowed the file to create an overview, it simply created other two temporaly files. We need to remove them from our list</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="c20.html#cb489-1"></a>files.clean =<span class="st"> </span>files[<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]</span>
<span id="cb489-2"><a href="c20.html#cb489-2"></a>files.clean</span></code></pre></div>
<pre><code> [1] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_01.tif&quot;
 [2] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_02.tif&quot;
 [3] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_03.tif&quot;
 [4] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_04.tif&quot;
 [5] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_05.tif&quot;
 [6] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_06.tif&quot;
 [7] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_07.tif&quot;
 [8] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_08.tif&quot;
 [9] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_09.tif&quot;
[10] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_10.tif&quot;
[11] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_11.tif&quot;
[12] &quot;data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_12.tif&quot;</code></pre>
<ol style="list-style-type: decimal">
<li>Once we have the files in the the list, Then load all of the data straight into a raster stack. A raster stack is a collection of raster layers with the same spatial extent and resolution.</li>
</ol>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="c20.html#cb491-1"></a>temperature.stacked =<span class="st"> </span>files.clean <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb491-2"><a href="c20.html#cb491-2"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">stack</span>()</span>
<span id="cb491-3"><a href="c20.html#cb491-3"></a></span>
<span id="cb491-4"><a href="c20.html#cb491-4"></a>temperature.stacked</span></code></pre></div>
<pre><code>class      : RasterStack 
dimensions : 1080, 2160, 2332800, 12  (nrow, ncol, ncell, nlayers)
resolution : 0.1666667, 0.1666667  (x, y)
extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
crs        : +proj=longlat +datum=WGS84 +no_defs 
names      : wc2.1_10m_tavg_01, wc2.1_10m_tavg_02, wc2.1_10m_tavg_03, wc2.1_10m_tavg_04, wc2.1_10m_tavg_05, wc2.1_10m_tavg_06, wc2.1_10m_tavg_07, wc2.1_10m_tavg_08, wc2.1_10m_tavg_09, wc2.1_10m_tavg_10, wc2.1_10m_tavg_11, wc2.1_10m_tavg_12 
min values :         -45.88400,         -44.80000,         -57.92575,         -64.19250,         -64.81150,         -64.35825,         -68.46075,         -66.52250,         -64.56325,         -55.90000,         -43.43475,         -45.32700 
max values :          34.00950,          32.82425,          32.90950,          34.19375,          36.25325,          38.35550,          39.54950,          38.43275,          35.79000,          32.65125,          32.78800,          32.82525 </code></pre>
<p>In the raster stack you’ll notice that under dimensions there are 12 layers (nlayers). The stack has loaded the 12 months of average temperature data for us in order.</p>
<p>To access single layers within the stack:</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="c20.html#cb493-1"></a>temperature.stacked[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>class      : RasterLayer 
dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)
resolution : 0.1666667, 0.1666667  (x, y)
extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
crs        : +proj=longlat +datum=WGS84 +no_defs 
source     : E:/bookdown/geoMarine/data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_01.tif 
names      : wc2.1_10m_tavg_01 
values     : -45.884, 34.0095  (min, max)</code></pre>
<ol style="list-style-type: decimal">
<li>We can also rename our layers within the stack:</li>
</ol>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="c20.html#cb495-1"></a>month =<span class="st"> </span><span class="kw">seq</span>(lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">010120</span>), lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">311220</span>), <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>lubridate<span class="op">::</span><span class="kw">month</span>(<span class="dt">abbr =</span> <span class="ot">TRUE</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>)</span>
<span id="cb495-2"><a href="c20.html#cb495-2"></a></span>
<span id="cb495-3"><a href="c20.html#cb495-3"></a><span class="kw">names</span>(temperature.stacked) =<span class="st"> </span>month</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Now to get data for just January use our new layer name</li>
</ol>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="c20.html#cb496-1"></a>temperature.stacked<span class="op">$</span>Jan</span></code></pre></div>
<pre><code>class      : RasterLayer 
dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)
resolution : 0.1666667, 0.1666667  (x, y)
extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
crs        : +proj=longlat +datum=WGS84 +no_defs 
source     : E:/bookdown/geoMarine/data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_01.tif 
names      : Jan 
values     : -45.884, 34.0095  (min, max)</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="c20.html#cb498-1"></a>temperature.stacked[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>class      : RasterLayer 
dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)
resolution : 0.1666667, 0.1666667  (x, y)
extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
crs        : +proj=longlat +datum=WGS84 +no_defs 
source     : E:/bookdown/geoMarine/data/raster/wc2.1_10m_tavg/wc2.1_10m_tavg_01.tif 
names      : Jan 
values     : -45.884, 34.0095  (min, max)</code></pre>
</div>
<div id="extract-data-from-a-raster" class="section level4" number="14.2.1.2">
<h4><span class="header-section-number">14.2.1.2</span> Extract data from a raster</h4>
<p>Using a raster stack we can extract data with a single command!! For example let’s make a dataframe of some sample sites — Australian cities/towns.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="c20.html#cb500-1"></a><span class="co">## create geographical location of the places in the world</span></span>
<span id="cb500-2"><a href="c20.html#cb500-2"></a>locations =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">&quot;Australia&quot;</span>,<span class="st">&quot;Africa&quot;</span>, <span class="st">&quot;South America&quot;</span>, <span class="st">&quot;North America&quot;</span>, <span class="st">&quot;Europe&quot;</span>, <span class="st">&quot;China&quot;</span>, <span class="st">&quot;Russia&quot;</span>),</span>
<span id="cb500-3"><a href="c20.html#cb500-3"></a>           <span class="dt">lon =</span> <span class="kw">c</span>(<span class="fl">129.567317</span>, <span class="fl">26.916542</span>, <span class="fl">-58.63894</span>, <span class="fl">-102.5173197</span>,<span class="fl">9.4532431</span>,<span class="fl">89.285466</span>, <span class="fl">91.926973</span>),</span>
<span id="cb500-4"><a href="c20.html#cb500-4"></a>           <span class="dt">lat =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">23.803969</span>, <span class="fl">-2.168066</span>, <span class="fl">-18.84251</span>, <span class="fl">47.14847</span>, <span class="fl">49.107177</span>, <span class="fl">38.103829</span>, <span class="fl">63.275941</span>))</span></code></pre></div>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="c20.html#cb501-1"></a><span class="co">##  Extract the data from the Rasterstack for all points and convert them to data frmae</span></span>
<span id="cb501-2"><a href="c20.html#cb501-2"></a>temperature.locations =<span class="st"> </span>temperature.stacked <span class="op">%&gt;%</span></span>
<span id="cb501-3"><a href="c20.html#cb501-3"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">extract</span>(locations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(lon,lat)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-4"><a href="c20.html#cb501-4"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb501-5"><a href="c20.html#cb501-5"></a><span class="st">  </span><span class="kw">as_tibble</span>()</span>
<span id="cb501-6"><a href="c20.html#cb501-6"></a></span>
<span id="cb501-7"><a href="c20.html#cb501-7"></a></span>
<span id="cb501-8"><a href="c20.html#cb501-8"></a>monthly.temperature.locations =<span class="st"> </span>locations <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb501-9"><a href="c20.html#cb501-9"></a><span class="st">  </span><span class="kw">bind_cols</span>(temperature.locations)</span></code></pre></div>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="c20.html#cb502-1"></a>monthly.temperature.locations <span class="op">%&gt;%</span></span>
<span id="cb502-2"><a href="c20.html#cb502-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(is.numeric, round, <span class="dv">2</span>)) <span class="op">%&gt;%</span></span>
<span id="cb502-3"><a href="c20.html#cb502-3"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>() <span class="op">%&gt;%</span></span>
<span id="cb502-4"><a href="c20.html#cb502-4"></a><span class="st">  </span>kableExtra<span class="op">::</span><span class="kw">column_spec</span>(<span class="dt">column =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">15</span>,<span class="dt">width =</span> <span class="st">&quot;4cm&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb502-5"><a href="c20.html#cb502-5"></a><span class="st">  </span>kableExtra<span class="op">::</span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;Location&quot;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;Month&quot;</span> =<span class="st"> </span><span class="dv">12</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Location
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="12">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Month
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
name
</th>
<th style="text-align:right;">
lon
</th>
<th style="text-align:right;">
lat
</th>
<th style="text-align:right;">
Jan
</th>
<th style="text-align:right;">
Feb
</th>
<th style="text-align:right;">
Mar
</th>
<th style="text-align:right;">
Apr
</th>
<th style="text-align:right;">
May
</th>
<th style="text-align:right;">
Jun
</th>
<th style="text-align:right;">
Jul
</th>
<th style="text-align:right;">
Aug
</th>
<th style="text-align:right;">
Sep
</th>
<th style="text-align:right;">
Oct
</th>
<th style="text-align:right;">
Nov
</th>
<th style="text-align:right;">
Dec
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 4cm; ">
Australia
</td>
<td style="text-align:right;width: 4cm; ">
129.57
</td>
<td style="text-align:right;width: 4cm; ">
-23.80
</td>
<td style="text-align:right;width: 4cm; ">
32.02
</td>
<td style="text-align:right;width: 4cm; ">
30.66
</td>
<td style="text-align:right;width: 4cm; ">
28.60
</td>
<td style="text-align:right;width: 4cm; ">
24.83
</td>
<td style="text-align:right;width: 4cm; ">
19.49
</td>
<td style="text-align:right;width: 4cm; ">
15.24
</td>
<td style="text-align:right;width: 4cm; ">
14.55
</td>
<td style="text-align:right;width: 4cm; ">
16.64
</td>
<td style="text-align:right;width: 4cm; ">
21.23
</td>
<td style="text-align:right;width: 4cm; ">
25.78
</td>
<td style="text-align:right;width: 4cm; ">
28.26
</td>
<td style="text-align:right;width: 4cm; ">
29.91
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Africa
</td>
<td style="text-align:right;width: 4cm; ">
26.92
</td>
<td style="text-align:right;width: 4cm; ">
-2.17
</td>
<td style="text-align:right;width: 4cm; ">
23.85
</td>
<td style="text-align:right;width: 4cm; ">
23.92
</td>
<td style="text-align:right;width: 4cm; ">
24.02
</td>
<td style="text-align:right;width: 4cm; ">
24.07
</td>
<td style="text-align:right;width: 4cm; ">
23.88
</td>
<td style="text-align:right;width: 4cm; ">
23.22
</td>
<td style="text-align:right;width: 4cm; ">
23.06
</td>
<td style="text-align:right;width: 4cm; ">
23.56
</td>
<td style="text-align:right;width: 4cm; ">
23.78
</td>
<td style="text-align:right;width: 4cm; ">
23.70
</td>
<td style="text-align:right;width: 4cm; ">
23.51
</td>
<td style="text-align:right;width: 4cm; ">
23.59
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
South America
</td>
<td style="text-align:right;width: 4cm; ">
-58.64
</td>
<td style="text-align:right;width: 4cm; ">
-18.84
</td>
<td style="text-align:right;width: 4cm; ">
28.73
</td>
<td style="text-align:right;width: 4cm; ">
28.15
</td>
<td style="text-align:right;width: 4cm; ">
27.97
</td>
<td style="text-align:right;width: 4cm; ">
26.66
</td>
<td style="text-align:right;width: 4cm; ">
23.94
</td>
<td style="text-align:right;width: 4cm; ">
22.91
</td>
<td style="text-align:right;width: 4cm; ">
22.92
</td>
<td style="text-align:right;width: 4cm; ">
25.01
</td>
<td style="text-align:right;width: 4cm; ">
26.85
</td>
<td style="text-align:right;width: 4cm; ">
28.57
</td>
<td style="text-align:right;width: 4cm; ">
28.65
</td>
<td style="text-align:right;width: 4cm; ">
28.74
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
North America
</td>
<td style="text-align:right;width: 4cm; ">
-102.52
</td>
<td style="text-align:right;width: 4cm; ">
47.15
</td>
<td style="text-align:right;width: 4cm; ">
-11.15
</td>
<td style="text-align:right;width: 4cm; ">
-7.06
</td>
<td style="text-align:right;width: 4cm; ">
-1.36
</td>
<td style="text-align:right;width: 4cm; ">
6.05
</td>
<td style="text-align:right;width: 4cm; ">
12.99
</td>
<td style="text-align:right;width: 4cm; ">
18.02
</td>
<td style="text-align:right;width: 4cm; ">
21.13
</td>
<td style="text-align:right;width: 4cm; ">
20.85
</td>
<td style="text-align:right;width: 4cm; ">
14.45
</td>
<td style="text-align:right;width: 4cm; ">
7.32
</td>
<td style="text-align:right;width: 4cm; ">
-2.17
</td>
<td style="text-align:right;width: 4cm; ">
-8.57
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Europe
</td>
<td style="text-align:right;width: 4cm; ">
9.45
</td>
<td style="text-align:right;width: 4cm; ">
49.11
</td>
<td style="text-align:right;width: 4cm; ">
0.38
</td>
<td style="text-align:right;width: 4cm; ">
1.18
</td>
<td style="text-align:right;width: 4cm; ">
4.73
</td>
<td style="text-align:right;width: 4cm; ">
7.93
</td>
<td style="text-align:right;width: 4cm; ">
12.74
</td>
<td style="text-align:right;width: 4cm; ">
15.58
</td>
<td style="text-align:right;width: 4cm; ">
17.69
</td>
<td style="text-align:right;width: 4cm; ">
17.40
</td>
<td style="text-align:right;width: 4cm; ">
13.64
</td>
<td style="text-align:right;width: 4cm; ">
8.96
</td>
<td style="text-align:right;width: 4cm; ">
4.03
</td>
<td style="text-align:right;width: 4cm; ">
1.46
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
China
</td>
<td style="text-align:right;width: 4cm; ">
89.29
</td>
<td style="text-align:right;width: 4cm; ">
38.10
</td>
<td style="text-align:right;width: 4cm; ">
-15.34
</td>
<td style="text-align:right;width: 4cm; ">
-12.36
</td>
<td style="text-align:right;width: 4cm; ">
-7.24
</td>
<td style="text-align:right;width: 4cm; ">
-0.74
</td>
<td style="text-align:right;width: 4cm; ">
4.57
</td>
<td style="text-align:right;width: 4cm; ">
8.56
</td>
<td style="text-align:right;width: 4cm; ">
11.16
</td>
<td style="text-align:right;width: 4cm; ">
10.62
</td>
<td style="text-align:right;width: 4cm; ">
5.62
</td>
<td style="text-align:right;width: 4cm; ">
-2.10
</td>
<td style="text-align:right;width: 4cm; ">
-9.24
</td>
<td style="text-align:right;width: 4cm; ">
-13.86
</td>
</tr>
<tr>
<td style="text-align:left;width: 4cm; ">
Russia
</td>
<td style="text-align:right;width: 4cm; ">
91.93
</td>
<td style="text-align:right;width: 4cm; ">
63.28
</td>
<td style="text-align:right;width: 4cm; ">
-29.19
</td>
<td style="text-align:right;width: 4cm; ">
-26.59
</td>
<td style="text-align:right;width: 4cm; ">
-16.59
</td>
<td style="text-align:right;width: 4cm; ">
-7.17
</td>
<td style="text-align:right;width: 4cm; ">
1.26
</td>
<td style="text-align:right;width: 4cm; ">
10.52
</td>
<td style="text-align:right;width: 4cm; ">
15.27
</td>
<td style="text-align:right;width: 4cm; ">
11.37
</td>
<td style="text-align:right;width: 4cm; ">
4.40
</td>
<td style="text-align:right;width: 4cm; ">
-6.89
</td>
<td style="text-align:right;width: 4cm; ">
-19.32
</td>
<td style="text-align:right;width: 4cm; ">
-26.05
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="c20.html#cb503-1"></a>world_countries =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/shp/world_countries.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span>
<span id="cb503-2"><a href="c20.html#cb503-2"></a></span>
<span id="cb503-3"><a href="c20.html#cb503-3"></a>world_countries =<span class="st"> </span>world_countries <span class="op">%&gt;%</span></span>
<span id="cb503-4"><a href="c20.html#cb503-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">area =</span> <span class="kw">st_area</span>(geometry) <span class="op">%&gt;%</span><span class="st"> </span>as.numeric,</span>
<span id="cb503-5"><a href="c20.html#cb503-5"></a>         <span class="dt">area_km =</span> area<span class="op">/</span><span class="dv">1000000</span>)</span></code></pre></div>
<p>We then dissolve the countries for each continent to remain with continent alone;</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="c20.html#cb504-1"></a>continent =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/shp/Continents.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb504-2"><a href="c20.html#cb504-2"></a><span class="st">  </span><span class="kw">st_set_crs</span>(<span class="dv">4326</span>) <span class="op">%&gt;%</span></span>
<span id="cb504-3"><a href="c20.html#cb504-3"></a><span class="st">  </span>janitor<span class="op">::</span><span class="kw">clean_names</span>()</span>
<span id="cb504-4"><a href="c20.html#cb504-4"></a></span>
<span id="cb504-5"><a href="c20.html#cb504-5"></a>continent =<span class="st"> </span>continent <span class="op">%&gt;%</span></span>
<span id="cb504-6"><a href="c20.html#cb504-6"></a><span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(area)) <span class="op">%&gt;%</span></span>
<span id="cb504-7"><a href="c20.html#cb504-7"></a><span class="st">    </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb504-8"><a href="c20.html#cb504-8"></a></span>
<span id="cb504-9"><a href="c20.html#cb504-9"></a></span>
<span id="cb504-10"><a href="c20.html#cb504-10"></a>  <span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb504-11"><a href="c20.html#cb504-11"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">layer_spatial</span>(<span class="dt">data =</span> continent)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-372-1.png" width="672" /></p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="c20.html#cb505-1"></a>continent.names =<span class="st"> </span>continent <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb505-2"><a href="c20.html#cb505-2"></a><span class="st">  </span><span class="kw">pull</span>(placename) <span class="op">%&gt;%</span></span>
<span id="cb505-3"><a href="c20.html#cb505-3"></a><span class="st">  </span><span class="kw">as.character</span>()</span>
<span id="cb505-4"><a href="c20.html#cb505-4"></a></span>
<span id="cb505-5"><a href="c20.html#cb505-5"></a>sample.points =<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb505-6"><a href="c20.html#cb505-6"></a></span>
<span id="cb505-7"><a href="c20.html#cb505-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(continent.names)){</span>
<span id="cb505-8"><a href="c20.html#cb505-8"></a>  </span>
<span id="cb505-9"><a href="c20.html#cb505-9"></a>  sample.points[[i]] =<span class="st"> </span>continent <span class="op">%&gt;%</span></span>
<span id="cb505-10"><a href="c20.html#cb505-10"></a><span class="st">    </span><span class="kw">filter</span>(placename <span class="op">==</span><span class="st"> </span>continent.names[i]) <span class="op">%&gt;%</span></span>
<span id="cb505-11"><a href="c20.html#cb505-11"></a><span class="st">    </span><span class="kw">st_sample</span>(<span class="dt">size =</span> <span class="dv">30</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb505-12"><a href="c20.html#cb505-12"></a><span class="st">    </span><span class="kw">st_coordinates</span>() <span class="op">%&gt;%</span></span>
<span id="cb505-13"><a href="c20.html#cb505-13"></a><span class="st">    </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></span>
<span id="cb505-14"><a href="c20.html#cb505-14"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">continent =</span> continent.names[i]) <span class="op">%&gt;%</span></span>
<span id="cb505-15"><a href="c20.html#cb505-15"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">lon =</span> <span class="dv">1</span>, <span class="dt">lat =</span> <span class="dv">2</span>)</span>
<span id="cb505-16"><a href="c20.html#cb505-16"></a>  </span>
<span id="cb505-17"><a href="c20.html#cb505-17"></a>  <span class="co"># print(i)</span></span>
<span id="cb505-18"><a href="c20.html#cb505-18"></a>}</span>
<span id="cb505-19"><a href="c20.html#cb505-19"></a></span>
<span id="cb505-20"><a href="c20.html#cb505-20"></a>sample.points =<span class="st"> </span>sample.points <span class="op">%&gt;%</span></span>
<span id="cb505-21"><a href="c20.html#cb505-21"></a><span class="st">  </span><span class="kw">bind_rows</span>()</span></code></pre></div>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="c20.html#cb506-1"></a>sample.points <span class="op">%&gt;%</span></span>
<span id="cb506-2"><a href="c20.html#cb506-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">color =</span> continent))<span class="op">+</span></span>
<span id="cb506-3"><a href="c20.html#cb506-3"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">layer_spatial</span>(<span class="dt">data =</span> continent)<span class="op">+</span></span>
<span id="cb506-4"><a href="c20.html#cb506-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-374-1.png" width="672" />
You notice that there are not points in the Antarctica, we never processed them because of high computation time it take to process because of the shape of this continent.</p>
</div>
<div id="extract-raster-pixels-values-using-vector-polygons" class="section level4" number="14.2.1.3">
<h4><span class="header-section-number">14.2.1.3</span> Extract Raster Pixels Values Using Vector Polygons</h4>
<p>Often we want to extract values from a raster layer for particular locations - for example, plot locations that we are sampling on the ground. We can extract all pixel values within 20m of our x,y point of interest. These can then be summarized into some value of interest (e.g. mean, maximum, total).</p>
<p>Once we have the points, we can use them to extract the monthly temperature for each continent. To do this in R, we use the <code>extract()</code> function. The <code>extract()</code> function requires:</p>
<ul>
<li>The raster that we wish to extract values from,</li>
<li>The vector layer containing the polygons that we wish to use as a boundary or boundaries,</li>
</ul>
<p>we can tell it to store the output values in a data frame using df = TRUE. (This is optional, the default is to return a list, NOT a data frame.) .</p>
<p>We will begin by extracting all canopy height pixel values located within our aoi_boundary_HARV polygon which surrounds the tower located at the NEON Harvard Forest field site.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="c20.html#cb507-1"></a>temperature.extract =<span class="st"> </span>temperature.stacked <span class="op">%&gt;%</span></span>
<span id="cb507-2"><a href="c20.html#cb507-2"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">extract</span>( sample.points <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>continent)) <span class="op">%&gt;%</span></span>
<span id="cb507-3"><a href="c20.html#cb507-3"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb507-4"><a href="c20.html#cb507-4"></a><span class="st">  </span><span class="kw">as_tibble</span>()</span>
<span id="cb507-5"><a href="c20.html#cb507-5"></a></span>
<span id="cb507-6"><a href="c20.html#cb507-6"></a></span>
<span id="cb507-7"><a href="c20.html#cb507-7"></a>temperature.extract.wide =<span class="st"> </span>sample.points <span class="op">%&gt;%</span></span>
<span id="cb507-8"><a href="c20.html#cb507-8"></a><span class="st">  </span><span class="kw">bind_cols</span>(temperature.extract <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="kw">across</span>(is.numeric, round, <span class="dv">2</span>))) <span class="op">%&gt;%</span></span>
<span id="cb507-9"><a href="c20.html#cb507-9"></a><span class="st">  </span><span class="kw">relocate</span>(continent, <span class="dt">.before =</span> lon)</span></code></pre></div>
</div>
</div>
<div id="part-2-descriptive-statistics" class="section level3" number="14.2.2">
<h3><span class="header-section-number">14.2.2</span> Part 2 descriptive statistics</h3>
<p>Descriptive (or summary) statistics provide a summary of our data, often forming the base of quantitiatve analysis leading to inferential statistics which we use to make infereces about our data (e.g. judegements of the probability that the observed difference between two datasets is not by chance)</p>
<div id="data-preparation" class="section level4" number="14.2.2.1">
<h4><span class="header-section-number">14.2.2.1</span> Data preparation</h4>
<p>Before we explore the data, we need first to tidy our dataset into a format that is easy for program to analyse and plotting. We need to change the data from the wide form to long form that is tidy.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="c20.html#cb508-1"></a>temperature.extract.long =<span class="st"> </span>temperature.extract.wide <span class="op">%&gt;%</span></span>
<span id="cb508-2"><a href="c20.html#cb508-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">15</span>, </span>
<span id="cb508-3"><a href="c20.html#cb508-3"></a>               <span class="dt">names_to =</span> <span class="st">&quot;month&quot;</span>, </span>
<span id="cb508-4"><a href="c20.html#cb508-4"></a>               <span class="dt">values_to =</span> <span class="st">&quot;temperature&quot;</span>)</span></code></pre></div>
</div>
<div id="histogram-1" class="section level4" number="14.2.2.2">
<h4><span class="header-section-number">14.2.2.2</span> Histogram</h4>
<p>A histogram lets us see the frequency of distribution of our data. Make a histogram of Perth’s temperature</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="c20.html#cb509-1"></a>temperature.extract.long <span class="op">%&gt;%</span></span>
<span id="cb509-2"><a href="c20.html#cb509-2"></a><span class="st">  </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb509-3"><a href="c20.html#cb509-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> temperature)) <span class="op">+</span></span>
<span id="cb509-4"><a href="c20.html#cb509-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-377-1.png" width="672" />
Remember what we’re looking at here. The x axis is the temperature and the y is the frequency of occurrence.</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="c20.html#cb510-1"></a>temperature.extract.long <span class="op">%&gt;%</span></span>
<span id="cb510-2"><a href="c20.html#cb510-2"></a><span class="st">  </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Asia&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb510-3"><a href="c20.html#cb510-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> temperature)) <span class="op">+</span></span>
<span id="cb510-4"><a href="c20.html#cb510-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>()<span class="op">+</span></span>
<span id="cb510-5"><a href="c20.html#cb510-5"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>month)<span class="op">+</span></span>
<span id="cb510-6"><a href="c20.html#cb510-6"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-378-1.png" width="672" /></p>
</div>
<div id="boxplot-1" class="section level4" number="14.2.2.3">
<h4><span class="header-section-number">14.2.2.3</span> Boxplot</h4>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="c20.html#cb511-1"></a>temperature.extract.long <span class="op">%&gt;%</span></span>
<span id="cb511-2"><a href="c20.html#cb511-2"></a><span class="st">  </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Europe&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb511-3"><a href="c20.html#cb511-3"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb511-4"><a href="c20.html#cb511-4"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> month,<span class="dt">y =</span> temperature, <span class="dt">fill =</span> temperature)) <span class="op">+</span></span>
<span id="cb511-5"><a href="c20.html#cb511-5"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span>month)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-379-1.png" width="672" /></p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="c20.html#cb512-1"></a>temperature.extract.long <span class="op">%&gt;%</span></span>
<span id="cb512-2"><a href="c20.html#cb512-2"></a><span class="st">  </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Europe&quot;</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Jan&quot;</span>, <span class="st">&quot;Jul&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb512-3"><a href="c20.html#cb512-3"></a><span class="st">  </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb512-4"><a href="c20.html#cb512-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">fill =</span> month, <span class="dt">color =</span> month), <span class="dt">alpha =</span> <span class="fl">.6</span>, <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">bins =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-380-1.png" width="672" /></p>
</div>
</div>
<div id="using-more-data" class="section level3" number="14.2.3">
<h3><span class="header-section-number">14.2.3</span> Using more data</h3>
<p>In the previous section, we simply extracted thirty points for each continent. Sometimes, you may be required to have more samples and you may be interested to extract at the continental level</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="c20.html#cb513-1"></a>tanzania =<span class="st"> </span>world_countries <span class="op">%&gt;%</span></span>
<span id="cb513-2"><a href="c20.html#cb513-2"></a><span class="st">  </span><span class="kw">filter</span>(name_long <span class="op">==</span><span class="st"> &quot;Tanzania&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="c20.html#cb514-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb514-2"><a href="c20.html#cb514-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> tanzania)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-382-1.png" width="672" />
#### Crop
We often work with spatial layers that have different spatial extents. The spatial extent of a shapefile or R spatial object represents the geographic “edge” or location that is the furthest north, south east and west. Thus is represents the overall geographic coverage of the spatial object.</p>
<p>We can use the <code>crop()</code> function to crop a raster to the extent of another spatial object. To do this, we need to specify the raster to be cropped and the spatial object that will be used to crop the raster. R will use the extent of the spatial object as the cropping boundary.</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="c20.html#cb515-1"></a>temperature.tz.crop =<span class="st"> </span>temperature.stacked <span class="op">%&gt;%</span></span>
<span id="cb515-2"><a href="c20.html#cb515-2"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">crop</span>(tanzania)</span></code></pre></div>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="c20.html#cb516-1"></a>temperature.tz.crop[[<span class="dv">1</span>]] <span class="op">%&gt;%</span></span>
<span id="cb516-2"><a href="c20.html#cb516-2"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">plot</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-384-1.png" width="672" /></p>
<div id="mask" class="section level4" number="14.2.3.1">
<h4><span class="header-section-number">14.2.3.1</span> Mask</h4>
<p><code>raster::crop()</code> always output the extracted areas as rectangular, however, when you need a raster that has the same geometry of the shapefile, then you need to use <code>raster::mask()</code> function. Unfortunately, the mask trail with NA values that is assigned to the cells outside the geographical extent of the shapefile. To resolve this, you run <code>raster::mask</code> followed with <code>raster::crop</code> to remove NA.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="c20.html#cb517-1"></a>temperature.tz.mask =<span class="st"> </span>temperature.stacked <span class="op">%&gt;%</span></span>
<span id="cb517-2"><a href="c20.html#cb517-2"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">mask</span>(tanzania) <span class="op">%&gt;%</span></span>
<span id="cb517-3"><a href="c20.html#cb517-3"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">crop</span>(tanzania)</span></code></pre></div>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="c20.html#cb518-1"></a>temperature.tz.mask[[<span class="dv">1</span>]] <span class="op">%&gt;%</span></span>
<span id="cb518-2"><a href="c20.html#cb518-2"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">plot</span>() </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-386-1.png" width="672" /></p>
</div>
</div>
<div id="wind" class="section level3" number="14.2.4">
<h3><span class="header-section-number">14.2.4</span> Wind</h3>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="c20.html#cb519-1"></a>wind.jan =<span class="st"> </span>stars<span class="op">::</span><span class="kw">read_stars</span>(<span class="st">&quot;data/raster/wc2.1_10m_wind/wc2.1_10m_wind_01.tif&quot;</span>)</span>
<span id="cb519-2"><a href="c20.html#cb519-2"></a></span>
<span id="cb519-3"><a href="c20.html#cb519-3"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb519-4"><a href="c20.html#cb519-4"></a><span class="st">  </span>stars<span class="op">::</span><span class="kw">geom_stars</span>(<span class="dt">data =</span> wind.jan)<span class="op">+</span></span>
<span id="cb519-5"><a href="c20.html#cb519-5"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colorsPalette</span>(<span class="dv">120</span>), </span>
<span id="cb519-6"><a href="c20.html#cb519-6"></a>                       <span class="dt">trans =</span> scales<span class="op">::</span><span class="kw">log10_trans</span>(),<span class="dt">na.value =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb519-7"><a href="c20.html#cb519-7"></a>                       <span class="co"># breaks = seq(-40,40,10), label = seq(-40,40,10),</span></span>
<span id="cb519-8"><a href="c20.html#cb519-8"></a>                       <span class="dt">guide =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Wind<span class="op">~</span>Speed<span class="op">~</span>(ms<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>))),</span>
<span id="cb519-9"><a href="c20.html#cb519-9"></a>                                              <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</span>
<span id="cb519-10"><a href="c20.html#cb519-10"></a>                                              <span class="dt">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb519-11"><a href="c20.html#cb519-11"></a>                                              <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,<span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">8</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span></span>
<span id="cb519-12"><a href="c20.html#cb519-12"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb519-13"><a href="c20.html#cb519-13"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-387-1.png" width="672" /></p>
</div>
<div id="precipitation" class="section level3" number="14.2.5">
<h3><span class="header-section-number">14.2.5</span> Precipitation</h3>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="c20.html#cb520-1"></a>rain.jan =<span class="st"> </span>stars<span class="op">::</span><span class="kw">read_stars</span>(<span class="st">&quot;data/raster/wc2.1_10m_prec/wc2.1_10m_prec_01.tif&quot;</span>)</span>
<span id="cb520-2"><a href="c20.html#cb520-2"></a><span class="co"># rain.jan = rain.jan %&gt;% wior::inverse_hyperbolic()</span></span>
<span id="cb520-3"><a href="c20.html#cb520-3"></a></span>
<span id="cb520-4"><a href="c20.html#cb520-4"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb520-5"><a href="c20.html#cb520-5"></a><span class="st">  </span>stars<span class="op">::</span><span class="kw">geom_stars</span>(<span class="dt">data =</span> rain.jan)<span class="op">+</span></span>
<span id="cb520-6"><a href="c20.html#cb520-6"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colorsPalette</span>(<span class="dv">120</span>), </span>
<span id="cb520-7"><a href="c20.html#cb520-7"></a>                       <span class="dt">trans =</span> scales<span class="op">::</span><span class="kw">log10_trans</span>(),</span>
<span id="cb520-8"><a href="c20.html#cb520-8"></a>                       <span class="dt">na.value =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb520-9"><a href="c20.html#cb520-9"></a>                       <span class="co"># breaks = seq(-40,40,10), label = seq(-40,40,10),</span></span>
<span id="cb520-10"><a href="c20.html#cb520-10"></a>                       <span class="dt">guide =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">Precipitation</span>(ml<span class="op">~</span>year<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>})),</span>
<span id="cb520-11"><a href="c20.html#cb520-11"></a>                                              <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</span>
<span id="cb520-12"><a href="c20.html#cb520-12"></a>                                              <span class="dt">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb520-13"><a href="c20.html#cb520-13"></a>                                              <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,<span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">8</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span></span>
<span id="cb520-14"><a href="c20.html#cb520-14"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb520-15"><a href="c20.html#cb520-15"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-388-1.png" width="672" /></p>
</div>
<div id="advanced-analysis" class="section level3" number="14.2.6">
<h3><span class="header-section-number">14.2.6</span> Advanced analysis</h3>
<p>Are you already competent with raster analysis and R, then have a go at completing this task in the practical session. Within the practical we’ve loaded one and created one raster layer. Undertake some comparative analysis to determine spatial (and temporal if appropraite) differences between the rasters here and any others you may wish to create (e.g. from other interpolation methods). Try to identify where the varaitions are and explain why they are occuring. You could assume that one raster is the ‘gold standard’ meaning it’s beleived to be fully correct and compare others to it.</p>
<blockquote>
<p>Note: take stars, cubelyr and dbplyr package to appendix</p>
</blockquote>
</div>
<div id="stars-package" class="section level3" number="14.2.7">
<h3><span class="header-section-number">14.2.7</span> stars package</h3>
<p>Package stars provides infrastructure for data cubes, array data with labeled dimensions, with emphasis on arrays where some of the dimensions relate to time and/or space.</p>
<p>Spatial data cubes are arrays with one or more spatial dimensions. Raster data cubes have at least two spatial dimensions that form the raster tesselation. Vector data cubes have at least one spatial dimension that may for instance reflect a polygon tesselation, or a set of point locations. Conversions between the two (rasterization, polygonization) are provided. Vector data are represented by simple feature geometries (packages sf). Tidyverse methods are provided.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="c20.html#cb521-1"></a>jan =<span class="st"> </span>files.clean[<span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span>stars<span class="op">::</span><span class="kw">read_stars</span>()</span>
<span id="cb521-2"><a href="c20.html#cb521-2"></a></span>
<span id="cb521-3"><a href="c20.html#cb521-3"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb521-4"><a href="c20.html#cb521-4"></a><span class="st">  </span>stars<span class="op">::</span><span class="kw">geom_stars</span>(<span class="dt">data =</span> jan) <span class="op">+</span></span>
<span id="cb521-5"><a href="c20.html#cb521-5"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">na.value =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb521-6"><a href="c20.html#cb521-6"></a>                       <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">10</span>), <span class="dt">label =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>,<span class="dv">40</span>,<span class="dv">10</span>),</span>
<span id="cb521-7"><a href="c20.html#cb521-7"></a>                       <span class="dt">guide =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Average<span class="op">~</span>temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb521-8"><a href="c20.html#cb521-8"></a>                                              <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</span>
<span id="cb521-9"><a href="c20.html#cb521-9"></a>                                              <span class="dt">title.hjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb521-10"><a href="c20.html#cb521-10"></a>                                              <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,<span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">8</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span></span>
<span id="cb521-11"><a href="c20.html#cb521-11"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb521-12"><a href="c20.html#cb521-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-389-1.png" width="672" /></p>
</div>
</div>
<div id="practical-c-handling-projections-and-coordinate-systems" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Practical C: Handling Projections and Coordinate Systems</h2>
<p>Even experienced GIS-experts can stumble over projections and World Coordinate Systems (WGS). A projection is simply a mathematical function for transforming the X and Y coordinates of a spatial object from spatial reference framework to a different spatial reference framework.</p>
<p>In short, any point on the earth can have its location specified by the degrees north or south of the equator (latitude) and west or east of the Greenwich meridian (longitude). These spherical coordinates can be transformed planar Cartesian coordinates using projection transformation equations.</p>
<p>For example, the symbol shows up in google maps at latitude = 6.2599°S and longitude = 39.2346°W</p>
<div id="htmlwidget-511d8101de1eafea4837" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-511d8101de1eafea4837">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[-6.2599,39.2346,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-6.2599,-6.2599],"lng":[39.2346,39.2346]}},"evals":[],"jsHooks":[]}</script>
<pre><code>Simple feature collection with 1 feature and 0 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: 39.2346 ymin: -6.2599 xmax: 39.2346 ymax: -6.2599
geographic CRS: WGS 84
                 geometry
1 POINT (39.2346 -6.2599)</code></pre>
<p>For the same location on the earth’s surface, the IMS WGS84 coordinates are (6.2599 , 39.2346 ) degree, and the UTM Zone 37 S coordinates are (525950.6 , 9308060 ) m.</p>
<pre><code>Simple feature collection with 1 feature and 0 fields
geometry type:  POINT
dimension:      XY
bbox:           xmin: 525950.6 ymin: 9308060 xmax: 525950.6 ymax: 9308060
projected CRS:  WGS 84 / UTM zone 37S
                  geometry
1 POINT (525950.6 9308060)</code></pre>
<blockquote>
<p><strong>BONUS</strong>: Why would you use a Cartesian Projected Coordinate reference System versus WGS84?</p>
</blockquote>
<div id="assigning-coordinate-reference-system" class="section level3" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Assigning Coordinate reference system</h3>
<p>If you have a sf spatial data frame consisting of vector data or a raster data set (covered in Chapter @(raster)) that is not tagged with its CRS, there are simple commands to do so: <code>st_crs()</code> for sf data frames and <code>crs()</code> for rasters. The function can be used to show the current CRS or to (re)define the CRS. The CRS can be specified in one of two ways, using <strong>EPSG</strong> codes, which uses numerical codes for different CRSs, or a <strong>prj4 string</strong>, which verbosely lists all the parameters for a given CRS. Using <strong>EPSG</strong> codes is more convenient than using <strong>prj4 strings</strong>.</p>
<p>If you obtain a spatial data set, one of the things you need to be absolutely certain of is its CRS. Most data sets are provided with either files (e.g., .prj files for shape files) or internal metadata (e.g., embedded in a GeoTIFF), or at least a description of their CRS. If you do not know the CRS of your data, you can make an educated guesses.</p>
<p>In any case if you have a data set that has no CRS defined, although it may not be absolutely necessary, you should define its CRS in order to follow best practices. Let’s create a data frame with coordinates of some countries:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="c20.html#cb524-1"></a><span class="kw">require</span>(sf)</span>
<span id="cb524-2"><a href="c20.html#cb524-2"></a><span class="kw">require</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="c20.html#cb525-1"></a>taasisi =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">&quot;IMS&quot;</span>, <span class="st">&quot;SUZA&quot;</span>, <span class="st">&quot;TAFIRI&quot;</span>),</span>
<span id="cb525-2"><a href="c20.html#cb525-2"></a>                 <span class="dt">lat =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">6.2599</span>, <span class="fl">-6.1647</span>,<span class="op">-</span><span class="fl">6.6689</span>), </span>
<span id="cb525-3"><a href="c20.html#cb525-3"></a>                 <span class="dt">lon =</span> <span class="kw">c</span>(<span class="fl">39.2346</span>, <span class="fl">39.1918</span>, <span class="fl">39.2148</span>))</span>
<span id="cb525-4"><a href="c20.html#cb525-4"></a></span>
<span id="cb525-5"><a href="c20.html#cb525-5"></a>taasisi</span></code></pre></div>
<pre><code>    name     lat     lon
1    IMS -6.2599 39.2346
2   SUZA -6.1647 39.1918
3 TAFIRI -6.6689 39.2148</code></pre>
<p>Then create a simple feature from the geographical coordinates</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="c20.html#cb527-1"></a>taasisi.sf =<span class="st"> </span>taasisi <span class="op">%&gt;%</span></span>
<span id="cb527-2"><a href="c20.html#cb527-2"></a><span class="st">  </span>sf<span class="op">::</span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>))</span>
<span id="cb527-3"><a href="c20.html#cb527-3"></a></span>
<span id="cb527-4"><a href="c20.html#cb527-4"></a>taasisi.sf</span></code></pre></div>
<pre><code>Simple feature collection with 3 features and 1 field
geometry type:  POINT
dimension:      XY
bbox:           xmin: 39.1918 ymin: -6.6689 xmax: 39.2346 ymax: -6.1647
CRS:            NA
    name                geometry
1    IMS POINT (39.2346 -6.2599)
2   SUZA POINT (39.1918 -6.1647)
3 TAFIRI POINT (39.2148 -6.6689)</code></pre>
<p>Looking at the printed results, we notice that the CRS is NA, implying that it has not been defined. We can confirm this by using the <code>st_crs</code> function</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="c20.html#cb529-1"></a>taasisi <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb529-2"><a href="c20.html#cb529-2"></a><span class="st">  </span>sf<span class="op">::</span><span class="kw">st_crs</span>()</span></code></pre></div>
<pre><code>Coordinate Reference System: NA</code></pre>
<p>Because we know that the geographical location were provided in decimal degrees, then we are sure that the appropriate reference system is WGS84 (EPSG = 4326), we can now set the CRS of the spatial object</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="c20.html#cb531-1"></a>taasisi.sf.wgs84 =<span class="st"> </span>taasisi.sf <span class="op">%&gt;%</span></span>
<span id="cb531-2"><a href="c20.html#cb531-2"></a><span class="st">  </span>sf<span class="op">::</span><span class="kw">st_set_crs</span>(<span class="dt">value =</span> <span class="dv">4326</span>)</span>
<span id="cb531-3"><a href="c20.html#cb531-3"></a></span>
<span id="cb531-4"><a href="c20.html#cb531-4"></a>taasisi.sf.wgs84</span></code></pre></div>
<pre><code>Simple feature collection with 3 features and 1 field
geometry type:  POINT
dimension:      XY
bbox:           xmin: 39.1918 ymin: -6.6689 xmax: 39.2346 ymax: -6.1647
geographic CRS: WGS 84
    name                geometry
1    IMS POINT (39.2346 -6.2599)
2   SUZA POINT (39.1918 -6.1647)
3 TAFIRI POINT (39.2148 -6.6689)</code></pre>
<blockquote>
<p>Note that the coordinate values remain the same when setting the CRS in the spatial object, only the metadata which changes.</p>
</blockquote>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="c20.html#cb533-1"></a>taasisi.sf.wgs84 <span class="op">%&gt;%</span></span>
<span id="cb533-2"><a href="c20.html#cb533-2"></a><span class="st">  </span>sf<span class="op">::</span><span class="kw">st_crs</span>()</span></code></pre></div>
<pre><code>Coordinate Reference System:
  User input: EPSG:4326 
  wkt:
GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&quot;geodetic latitude (Lat)&quot;,north,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        AXIS[&quot;geodetic longitude (Lon)&quot;,east,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;World&quot;],
        BBOX[-90,-180,90,180]],
    ID[&quot;EPSG&quot;,4326]]</code></pre>
</div>
<div id="transforming-coordinate-system" class="section level3" number="14.3.2">
<h3><span class="header-section-number">14.3.2</span> Transforming coordinate System</h3>
<p>The last section showed you how to define or modify the coordinate system definition. This section shows you how to transform the coordinate values associated with the spatial object to a different coordinate system. This process calculates new coordinate pair values for the points or vertices defining the spatial object. <strong>sf</strong> package has a <code>st_transform</code> function that is dedicated to transform between reference system.</p>
<p>For instance, we might want to change the WGS to UTM. That requires a basic understanding of the UTM zone. Anyway, for now we should not bother with that but bear in your mind that in most cases you will delve into EPSG = 4326 for WGS84 and EPSG = 32737 for UTM Zone 37S. I recommend you to take note of this two numbers as you will most frequent use them especially for scientists working along the coastal waters of East African region in the Indian Ocean.</p>
<p>We might want to change the WGS84 to UTM of the three taasisi we just created above. we simply pipe the process as the chunk below highlight.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="c20.html#cb535-1"></a>taasisi.sf.utm =<span class="st"> </span>taasisi.sf.wgs84 <span class="op">%&gt;%</span></span>
<span id="cb535-2"><a href="c20.html#cb535-2"></a><span class="st">  </span>sf<span class="op">::</span><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">32737</span>)</span>
<span id="cb535-3"><a href="c20.html#cb535-3"></a></span>
<span id="cb535-4"><a href="c20.html#cb535-4"></a>taasisi.sf.utm <span class="op">%&gt;%</span><span class="st"> </span>sf<span class="op">::</span><span class="kw">st_crs</span>()</span></code></pre></div>
<pre><code>Coordinate Reference System:
  User input: EPSG:32737 
  wkt:
PROJCRS[&quot;WGS 84 / UTM zone 37S&quot;,
    BASEGEOGCRS[&quot;WGS 84&quot;,
        DATUM[&quot;World Geodetic System 1984&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4326]],
    CONVERSION[&quot;UTM zone 37S&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,39,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,0.9996,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,500000,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,10000000,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;(E)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;(N)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;unknown&quot;],
        AREA[&quot;World - S hemisphere - 36Â°E to 42Â°E - by country&quot;],
        BBOX[-80,36,0,42]],
    ID[&quot;EPSG&quot;,32737]]</code></pre>
</div>
</div>
<div id="practical-d-finding-loading-and-cleaning-spatial-data" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Practical D: Finding, loading, and cleaning Spatial data</h2>
<p>One of the benefits of R is its large ecosystem of packages developed and maintained by individuals and teams, and available to the general public via CRAN. The downside of this, however, is that it is sometimes difficult for even experienced coders to determine which package is the best place to start when learning a new skill.</p>
<p>Map data (aka geospatial data or Geographic Information System data or GIS data) is no exception to this rule, and is, in fact, particularly intimidating to the uninitiated.</p>
<p>This is for two reasons: developers have created (1) different ways of storing and representing GIS data and (2) multiple, similar packages for each type of GIS data representation.</p>
<p>In the tutorials in this series, we will introduce GIS data visualization in R using the simple features standard, which has become increasingly popular in recent years and which has the smallest learning curve for those who are already comfortable with data frames and the principles of the “tidyverse.” The simple features approach works well for many common map-making applications, including drawing regions (e.g., states) or points (e.g., cities) and coloring them to create an analytical insight (e.g., shading by population density).</p>
<p>In order to manipulate and visualize data, we will rely primarily on three geospatial packages: <strong>sf</strong>, <strong>ggplot2</strong>, and <strong>leaflet</strong>. You may find that other packages assist greatly with collecting data (e.g., tidycensus for U.S. Census data) or improving the aesthitics of your map (e.g., ggspatial to add a map scale).</p>
<div id="thinking-about-map-data-the-way-r-does" class="section level3" number="14.4.1">
<h3><span class="header-section-number">14.4.1</span> Thinking about map data the way R does</h3>
<p>Many GIS programs (ArcGIS, QGIS, etc.) make it extraordinarily easy for users to create maps by loading a file with a geographic identifier and data to plot. They are designed to simply drag and drop a layers of shapefiles onto a map and automatically draw the appropriate shapes. Then, you can drag and drop a field called “population density” or “GDP per capita” onto the map, and the shapes automatically color appropriately. These “drag and drop” GIS programs do a lot of work behind the scenes to translate your geographic identifier into a geometric shape and your fields into colorful metrics.</p>
<p>In R, we have to do this work ourselves. R has no innate knowledge of what we want to graph; we have to provide every detail. This means we need to pass R the information it needs in order to, say, draw the shape of Africa or draw a line representing major roads. R needs to be told the 4 coordinates defining a rectangle; R needs to be told the hundreds of points defining a rectangle-ish shape like Africa. If we want to fill Africa with a color, we need to explicitly tell R how to do so.</p>
<p>The manual nature of GIS in R can cause some headaches, as we need to hunt down all of the information in order to provide it to R to graph. Once you have the desired information, however, you will find that the manual nature of R’s graphing allows significantly more flexibility than “drag and drop” programs allow. We are not constrained by the type of information pre-loaded into the program, by the number of shapes we can draw at once, by the color palletes provided, or by any other factor. We have complete flexibility.</p>
<p>If you want to draw state borders (polygons), county borders (more polygons), major highways (lines), and highway rest stops (points), add each of them as an individual layer to the same plot, and color them as you please. There are no constraints when visualizing geospatial data in R.</p>
<p>This post will focus on how to find, import, and clean geospatial data. The actual graphing will come in Part 2 (static maps with ggplot2) and Part 3 (interactive maps with leaflet).</p>
</div>
<div id="a-brief-introduction-to-simple-features-data-in-r" class="section level3" number="14.4.2">
<h3><span class="header-section-number">14.4.2</span> A brief introduction to simple features data in R</h3>
<p>Out in the wild, map data most frequntly comes as either geoJSON files (.geojson) or Shapefiles (.shp). These files will, at the very minimum, contain information about the geometry of each object to be drawn, such as instructions to draw a point in a certain location or to draw a polygon with certain dimensions. The raw file may, however, also contain any amount of additional information, such as a name for the object, or summary statistics (GDP per capita, total population, etc.).</p>
<p>Regardless of whether the data is geoJSON or a Shapefile, and regardless of how much additional data the file has, you can use one convenient function from the <strong>sf</strong> package to import the raw data into R as a simple features object. The function is <code>st_read()</code> and you parse the argument like the path of the shapefile in your working directory.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="c20.html#cb537-1"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb537-2"><a href="c20.html#cb537-2"></a><span class="kw">require</span>(sf)</span>
<span id="cb537-3"><a href="c20.html#cb537-3"></a><span class="kw">require</span>(rnaturalearth)</span></code></pre></div>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="c20.html#cb538-1"></a>africa =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/shp/africa.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Let’s us explore a simple feature that we just imported</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="c20.html#cb539-1"></a>africa</span></code></pre></div>
<pre><code>Simple feature collection with 59 features and 7 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -25.35875 ymin: -34.83983 xmax: 57.80085 ymax: 37.34962
geographic CRS: WGS 84
First 10 features:
   COUNT               CNTRY_NAME FIPS_CNTRY LAND_AREA_ REGIONA EMPTY
1     34                   Angola         AO     124670    &lt;NA&gt;     0
2    114                  Burundi         BY       2783    &lt;NA&gt;     0
3     77                    Benin         BN      11262    &lt;NA&gt;     0
4    301             Burkina Faso         UV      27400    &lt;NA&gt;     0
5     25                 Botswana         BC      58173    &lt;NA&gt;     0
6     51 Central African Republic         CT      62298    &lt;NA&gt;     0
7     51                 Cameroon         CM      47544    &lt;NA&gt;     0
8    186              Ivory Coast         IV      32246    &lt;NA&gt;     0
9     46                    Congo         CF      34200    &lt;NA&gt;     0
10    15               Cape Verde         CV        403    &lt;NA&gt;     0
   EMPTY2                       geometry
1       0 MULTIPOLYGON (((12.84118 -6...
2       0 MULTIPOLYGON (((29.05021 -2...
3       0 MULTIPOLYGON (((3.849006 10...
4       0 MULTIPOLYGON (((-5.272945 1...
5       0 MULTIPOLYGON (((23.14635 -1...
6       0 MULTIPOLYGON (((22.03557 4....
7       0 MULTIPOLYGON (((9.640797 3....
8       0 MULTIPOLYGON (((-6.091862 4...
9       0 MULTIPOLYGON (((16.45276 2....
10      0 MULTIPOLYGON (((-24.64849 1...</code></pre>
<p>The object provide summary, which are;</p>
<ol style="list-style-type: decimal">
<li>We have 59 features and four fields. Each row (feature) represent individual country in Africa and Each column is a field with (potentially) useful information about the feature. Note that the geometry column is not considered a field</li>
<li>We are told this is a collection of multi–polygons, as opposed to points, lines, etc.</li>
<li>We are told the bounding box for our data (the most western/eastern longitudes and northern/southern latitudes)</li>
<li>We are told the Coordinate Reference System (CRS), which in this case is “WGS 84.” CRSs are cartographers’ ways of telling each other what system they used for describing points on the earth. Cartographers need to pick an equation for an ellipsoid to approximate earth’s shape since it’s slightly pear-shaped. Cartographers also need to determine a set of reference markers–known as a datum–to use to set coordinates, as earth’s tectonic plates shift ever so slightly over time. Togehether, the ellipsoid and datum become a CRS.</li>
<li>And the last information is a column called <code>geometry</code>. This column contains everything that R will need to draw boundary of each country in Africa.</li>
</ol>
</div>
<div id="finding-data" class="section level3" number="14.4.3">
<h3><span class="header-section-number">14.4.3</span> Finding data</h3>
<p>Simple features data in R will always look similar to the example above. You will have some metadata describing the type of geometry, the CRS, and so on; a “geometry” column; and optionally some fields of additional data. The trouble comes in trying to find the data you need–both the geometry and the proper additional fields–and getting them together into the same object in R.</p>
<p>Fortunate, the package <strong>rnaturalearth</strong>, which is a well-supported part of the rOpenSci project, provides easy access to global data. We can import directly as a simple features object. Here’s a quick look at how to import all the countries in Asia.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="c20.html#cb541-1"></a>ne.africa =<span class="st"> </span>rnaturalearth<span class="op">::</span><span class="kw">ne_countries</span>(<span class="dt">continent =</span> <span class="st">&quot;Africa&quot;</span>, </span>
<span id="cb541-2"><a href="c20.html#cb541-2"></a>                                 <span class="dt">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb541-3"><a href="c20.html#cb541-3"></a></span>
<span id="cb541-4"><a href="c20.html#cb541-4"></a>ne.africa</span></code></pre></div>
<pre><code>Simple feature collection with 51 features and 63 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -17.62504 ymin: -34.81917 xmax: 51.13387 ymax: 37.34999
CRS:            +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
First 10 features:
   scalerank      featurecla labelrank                       sovereignt
1          1 Admin-0 country         3                           Angola
11         1 Admin-0 country         6                          Burundi
13         1 Admin-0 country         5                            Benin
14         1 Admin-0 country         3                     Burkina Faso
25         1 Admin-0 country         4                         Botswana
26         1 Admin-0 country         4         Central African Republic
31         1 Admin-0 country         3                      Ivory Coast
32         1 Admin-0 country         3                         Cameroon
33         1 Admin-0 country         2 Democratic Republic of the Congo
34         1 Admin-0 country         4                Republic of Congo
   sov_a3 adm0_dif level              type
1     AGO        0     2 Sovereign country
11    BDI        0     2 Sovereign country
13    BEN        0     2 Sovereign country
14    BFA        0     2 Sovereign country
25    BWA        0     2 Sovereign country
26    CAF        0     2 Sovereign country
31    CIV        0     2 Sovereign country
32    CMR        0     2 Sovereign country
33    COD        0     2 Sovereign country
34    COG        0     2 Sovereign country
                              admin adm0_a3 geou_dif
1                            Angola     AGO        0
11                          Burundi     BDI        0
13                            Benin     BEN        0
14                     Burkina Faso     BFA        0
25                         Botswana     BWA        0
26         Central African Republic     CAF        0
31                      Ivory Coast     CIV        0
32                         Cameroon     CMR        0
33 Democratic Republic of the Congo     COD        0
34                Republic of Congo     COG        0
                            geounit gu_a3 su_dif
1                            Angola   AGO      0
11                          Burundi   BDI      0
13                            Benin   BEN      0
14                     Burkina Faso   BFA      0
25                         Botswana   BWA      0
26         Central African Republic   CAF      0
31                      Ivory Coast   CIV      0
32                         Cameroon   CMR      0
33 Democratic Republic of the Congo   COD      0
34                Republic of Congo   COG      0
                            subunit su_a3 brk_diff                 name
1                            Angola   AGO        0               Angola
11                          Burundi   BDI        0              Burundi
13                            Benin   BEN        0                Benin
14                     Burkina Faso   BFA        0         Burkina Faso
25                         Botswana   BWA        0             Botswana
26         Central African Republic   CAF        0 Central African Rep.
31                      Ivory Coast   CIV        0        Côte d&#39;Ivoire
32                         Cameroon   CMR        0             Cameroon
33 Democratic Republic of the Congo   COD        0      Dem. Rep. Congo
34                Republic of Congo   COG        0                Congo
                          name_long brk_a3
1                            Angola    AGO
11                          Burundi    BDI
13                            Benin    BEN
14                     Burkina Faso    BFA
25                         Botswana    BWA
26         Central African Republic    CAF
31                    Côte d&#39;Ivoire    CIV
32                         Cameroon    CMR
33 Democratic Republic of the Congo    COD
34                Republic of Congo    COG
                           brk_name brk_group     abbrev postal
1                            Angola      &lt;NA&gt;       Ang.     AO
11                          Burundi      &lt;NA&gt;       Bur.     BI
13                            Benin      &lt;NA&gt;      Benin     BJ
14                     Burkina Faso      &lt;NA&gt;       B.F.     BF
25                         Botswana      &lt;NA&gt;       Bwa.     BW
26             Central African Rep.      &lt;NA&gt;     C.A.R.     CF
31                    Côte d&#39;Ivoire      &lt;NA&gt;       I.C.     CI
32                         Cameroon      &lt;NA&gt;       Cam.     CM
33 Democratic Republic of the Congo      &lt;NA&gt;     D.R.C.    DRC
34                Republic of Congo      &lt;NA&gt; Rep. Congo     CG
                          formal_en                 formal_fr note_adm0
1       People&#39;s Republic of Angola                      &lt;NA&gt;      &lt;NA&gt;
11              Republic of Burundi                      &lt;NA&gt;      &lt;NA&gt;
13                Republic of Benin                      &lt;NA&gt;      &lt;NA&gt;
14                     Burkina Faso                      &lt;NA&gt;      &lt;NA&gt;
25             Republic of Botswana                      &lt;NA&gt;      &lt;NA&gt;
26         Central African Republic                      &lt;NA&gt;      &lt;NA&gt;
31          Republic of Ivory Coast Republic of Cote D&#39;Ivoire      &lt;NA&gt;
32             Republic of Cameroon                      &lt;NA&gt;      &lt;NA&gt;
33 Democratic Republic of the Congo                      &lt;NA&gt;      &lt;NA&gt;
34                Republic of Congo                      &lt;NA&gt;      &lt;NA&gt;
   note_brk                name_sort name_alt mapcolor7 mapcolor8
1      &lt;NA&gt;                   Angola     &lt;NA&gt;         3         2
11     &lt;NA&gt;                  Burundi     &lt;NA&gt;         2         2
13     &lt;NA&gt;                    Benin     &lt;NA&gt;         1         2
14     &lt;NA&gt;             Burkina Faso     &lt;NA&gt;         2         1
25     &lt;NA&gt;                 Botswana     &lt;NA&gt;         6         5
26     &lt;NA&gt; Central African Republic     &lt;NA&gt;         5         6
31     &lt;NA&gt;            Côte d&#39;Ivoire     &lt;NA&gt;         4         6
32     &lt;NA&gt;                 Cameroon     &lt;NA&gt;         1         4
33     &lt;NA&gt;         Congo, Dem. Rep.     &lt;NA&gt;         4         4
34     &lt;NA&gt;              Congo, Rep.     &lt;NA&gt;         2         1
   mapcolor9 mapcolor13  pop_est gdp_md_est pop_year lastcensus gdp_year
1          6          1 12799293     110300       NA       1970       NA
11         5          8  8988091       3102       NA       2008       NA
13         2         12  8791832      12830       NA       2002       NA
14         5         11 15746232      17820       NA       2006       NA
25         7          3  1990876      27060       NA       2011       NA
26         6          9  4511488       3198       NA       2003       NA
31         3          3 20617068      33850       NA       1998       NA
32         1          3 18879301      42750       NA       2005       NA
33         4          7 68692542      20640       NA       1984       NA
34         3         10  4012809      15350       NA       2007       NA
                     economy             income_grp wikipedia fips_10
1  7. Least developed region 3. Upper middle income        NA    &lt;NA&gt;
11 7. Least developed region          5. Low income        NA    &lt;NA&gt;
13 7. Least developed region          5. Low income        NA    &lt;NA&gt;
14 7. Least developed region          5. Low income        NA    &lt;NA&gt;
25      6. Developing region 3. Upper middle income        NA    &lt;NA&gt;
26 7. Least developed region          5. Low income        NA    &lt;NA&gt;
31      6. Developing region 4. Lower middle income        NA    &lt;NA&gt;
32      6. Developing region 4. Lower middle income        NA    &lt;NA&gt;
33 7. Least developed region          5. Low income        NA    &lt;NA&gt;
34      6. Developing region 4. Lower middle income        NA    &lt;NA&gt;
   iso_a2 iso_a3 iso_n3 un_a3 wb_a2 wb_a3 woe_id adm0_a3_is adm0_a3_us
1      AO    AGO    024   024    AO   AGO     NA        AGO        AGO
11     BI    BDI    108   108    BI   BDI     NA        BDI        BDI
13     BJ    BEN    204   204    BJ   BEN     NA        BEN        BEN
14     BF    BFA    854   854    BF   BFA     NA        BFA        BFA
25     BW    BWA    072   072    BW   BWA     NA        BWA        BWA
26     CF    CAF    140   140    CF   CAF     NA        CAF        CAF
31     CI    CIV    384   384    CI   CIV     NA        CIV        CIV
32     CM    CMR    120   120    CM   CMR     NA        CMR        CMR
33     CD    COD    180   180    ZR   ZAR     NA        COD        COD
34     CG    COG    178   178    CG   COG     NA        COG        COG
   adm0_a3_un adm0_a3_wb continent region_un       subregion
1          NA         NA    Africa    Africa   Middle Africa
11         NA         NA    Africa    Africa  Eastern Africa
13         NA         NA    Africa    Africa  Western Africa
14         NA         NA    Africa    Africa  Western Africa
25         NA         NA    Africa    Africa Southern Africa
26         NA         NA    Africa    Africa   Middle Africa
31         NA         NA    Africa    Africa  Western Africa
32         NA         NA    Africa    Africa   Middle Africa
33         NA         NA    Africa    Africa   Middle Africa
34         NA         NA    Africa    Africa   Middle Africa
            region_wb name_len long_len abbrev_len tiny homepart
1  Sub-Saharan Africa        6        6          4   NA        1
11 Sub-Saharan Africa        7        7          4   NA        1
13 Sub-Saharan Africa        5        5          5   NA        1
14 Sub-Saharan Africa       12       12          4   NA        1
25 Sub-Saharan Africa        8        8          4   NA        1
26 Sub-Saharan Africa       20       24          6   NA        1
31 Sub-Saharan Africa       13       13          4   NA        1
32 Sub-Saharan Africa        8        8          4   NA        1
33 Sub-Saharan Africa       15       32          6   NA        1
34 Sub-Saharan Africa        5       17         10   NA        1
                         geometry
1  MULTIPOLYGON (((16.32653 -5...
11 MULTIPOLYGON (((29.34 -4.49...
13 MULTIPOLYGON (((2.691702 6....
14 MULTIPOLYGON (((-2.827496 9...
25 MULTIPOLYGON (((25.64916 -1...
26 MULTIPOLYGON (((15.27946 7....
31 MULTIPOLYGON (((-2.856125 4...
32 MULTIPOLYGON (((13.07582 2....
33 MULTIPOLYGON (((30.83386 3....
34 MULTIPOLYGON (((12.99552 -4...</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-405"></span>
<img src="geoMarine_files/figure-html/unnamed-chunk-405-1.png" alt="Basim map of countries in Africa. Source:rnaturalearth R package" width="672" />
<p class="caption">
Figure 14.1: Basim map of countries in Africa. Source:rnaturalearth R package
</p>
</div>
</div>
<div id="finding-non-geospatial-data" class="section level3" number="14.4.4">
<h3><span class="header-section-number">14.4.4</span> Finding non-geospatial data</h3>
<p>Chances are that you are coming to a geospatial mapping project with a particular dataset in mind. Perhaps you want to explore the GDP in Africa. To do this, we will need to find the Global Domestic Product data for each country. The World Bank offers that data in their website as table. Unfortunately, the website of World Bank is not always intuitive to navigate, as the data live in many different tables from different goverment surveys. Fortunately, R has a <strong>wbstats</strong> package that make life easy to query the World Bank database on the indicator of interest.</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="c20.html#cb543-1"></a>my.indicators =<span class="st"> </span><span class="kw">c</span>(<span class="dt">life_exp =</span> <span class="st">&quot;SP.DYN.LE00.IN&quot;</span>, </span>
<span id="cb543-2"><a href="c20.html#cb543-2"></a>                  <span class="dt">gdp_capita =</span><span class="st">&quot;NY.GDP.PCAP.CD&quot;</span>, </span>
<span id="cb543-3"><a href="c20.html#cb543-3"></a>                  <span class="dt">pop =</span> <span class="st">&quot;SP.POP.TOTL&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="c20.html#cb544-1"></a><span class="co"># # check the code for the indicator</span></span>
<span id="cb544-2"><a href="c20.html#cb544-2"></a><span class="co"># wbstats::wb_cachelist</span></span>
<span id="cb544-3"><a href="c20.html#cb544-3"></a></span>
<span id="cb544-4"><a href="c20.html#cb544-4"></a></span>
<span id="cb544-5"><a href="c20.html#cb544-5"></a><span class="co">## data</span></span>
<span id="cb544-6"><a href="c20.html#cb544-6"></a>wb.data =<span class="st"> </span>wbstats<span class="op">::</span><span class="kw">wb_data</span>(<span class="dt">indicator =</span> my.indicators, <span class="dt">start_date =</span> <span class="dv">2016</span>)</span>
<span id="cb544-7"><a href="c20.html#cb544-7"></a></span>
<span id="cb544-8"><a href="c20.html#cb544-8"></a><span class="co">## source</span></span>
<span id="cb544-9"><a href="c20.html#cb544-9"></a>source =<span class="st"> </span>wbstats<span class="op">::</span>wb_cachelist<span class="op">$</span>indicators</span>
<span id="cb544-10"><a href="c20.html#cb544-10"></a></span>
<span id="cb544-11"><a href="c20.html#cb544-11"></a>source <span class="op">%&gt;%</span></span>
<span id="cb544-12"><a href="c20.html#cb544-12"></a><span class="st">  </span><span class="kw">filter</span>(indicator_id <span class="op">==</span><span class="st"> &quot;NY.GDP.PCAP.CD&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb544-13"><a href="c20.html#cb544-13"></a><span class="st">  </span><span class="kw">pull</span>(source_org)</span></code></pre></div>
</div>
<div id="combining-spatial-data-with-non-spatial-data" class="section level3" number="14.4.5">
<h3><span class="header-section-number">14.4.5</span> Combining spatial data with non-spatial data</h3>
<p>Now we have our spatial Africa countries data and the non–spatial GDP data in tabular form. How in the world do we plot this? Four simple steps to prepare your data for graphing.</p>
<ul>
<li>Import all data (already completed above)</li>
<li>Clean your geospatial data frame</li>
<li>Combine non-spatial data into a single, clean data frame</li>
<li>Merge your two data frames together</li>
</ul>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="c20.html#cb545-1"></a>africa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 59
Columns: 8
$ COUNT      &lt;dbl&gt; 34, 114, 77, 301, 25, 51, 51, 186, 46, 15, 8, 48, ...
$ CNTRY_NAME &lt;fct&gt; &quot;Angola&quot;, &quot;Burundi&quot;, &quot;Benin&quot;, &quot;Burkina Faso&quot;, &quot;Bot...
$ FIPS_CNTRY &lt;fct&gt; AO, BY, BN, UV, BC, CT, CM, IV, CF, CV, DJ, AG, EG...
$ LAND_AREA_ &lt;dbl&gt; 124670, 2783, 11262, 27400, 58173, 62298, 47544, 3...
$ REGIONA    &lt;fct&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA...
$ EMPTY      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ EMPTY2     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...
$ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((12.84118 -6..., MULTI...</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="c20.html#cb547-1"></a>wb.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 217
Columns: 7
$ iso2c      &lt;chr&gt; &quot;AW&quot;, &quot;AF&quot;, &quot;AO&quot;, &quot;AL&quot;, &quot;AD&quot;, &quot;AE&quot;, &quot;AR&quot;, &quot;AM&quot;, &quot;A...
$ iso3c      &lt;chr&gt; &quot;ABW&quot;, &quot;AFG&quot;, &quot;AGO&quot;, &quot;ALB&quot;, &quot;AND&quot;, &quot;ARE&quot;, &quot;ARG&quot;, &quot;...
$ country    &lt;chr&gt; &quot;Aruba&quot;, &quot;Afghanistan&quot;, &quot;Angola&quot;, &quot;Albania&quot;, &quot;Ando...
$ date       &lt;dbl&gt; 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 20...
$ gdp_capita &lt;dbl&gt; 28281.3505, 509.2187, 3506.0729, 4124.0557, 37474....
$ life_exp   &lt;dbl&gt; 75.86800, 63.76300, 59.92500, 78.19400, NA, 77.470...
$ pop        &lt;dbl&gt; 104872, 35383128, 28842484, 2876101, 77297, 936098...</code></pre>
<p>We notice that, the spatial africa simple feature and non–spatial GDP data have one common variable—country name—thought labeled different. We can use this columns as key to combine the two dataset. Before we do that, we have to clean and rename those columns to a common word—<code>country</code></p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="c20.html#cb549-1"></a>africa =<span class="st"> </span>africa <span class="op">%&gt;%</span></span>
<span id="cb549-2"><a href="c20.html#cb549-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">country =</span> CNTRY_NAME, <span class="dt">country_code =</span> FIPS_CNTRY) </span>
<span id="cb549-3"><a href="c20.html#cb549-3"></a></span>
<span id="cb549-4"><a href="c20.html#cb549-4"></a>wb.data =<span class="st"> </span>wb.data <span class="op">%&gt;%</span></span>
<span id="cb549-5"><a href="c20.html#cb549-5"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">country_code =</span> iso2c)</span></code></pre></div>
<p>A <strong>dplyr</strong> package has several functions for combining spatial and non-spatial data. Since we need to retain matching dataset from the shapefile, we use <code>left_join()</code> function and combine using the column <code>country</code>, which is found in both dataset. The <code>left_join</code> function will keep all rows from the spatial dataset and fill in NA for missing non-spatial rows.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="c20.html#cb550-1"></a>africa.gdp =<span class="st"> </span>africa <span class="op">%&gt;%</span></span>
<span id="cb550-2"><a href="c20.html#cb550-2"></a><span class="st">  </span><span class="kw">left_join</span>(wb.data,  <span class="dt">by =</span> <span class="st">&quot;country&quot;</span>)</span>
<span id="cb550-3"><a href="c20.html#cb550-3"></a></span>
<span id="cb550-4"><a href="c20.html#cb550-4"></a>africa.gdp </span></code></pre></div>
<pre><code>Simple feature collection with 59 features and 8 fields
geometry type:  MULTIPOLYGON
dimension:      XY
bbox:           xmin: -25.35875 ymin: -34.83983 xmax: 57.80085 ymax: 37.34962
geographic CRS: WGS 84
First 10 features:
                    country country_code.x country_code.y iso3c date
1                    Angola             AO             AO   AGO 2016
2                   Burundi             BY             BI   BDI 2016
3                     Benin             BN             BJ   BEN 2016
4              Burkina Faso             UV             BF   BFA 2016
5                  Botswana             BC             BW   BWA 2016
6  Central African Republic             CT             CF   CAF 2016
7                  Cameroon             CM             CM   CMR 2016
8               Ivory Coast             IV           &lt;NA&gt;  &lt;NA&gt;   NA
9                     Congo             CF           &lt;NA&gt;  &lt;NA&gt;   NA
10               Cape Verde             CV           &lt;NA&gt;  &lt;NA&gt;   NA
   gdp_capita life_exp      pop                       geometry
1   3506.0729   59.925 28842484 MULTIPOLYGON (((12.84118 -6...
2    282.1931   60.528 10487998 MULTIPOLYGON (((29.05021 -2...
3   1087.2878   60.885 10872067 MULTIPOLYGON (((3.849006 10...
4    688.2497   60.354 18646378 MULTIPOLYGON (((-5.272945 1...
5   7243.8703   68.178  2159944 MULTIPOLYGON (((23.14635 -1...
6    402.1913   51.593  4537687 MULTIPOLYGON (((22.03557 4....
7   1364.3301   58.063 23926539 MULTIPOLYGON (((9.640797 3....
8          NA       NA       NA MULTIPOLYGON (((-6.091862 4...
9          NA       NA       NA MULTIPOLYGON (((16.45276 2....
10         NA       NA       NA MULTIPOLYGON (((-24.64849 1...</code></pre>
<p>Once we have combined the non-spatial data into the spatial, we are now ready to map the distribution of GDP across Africa. We use the <strong>ggplot</strong> package to map this distribution as shown in the chunk below and the figure thereafter</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="c20.html#cb552-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> africa.gdp, <span class="kw">aes</span>(<span class="dt">fill =</span> gdp_capita)) <span class="op">+</span></span>
<span id="cb552-2"><a href="c20.html#cb552-2"></a><span class="st">  </span><span class="kw">geom_sf</span>()<span class="op">+</span></span>
<span id="cb552-3"><a href="c20.html#cb552-3"></a><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>()<span class="op">+</span></span>
<span id="cb552-4"><a href="c20.html#cb552-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="ot">NULL</span>, </span>
<span id="cb552-5"><a href="c20.html#cb552-5"></a>       <span class="co"># title = &quot;Gross Domestic Product for 2016&quot;, </span></span>
<span id="cb552-6"><a href="c20.html#cb552-6"></a>       <span class="dt">caption =</span> <span class="st">&quot;Source World Bank national accounts data, and OECD National Accounts data files.&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-414"></span>
<img src="geoMarine_files/figure-html/unnamed-chunk-414-1.png" alt="The Africa's countries Gross Domestic Product for 2016" width="672" />
<p class="caption">
Figure 14.2: The Africa’s countries Gross Domestic Product for 2016
</p>
</div>
</div>
<div id="conclusion" class="section level3" number="14.4.6">
<h3><span class="header-section-number">14.4.6</span> Conclusion</h3>
<p>To conclude, we have now seen how to find geospatial data and import it into R as a simple features object. We have seen how to find World Bank data or other non-spatial data and import it into R. We have seen how to tidy both geospatial and non-spatial data and join them as a single dataset in preparation for visualization. Finally, we have had a brief preview of how to plot using ggplot2. Visualization was not a focus of this post, but how can we write a whole post on maps without showing you a single map!</p>
</div>
</div>
<div id="practical-e-making-maps-with-ggplot2" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Practical E: Making maps with ggplot2</h2>
<p>To draw static maps in R, we will use <strong>ggplot2</strong>, which is not only the standard package for drawing traditional bar plots, line plots, historgrams, and other standard visualizations of discrete or continuous data, but is also the standard package for drawing maps. A few other packages are excellent alternatives, including <strong>sf</strong> and <strong>maps</strong>. We prefer <strong>ggplot2</strong> because it has a consistent grammar of graphics between its various applications and offers a robust set of geospatial graphing functions.</p>
<p>Let’s take a moment to refresh ourselves on ggplot2’s functionality. To make a plot, you need three steps: (1) initate the plot, (2) add as many data layers as you want, and (3) adjust plot aesthetics, including scales, titles, and footnotes.</p>
<p>To (1) initiate the plot, we first call <code>ggplot()</code>, and to (2) add data layers, we next call <code>geom_sf()</code> once for each layer. In <strong>ggplot2</strong>, functions inherit from functions called higher up. Thus, if we call <code>ggplot(data = neighborhoods)</code>, we do not need to subsequently specify <code>geom_sf(data = neighborhoods)</code>, as the data argument is inherited in <code>geom_sf()</code>. The same goes for aesthetics. If we specify <code>ggplot(data = neighborhoods, aes(fill = FILL_GROUP))</code>, the subsequent <code>geom_sf()</code> call will already know how we want to color our plot. The behavior of inheriting aesthetics is convenient for drawing graphs that only use one dataset, which is most common in non-geospatial visualiation. A line plot might call both <code>geom_line()</code> and <code>geom_point()</code> and want both the lines and points to inherit the same dataset. Since maps frequently have many layers from different sources, we will elect to specify our data and aesthetics within the <code>geom_sf()</code> calls and not in the <code>ggplot()</code> calls.</p>
<p>Finally, to (3) adjust overall <code>aesthictics</code>, we will use a range of functions, such as the <code>theme_*</code> family of functions, the <code>scale_fill_*</code> family of functions, and the <code>coord_sf(</code>) function. Before we get there, we need to load the package we are going to use and also prepare the data.</p>
<p>Load package</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="c20.html#cb553-1"></a><span class="kw">require</span>(sf)</span>
<span id="cb553-2"><a href="c20.html#cb553-2"></a><span class="kw">require</span>(tidyverse)</span></code></pre></div>
<div id="import-and-clean-the-datasets" class="section level3" number="14.5.1">
<h3><span class="header-section-number">14.5.1</span> Import and clean the datasets</h3>
<p>The code below are used to load and clean the dataset we will be using in this assignment. The first dataset is the shapefile of Africa’s countries. This dataset is a polygon and will form a basemap for layering on additional features while making a map. The second dataset is also the mangrove, which is also a polygon containing mangrove forest locations along the coastal areas of Tanzania mainland and Zanzibar. The third dataset—<code>stations.names</code> contains points representing locations of sampling in the Rufiji delta.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="c20.html#cb554-1"></a><span class="co">#read Africa continental shapefile that we will use throught the munuscript as basemap dataset for maps</span></span>
<span id="cb554-2"><a href="c20.html#cb554-2"></a>africa =<span class="st"> </span><span class="kw">read_sf</span>(<span class="st">&quot;E:/Data Manipulation/nyamisi/regional/africa.shp&quot;</span>)</span>
<span id="cb554-3"><a href="c20.html#cb554-3"></a></span>
<span id="cb554-4"><a href="c20.html#cb554-4"></a><span class="co"># clean the file</span></span>
<span id="cb554-5"><a href="c20.html#cb554-5"></a>tz =<span class="st"> </span>africa <span class="op">%&gt;%</span></span>
<span id="cb554-6"><a href="c20.html#cb554-6"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(FIPS_CNTRY, REGIONA, EMPTY, EMPTY2)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb554-7"><a href="c20.html#cb554-7"></a><span class="st">  </span><span class="kw">filter</span>(CNTRY_NAME <span class="op">==</span><span class="st"> &quot;Tanzania&quot;</span>)</span>
<span id="cb554-8"><a href="c20.html#cb554-8"></a></span>
<span id="cb554-9"><a href="c20.html#cb554-9"></a>mangrove =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;e:/GIS/Projects/MASTER/tansea/tza_mangroves_50k.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span>
<span id="cb554-10"><a href="c20.html#cb554-10"></a>coral =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;e:/GIS/Projects/MASTER/tansea/tza_coral_reefs_50k.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span>
<span id="cb554-11"><a href="c20.html#cb554-11"></a></span>
<span id="cb554-12"><a href="c20.html#cb554-12"></a>stations =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;e:/Data Manipulation/maps/files/mindu_stations.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span>
<span id="cb554-13"><a href="c20.html#cb554-13"></a></span>
<span id="cb554-14"><a href="c20.html#cb554-14"></a>station.names =<span class="st"> </span>stations <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb554-15"><a href="c20.html#cb554-15"></a><span class="st">  </span><span class="kw">st_coordinates</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb554-16"><a href="c20.html#cb554-16"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb554-17"><a href="c20.html#cb554-17"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">lon =</span> <span class="dv">1</span>, <span class="dt">lat =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb554-18"><a href="c20.html#cb554-18"></a><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">st_drop_geometry</span>(stations))</span>
<span id="cb554-19"><a href="c20.html#cb554-19"></a></span>
<span id="cb554-20"><a href="c20.html#cb554-20"></a>names.df =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;e:/Data Manipulation/maps/files/mindu_stations_names.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb554-21"><a href="c20.html#cb554-21"></a><span class="st">  </span>wior<span class="op">::</span><span class="kw">point_tb</span>()</span></code></pre></div>
<p>And then make a simple plot with just our two data layers.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="c20.html#cb555-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb555-2"><a href="c20.html#cb555-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> tz, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;#DCDDDE&quot;</span>, <span class="dt">size =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb555-3"><a href="c20.html#cb555-3"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> mangrove, <span class="dt">fill =</span> <span class="st">&quot;#9D9D9E&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>)<span class="op">+</span></span>
<span id="cb555-4"><a href="c20.html#cb555-4"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.22</span>,<span class="fl">39.62</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">8.25</span>,<span class="op">-</span><span class="fl">7.74</span>), <span class="dt">crs =</span> <span class="dv">4326</span>)<span class="op">+</span></span>
<span id="cb555-5"><a href="c20.html#cb555-5"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">%+%</span></span>
<span id="cb555-6"><a href="c20.html#cb555-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;#FFFFFF&quot;</span>),</span>
<span id="cb555-7"><a href="c20.html#cb555-7"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb555-8"><a href="c20.html#cb555-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.27</span>, <span class="fl">39.57</span>, <span class="dt">length.out =</span> <span class="dv">4</span>), <span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb555-9"><a href="c20.html#cb555-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.2</span>,<span class="op">-</span><span class="fl">7.75</span>, <span class="dt">length.out =</span> <span class="dv">6</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-417-1.png" width="624" /></p>
</div>
<div id="add-highlights-and-annotations" class="section level3" number="14.5.2">
<h3><span class="header-section-number">14.5.2</span> Add highlights and annotations</h3>
<p>I want to highlight and annotate my map. Since the highlight rule need to distinguish land from mangroves and water, we need to add and specify color for each particular component. First we use <code>fill</code> argument to define the land color to <code>#DCDDDE</code> and mangrove <code>#9D9D9E</code>. We also add the label text using <code>ggrepel::geom_text_repel()</code> using the <code>aes(label = names)</code> to specify the text and other parameters to adjust how it appears on the plot.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="c20.html#cb556-1"></a>map =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb556-2"><a href="c20.html#cb556-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> tz, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;#DCDDDE&quot;</span>, <span class="dt">size =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb556-3"><a href="c20.html#cb556-3"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> mangrove, <span class="dt">fill =</span> <span class="st">&quot;#9D9D9E&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>)<span class="op">+</span></span>
<span id="cb556-4"><a href="c20.html#cb556-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> names.df, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span></span>
<span id="cb556-5"><a href="c20.html#cb556-5"></a><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> names.df, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">label =</span> names), </span>
<span id="cb556-6"><a href="c20.html#cb556-6"></a>                            <span class="dt">point.padding =</span> <span class="fl">.25</span>, <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">nudge_x =</span> <span class="fl">0.025</span>)<span class="op">+</span></span>
<span id="cb556-7"><a href="c20.html#cb556-7"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.22</span>,<span class="fl">39.62</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">8.25</span>,<span class="op">-</span><span class="fl">7.74</span>), <span class="dt">crs =</span> <span class="dv">4326</span>)<span class="op">+</span></span>
<span id="cb556-8"><a href="c20.html#cb556-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">%+%</span></span>
<span id="cb556-9"><a href="c20.html#cb556-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;#FFFFFF&quot;</span>),</span>
<span id="cb556-10"><a href="c20.html#cb556-10"></a>        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb556-11"><a href="c20.html#cb556-11"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb556-12"><a href="c20.html#cb556-12"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.27</span>, <span class="fl">39.57</span>, <span class="dt">length.out =</span> <span class="dv">4</span>), <span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb556-13"><a href="c20.html#cb556-13"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.2</span>,<span class="op">-</span><span class="fl">7.75</span>, <span class="dt">length.out =</span> <span class="dv">6</span>)) <span class="op">+</span></span>
<span id="cb556-14"><a href="c20.html#cb556-14"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">height =</span> <span class="kw">unit</span>(.<span class="dv">7</span>, <span class="st">&quot;cm&quot;</span>))<span class="op">+</span></span>
<span id="cb556-15"><a href="c20.html#cb556-15"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>)</span>
<span id="cb556-16"><a href="c20.html#cb556-16"></a></span>
<span id="cb556-17"><a href="c20.html#cb556-17"></a>map</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-418-1.png" width="624" /></p>
</div>
<div id="inset-map" class="section level3" number="14.5.3">
<h3><span class="header-section-number">14.5.3</span> inset map</h3>
<p>An inset map is a smaller map featured on the same page as the main map. Traditionally, inset maps are shown at a larger scale (smaller area) than the main map. Often, an inset map is used as a locator map that shows the area of the main map in a broader, more familiar geographical frame of reference.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="c20.html#cb557-1"></a><span class="kw">require</span>(tmap)</span>
<span id="cb557-2"><a href="c20.html#cb557-2"></a></span>
<span id="cb557-3"><a href="c20.html#cb557-3"></a><span class="kw">data</span>(<span class="st">&quot;World&quot;</span>)</span>
<span id="cb557-4"><a href="c20.html#cb557-4"></a></span>
<span id="cb557-5"><a href="c20.html#cb557-5"></a>africa =<span class="st"> </span>World <span class="op">%&gt;%</span></span>
<span id="cb557-6"><a href="c20.html#cb557-6"></a><span class="st">  </span><span class="kw">st_transform</span>(<span class="dv">4326</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb557-7"><a href="c20.html#cb557-7"></a><span class="st">  </span><span class="kw">filter</span>(continent <span class="op">==</span><span class="st"> &quot;Africa&quot;</span>)</span>
<span id="cb557-8"><a href="c20.html#cb557-8"></a></span>
<span id="cb557-9"><a href="c20.html#cb557-9"></a>extent =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lon =</span> <span class="kw">c</span>(<span class="fl">39.0</span>, <span class="fl">39.8</span>, <span class="fl">39.8</span>, <span class="fl">39.0</span>, <span class="fl">39.0</span>),</span>
<span id="cb557-10"><a href="c20.html#cb557-10"></a>           <span class="dt">lat =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">8.2</span>,<span class="op">-</span><span class="fl">8.2</span>,<span class="op">-</span><span class="fl">7.5</span>,<span class="op">-</span><span class="fl">7.5</span>,<span class="op">-</span><span class="fl">8.2</span>))</span>
<span id="cb557-11"><a href="c20.html#cb557-11"></a></span>
<span id="cb557-12"><a href="c20.html#cb557-12"></a>inset =<span class="st"> </span>africa <span class="op">%&gt;%</span></span>
<span id="cb557-13"><a href="c20.html#cb557-13"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb557-14"><a href="c20.html#cb557-14"></a><span class="st">  </span><span class="kw">geom_sf</span>()<span class="op">+</span></span>
<span id="cb557-15"><a href="c20.html#cb557-15"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> extent, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), </span>
<span id="cb557-16"><a href="c20.html#cb557-16"></a>            <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">1.05</span>, <span class="dt">lineend =</span> <span class="st">&quot;square&quot;</span>, <span class="dt">linejoin =</span> <span class="st">&quot;mitre&quot;</span>)<span class="op">+</span></span>
<span id="cb557-17"><a href="c20.html#cb557-17"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">30.1</span>,<span class="dv">50</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">24.0</span>,<span class="dv">5</span>))<span class="op">+</span></span>
<span id="cb557-18"><a href="c20.html#cb557-18"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb557-19"><a href="c20.html#cb557-19"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb557-20"><a href="c20.html#cb557-20"></a>        <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb557-21"><a href="c20.html#cb557-21"></a>        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb557-22"><a href="c20.html#cb557-22"></a>        <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb557-23"><a href="c20.html#cb557-23"></a>        <span class="dt">plot.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb557-24"><a href="c20.html#cb557-24"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))</span>
<span id="cb557-25"><a href="c20.html#cb557-25"></a></span>
<span id="cb557-26"><a href="c20.html#cb557-26"></a>inset</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-419-1.png" width="672" /></p>
<p>then we combine the main map and an inset using functions from <strong>cowplot</strong> package as the chunk below highlight</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="c20.html#cb558-1"></a>cowplot<span class="op">::</span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb558-2"><a href="c20.html#cb558-2"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> map,<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb558-3"><a href="c20.html#cb558-3"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> inset, <span class="dt">x =</span> <span class="fl">0.62</span>, <span class="dt">y =</span> <span class="fl">.075</span>, <span class="dt">width =</span> <span class="fl">.32</span>, <span class="dt">height =</span> <span class="fl">.32</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-420-1.png" width="624" /></p>
</div>
<div id="final-beautification" class="section level3" number="14.5.4">
<h3><span class="header-section-number">14.5.4</span> Final beautification</h3>
<p>The options for beautifying your map are endless. Some people like to add a scale and north arrow using the <strong>ggspatial</strong> package. I prefer to leave it off but to add axis labels, a title and subtitle, a source note, and to make a few additional adjustments using the <code>theme()</code> function. The aesthetic choice is yours.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="c20.html#cb559-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb559-2"><a href="c20.html#cb559-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> tz, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">fill =</span> <span class="st">&quot;#E8D6B1&quot;</span>, <span class="dt">size =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb559-3"><a href="c20.html#cb559-3"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> mangrove, <span class="dt">fill =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>)<span class="op">+</span></span>
<span id="cb559-4"><a href="c20.html#cb559-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> names.df, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="dv">3</span>)<span class="op">+</span></span>
<span id="cb559-5"><a href="c20.html#cb559-5"></a><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> names.df, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">label =</span> names), </span>
<span id="cb559-6"><a href="c20.html#cb559-6"></a>                            <span class="dt">point.padding =</span> <span class="fl">.25</span>, <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">nudge_x =</span> <span class="fl">0.025</span>)<span class="op">+</span></span>
<span id="cb559-7"><a href="c20.html#cb559-7"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">39.22</span>,<span class="fl">39.62</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">8.25</span>,<span class="op">-</span><span class="fl">7.74</span>), <span class="dt">crs =</span> <span class="dv">4326</span>)<span class="op">+</span></span>
<span id="cb559-8"><a href="c20.html#cb559-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">%+%</span></span>
<span id="cb559-9"><a href="c20.html#cb559-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;#98F5FF&quot;</span>),</span>
<span id="cb559-10"><a href="c20.html#cb559-10"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb559-11"><a href="c20.html#cb559-11"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.27</span>, <span class="fl">39.57</span>, <span class="dt">length.out =</span> <span class="dv">4</span>), <span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb559-12"><a href="c20.html#cb559-12"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.2</span>,<span class="op">-</span><span class="fl">7.75</span>, <span class="dt">length.out =</span> <span class="dv">6</span>)) <span class="op">+</span></span>
<span id="cb559-13"><a href="c20.html#cb559-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb559-14"><a href="c20.html#cb559-14"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">width =</span> <span class="kw">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">height =</span> <span class="kw">unit</span>(.<span class="dv">7</span>, <span class="st">&quot;cm&quot;</span>))<span class="op">+</span></span>
<span id="cb559-15"><a href="c20.html#cb559-15"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-421-1.png" width="624" /></p>
</div>
</div>
<div id="practical-f-the-bathmetry-data" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> Practical F: The bathmetry data</h2>
<p><strong>ggplot2</strong> works with data that are tidy—data frame arranged in such way that observations are in rows and variables are in columns and each value must have its own cell. But, the bathmetry data is from ETOPO1 and came in <code>.asc</code> format. First read the file with the <code>raster::raster()</code> function.</p>
<p>Load package</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="c20.html#cb560-1"></a><span class="kw">require</span>(sf)</span>
<span id="cb560-2"><a href="c20.html#cb560-2"></a><span class="kw">require</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="c20.html#cb561-1"></a><span class="co">## read the ascii file</span></span>
<span id="cb561-2"><a href="c20.html#cb561-2"></a>tz.bath =<span class="st"> </span>raster<span class="op">::</span><span class="kw">raster</span>(<span class="st">&quot;e:/GIS/ROADMAP/Etopo 1/Tanzania_etopo1/tanz1_-3432.asc&quot;</span>)</span>
<span id="cb561-3"><a href="c20.html#cb561-3"></a></span>
<span id="cb561-4"><a href="c20.html#cb561-4"></a></span>
<span id="cb561-5"><a href="c20.html#cb561-5"></a><span class="co">## convert raster to data frame</span></span>
<span id="cb561-6"><a href="c20.html#cb561-6"></a>tz.bath.df =<span class="st"> </span>tz.bath <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb561-7"><a href="c20.html#cb561-7"></a><span class="st">  </span>raster<span class="op">::</span><span class="kw">as.data.frame</span>(<span class="dt">xy =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb561-8"><a href="c20.html#cb561-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">as_tibble</span>()</span>
<span id="cb561-9"><a href="c20.html#cb561-9"></a></span>
<span id="cb561-10"><a href="c20.html#cb561-10"></a><span class="co">## rename the variable</span></span>
<span id="cb561-11"><a href="c20.html#cb561-11"></a>tz.bath.df =<span class="st"> </span>tz.bath.df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb561-12"><a href="c20.html#cb561-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">depth =</span> <span class="dv">3</span>)<span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb561-13"><a href="c20.html#cb561-13"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">depth =</span> <span class="kw">as.integer</span>(depth))</span>
<span id="cb561-14"><a href="c20.html#cb561-14"></a></span>
<span id="cb561-15"><a href="c20.html#cb561-15"></a><span class="co">## chop the area of interest </span></span>
<span id="cb561-16"><a href="c20.html#cb561-16"></a>study.area.bath=<span class="st"> </span>tz.bath.df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb561-17"><a href="c20.html#cb561-17"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(lon <span class="op">&gt;</span><span class="st"> </span><span class="fl">38.5</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="dv">41</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb561-18"><a href="c20.html#cb561-18"></a><span class="st">           </span>lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-9</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="dv">6</span> <span class="op">&amp;</span><span class="st"> </span>depth <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> )</span></code></pre></div>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="c20.html#cb562-1"></a><span class="co">## Importing shapefile</span></span>
<span id="cb562-2"><a href="c20.html#cb562-2"></a>africa =<span class="st"> </span>sf<span class="op">::</span><span class="kw">st_read</span>(<span class="st">&quot;e:/bookdown/spatil_r/data/africa.shp&quot;</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Since the layer is for the whole Africa, to reduce the processing time, we must reduce the geographical extent to the area of interest. We use the <code>st_crop()</code> function to chop the area that we want to map and discard the rest.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="c20.html#cb563-1"></a>study.area =<span class="st"> </span>africa <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb563-2"><a href="c20.html#cb563-2"></a><span class="st">  </span>sf<span class="op">::</span><span class="kw">st_crop</span>(<span class="dt">xmin =</span> <span class="fl">38.0</span>,</span>
<span id="cb563-3"><a href="c20.html#cb563-3"></a>              <span class="dt">xmax =</span> <span class="fl">40.5</span>, </span>
<span id="cb563-4"><a href="c20.html#cb563-4"></a>              <span class="dt">ymin =</span> <span class="dv">-9</span>, </span>
<span id="cb563-5"><a href="c20.html#cb563-5"></a>              <span class="dt">ymax =</span> <span class="fl">-5.5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="c20.html#cb564-1"></a>stations =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">sites =</span> <span class="kw">c</span>(<span class="st">&quot;Mbegani&quot;</span>,<span class="st">&quot;Kunduchi&quot;</span>, <span class="st">&quot;Pombwe&quot;</span>),</span>
<span id="cb564-2"><a href="c20.html#cb564-2"></a>               <span class="dt">lon =</span> <span class="kw">c</span>(<span class="fl">38.970029</span>, <span class="fl">39.223579</span>, <span class="fl">39.356356</span>),</span>
<span id="cb564-3"><a href="c20.html#cb564-3"></a>               <span class="dt">lat =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">6.471443</span>, <span class="fl">-6.668289</span>,<span class="op">-</span><span class="fl">8.271291</span>))</span></code></pre></div>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="c20.html#cb565-1"></a>main.map =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb565-2"><a href="c20.html#cb565-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> study.area, <span class="dt">col =</span> <span class="st">&quot;#ED6300&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#FBE1CB&quot;</span>,<span class="dt">size =</span> <span class="fl">.5</span>) <span class="op">+</span></span>
<span id="cb565-3"><a href="c20.html#cb565-3"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> study.area.bath, </span>
<span id="cb565-4"><a href="c20.html#cb565-4"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth<span class="op">*-</span><span class="dv">1</span>), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span></span>
<span id="cb565-5"><a href="c20.html#cb565-5"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> study.area.bath, </span>
<span id="cb565-6"><a href="c20.html#cb565-6"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth<span class="op">*-</span><span class="dv">1</span>), </span>
<span id="cb565-7"><a href="c20.html#cb565-7"></a>               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">parse =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb565-8"><a href="c20.html#cb565-8"></a>               <span class="dt">stroke =</span> <span class="fl">.35</span>, <span class="dt">col =</span> <span class="st">&quot;#ED6300&quot;</span>)<span class="op">+</span></span>
<span id="cb565-9"><a href="c20.html#cb565-9"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> study.area.bath <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(depth <span class="op">&gt;</span><span class="st"> </span><span class="dv">-30</span>),</span>
<span id="cb565-10"><a href="c20.html#cb565-10"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth<span class="op">*-</span><span class="dv">1</span>), <span class="dt">binwidth =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)<span class="op">+</span></span>
<span id="cb565-11"><a href="c20.html#cb565-11"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> study.area.bath<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(depth <span class="op">&gt;</span><span class="st"> </span><span class="dv">-30</span>),</span>
<span id="cb565-12"><a href="c20.html#cb565-12"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth<span class="op">*-</span><span class="dv">1</span>),</span>
<span id="cb565-13"><a href="c20.html#cb565-13"></a>               <span class="dt">binwidth =</span> <span class="dv">20</span>, <span class="dt">rotate =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">parse =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">3.5</span>, </span>
<span id="cb565-14"><a href="c20.html#cb565-14"></a>               <span class="dt">stroke =</span> <span class="fl">.35</span>, <span class="dt">col =</span> <span class="st">&quot;#ED6300&quot;</span>)<span class="op">+</span></span>
<span id="cb565-15"><a href="c20.html#cb565-15"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> stations, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb565-16"><a href="c20.html#cb565-16"></a><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> stations, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">label =</span> sites), <span class="dt">size =</span> <span class="dv">4</span>,</span>
<span id="cb565-17"><a href="c20.html#cb565-17"></a>                           <span class="dt">point.padding =</span> <span class="ot">TRUE</span>, <span class="dt">segment.colour =</span> <span class="ot">NA</span>,<span class="dt">nudge_x =</span> <span class="fl">-0.095</span>, <span class="dt">nudge_y =</span> <span class="fl">.0075</span>,) <span class="op">+</span></span>
<span id="cb565-18"><a href="c20.html#cb565-18"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">38.7</span>, <span class="fl">40.0</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">8.3</span>, <span class="fl">-6.3</span>))<span class="op">+</span></span>
<span id="cb565-19"><a href="c20.html#cb565-19"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+%</span></span>
<span id="cb565-20"><a href="c20.html#cb565-20"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>),</span>
<span id="cb565-21"><a href="c20.html#cb565-21"></a>        <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">linetype =</span> <span class="dv">3</span>, <span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>),</span>
<span id="cb565-22"><a href="c20.html#cb565-22"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb565-23"><a href="c20.html#cb565-23"></a>        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb565-24"><a href="c20.html#cb565-24"></a>        <span class="dt">legend.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb565-25"><a href="c20.html#cb565-25"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb565-26"><a href="c20.html#cb565-26"></a>       <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">08</span>,.<span class="dv">32</span>))<span class="op">+</span></span>
<span id="cb565-27"><a href="c20.html#cb565-27"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">38.8</span>,<span class="fl">40.5</span>, <span class="fl">0.3</span>))<span class="op">+</span></span>
<span id="cb565-28"><a href="c20.html#cb565-28"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>, <span class="fl">0.4</span>))<span class="op">+</span></span>
<span id="cb565-29"><a href="c20.html#cb565-29"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="dt">text_cex =</span> <span class="fl">.95</span>)<span class="op">+</span></span>
<span id="cb565-30"><a href="c20.html#cb565-30"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;lines&quot;</span>), </span>
<span id="cb565-31"><a href="c20.html#cb565-31"></a>                                    <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>))</span>
<span id="cb565-32"><a href="c20.html#cb565-32"></a>  </span>
<span id="cb565-33"><a href="c20.html#cb565-33"></a></span>
<span id="cb565-34"><a href="c20.html#cb565-34"></a></span>
<span id="cb565-35"><a href="c20.html#cb565-35"></a>world =<span class="st"> </span>spData<span class="op">::</span>world</span>
<span id="cb565-36"><a href="c20.html#cb565-36"></a>aoi =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lon =</span> <span class="kw">c</span>(<span class="fl">38.5</span>, <span class="dv">40</span>, <span class="dv">40</span>, <span class="fl">38.5</span>, <span class="fl">38.5</span>), </span>
<span id="cb565-37"><a href="c20.html#cb565-37"></a>                 <span class="dt">lat =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">8.5</span>, <span class="fl">-8.5</span>, <span class="dv">-6</span>, <span class="dv">-6</span>, <span class="fl">-8.5</span>))</span>
<span id="cb565-38"><a href="c20.html#cb565-38"></a></span>
<span id="cb565-39"><a href="c20.html#cb565-39"></a>inset.map =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb565-40"><a href="c20.html#cb565-40"></a><span class="st">   </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world, <span class="dt">col =</span> <span class="st">&quot;#ED6300&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#FBE1CB&quot;</span>,<span class="dt">size =</span> <span class="fl">.5</span>)<span class="op">+</span></span>
<span id="cb565-41"><a href="c20.html#cb565-41"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> spData<span class="op">::</span>world <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(name_long<span class="op">==</span><span class="st">&quot;Tanzania&quot;</span>), <span class="dt">col =</span> <span class="st">&quot;#ED6300&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#F2B88C&quot;</span>,<span class="dt">size =</span> <span class="fl">.5</span>)<span class="op">+</span></span>
<span id="cb565-42"><a href="c20.html#cb565-42"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">36</span>, <span class="dv">42</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">13</span>,<span class="op">-</span><span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb565-43"><a href="c20.html#cb565-43"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> aoi, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="fl">1.2</span>)<span class="op">+</span></span>
<span id="cb565-44"><a href="c20.html#cb565-44"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb565-45"><a href="c20.html#cb565-45"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb565-46"><a href="c20.html#cb565-46"></a>        <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb565-47"><a href="c20.html#cb565-47"></a>        <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></span>
<span id="cb565-48"><a href="c20.html#cb565-48"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="c20.html#cb566-1"></a>cowplot<span class="op">::</span><span class="kw">ggdraw</span>()<span class="op">+</span></span>
<span id="cb566-2"><a href="c20.html#cb566-2"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> main.map, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb566-3"><a href="c20.html#cb566-3"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">draw_plot</span>(<span class="dt">plot =</span> inset.map, <span class="dt">x =</span> <span class="fl">0.2</span>, <span class="dt">y =</span> <span class="fl">0.1</span>, <span class="dt">width =</span> <span class="fl">0.3</span>,<span class="dt">height =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-428-1.png" width="768" /></p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="c20.html#cb567-1"></a><span class="co"># cowplot::ggsave2(filename = &quot;e:/Data Manipulation/maps/map1.png&quot;, dpi = 1200)</span></span></code></pre></div>
<div id="zoom-in-on-a-region-of-interest" class="section level3" number="14.6.1">
<h3><span class="header-section-number">14.6.1</span> Zoom in on a region of interest</h3>
<p>By default, <strong>ggplot2</strong> will zoom out so that all of the mapping objects are in the image. Suppose, however, that we are interested in a smaller region of the map. We can use <code>ggplot2::coord_sf()</code> to specify the coordinates to display. By default, <code>geom_sf()</code> calls <code>coord_sf()</code> in the background, but by explicitly calling it ourselves, we can override the default parameters. Below, we will specify our latitude and longitude, and set expand = FALSE. By default, expand is true, which puts a small buffer around the coordinates we specify. It’s an aesthetic choice.</p>
<p>While we’re here, let’s make a brief comment on CRSs in <strong>ggplot2</strong> mapping. If you recall from Part 1 of this series, the CRS is the ellipsoid and datum used to reference points on the globe. <strong>ggplot2</strong> will take the first CRS provided (in this case, in our africa dataset) and ensure that all subsequent layers use the same CRS. It automatically converts any mismatched CRSs to the first one provided. Using <code>coord_sf()</code>, we have options to change the CRS and the datum. Changing the datum won’t affect plotting, but will affect where graticules (latitude/longitude lines) are drawn if you choose to include them. By default, <strong>ggplot2</strong> draws graticules using WGS 84 (EPSG: 4326), which happens to be the CRS of our two datasets.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="c20.html#cb568-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb568-2"><a href="c20.html#cb568-2"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> study.area, <span class="dt">col =</span> <span class="st">&quot;#ED6300&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#FBE1CB&quot;</span>,<span class="dt">size =</span> <span class="fl">.5</span>) <span class="op">+</span></span>
<span id="cb568-3"><a href="c20.html#cb568-3"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>(<span class="dt">data =</span> study.area.bath, </span>
<span id="cb568-4"><a href="c20.html#cb568-4"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth<span class="op">*-</span><span class="dv">1</span>), <span class="dt">binwidth =</span> <span class="dv">200</span>)<span class="op">+</span></span>
<span id="cb568-5"><a href="c20.html#cb568-5"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_text_contour</span>(<span class="dt">data =</span> study.area.bath, </span>
<span id="cb568-6"><a href="c20.html#cb568-6"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z=</span>depth<span class="op">*-</span><span class="dv">1</span>), </span>
<span id="cb568-7"><a href="c20.html#cb568-7"></a>               <span class="dt">binwidth =</span> <span class="dv">200</span>, <span class="dt">rotate =</span> <span class="ot">TRUE</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">parse =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="fl">3.5</span>,</span>
<span id="cb568-8"><a href="c20.html#cb568-8"></a>               <span class="dt">stroke =</span> <span class="fl">.35</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">label.placement =</span> metR<span class="op">::</span><span class="kw">label_placement_flattest</span>(<span class="dt">ref_angle =</span> <span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb568-9"><a href="c20.html#cb568-9"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> stations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(sites <span class="op">!=</span><span class="st"> &quot;Pombwe&quot;</span>), <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat), <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb568-10"><a href="c20.html#cb568-10"></a><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="dt">data =</span> stations <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(sites <span class="op">!=</span><span class="st"> &quot;Pombwe&quot;</span>), </span>
<span id="cb568-11"><a href="c20.html#cb568-11"></a>                           <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">label =</span> sites), <span class="dt">size =</span> <span class="dv">4</span>,</span>
<span id="cb568-12"><a href="c20.html#cb568-12"></a>                           <span class="dt">point.padding =</span> <span class="ot">TRUE</span>, <span class="dt">segment.colour =</span> <span class="ot">NA</span>,<span class="dt">nudge_x =</span> <span class="fl">-0.095</span>, <span class="dt">nudge_y =</span> <span class="fl">.0075</span>,) <span class="op">+</span></span>
<span id="cb568-13"><a href="c20.html#cb568-13"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">38.8</span>, <span class="fl">40.0</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">7</span>, <span class="fl">-6.3</span>), <span class="dt">expand =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb568-14"><a href="c20.html#cb568-14"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+%</span></span>
<span id="cb568-15"><a href="c20.html#cb568-15"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>),</span>
<span id="cb568-16"><a href="c20.html#cb568-16"></a>        <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">linetype =</span> <span class="dv">3</span>, <span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>),</span>
<span id="cb568-17"><a href="c20.html#cb568-17"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb568-18"><a href="c20.html#cb568-18"></a>        <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb568-19"><a href="c20.html#cb568-19"></a>        <span class="dt">legend.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb568-20"><a href="c20.html#cb568-20"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb568-21"><a href="c20.html#cb568-21"></a>       <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">08</span>,.<span class="dv">32</span>))<span class="op">+</span></span>
<span id="cb568-22"><a href="c20.html#cb568-22"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">38.8</span>,<span class="fl">40.5</span>, <span class="fl">0.3</span>))<span class="op">+</span></span>
<span id="cb568-23"><a href="c20.html#cb568-23"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>, <span class="fl">0.4</span>))<span class="op">+</span></span>
<span id="cb568-24"><a href="c20.html#cb568-24"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="dt">text_cex =</span> <span class="fl">.95</span>)<span class="op">+</span></span>
<span id="cb568-25"><a href="c20.html#cb568-25"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;lines&quot;</span>), </span>
<span id="cb568-26"><a href="c20.html#cb568-26"></a>                                    <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;lines&quot;</span>))<span class="op">+</span></span>
<span id="cb568-27"><a href="c20.html#cb568-27"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">39.15</span>, <span class="dt">y =</span> <span class="fl">-6.4</span>, <span class="dt">label =</span> <span class="st">&quot;Zanzibar</span><span class="ch">\n</span><span class="st">Channel&quot;</span>, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="st">&quot;#ED6300&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-429-1.png" width="672" /></p>
</div>
</div>
<div id="practical-g-drawing-maps-programmatically-with-r" class="section level2" number="14.7">
<h2><span class="header-section-number">14.7</span> Practical G: Drawing maps programmatically with R</h2>
<p>In this part, we will cover the fundamentals of mapping using <code>ggplot2</code> associated to <code>sf</code>, and presents the basics elements and parameters we can play with to prepare a map.</p>
<p>Maps are used in a variety of fields to express data in an appealing and interpretive way. Data can be expressed into simplified patterns, and this data interpretation is generally lost if the data is only seen through a spread sheet. Maps can add vital context by incorporating many variables into an easy to read and applicable context. Maps are also very important in the information world because they can quickly allow the public to gain better insight so that they can stay informed. It’s critical to have maps be effective, which means creating maps that can be easily understood by a given audience. For instance, maps that need to be understood by children would be very different from maps intended to be shown to geographers.</p>
<p>Knowing what elements are required to enhance your data is key into making effective maps. Basic elements of a map that should be considered are polygon, points, lines, and text. Polygons, on a map, are closed shapes such as country borders. Lines are considered to be linear shapes that are not filled with any aspect, such as highways, streams, or roads. Finally, points are used to specify specific positions, such as city or landmark locations. With that in mind, one need to think about what elements are required in the map to really make an impact, and convey the information for the intended audience. Layout and formatting are the second critical aspect to enhance data visually. The arrangement of these map elements and how they will be drawn can be adjusted to make a maximum impact.</p>
<div id="a-solution-using-r-and-its-ecosystem-of-packages" class="section level3" number="14.7.1">
<h3><span class="header-section-number">14.7.1</span> A solution using R and its ecosystem of packages</h3>
<p>Current solutions for creating maps usually involves GIS software, such as ArcGIS, QGIS, eSpatial, etc., which allow to visually prepare a map, in the same approach as one would prepare a poster or a document layout. On the other hand, R, a free and open-source software development environment (IDE) that is used for computing statistical data and graphic in a programmable language, has developed advanced spatial capabilities over the years, and can be used to draw maps programmatically.</p>
<p>R is a powerful and flexible tool. R can be used from calculating data sets to creating graphs and maps with the same data set. R is also free, which makes it easily accessible to anyone. Some other advantages of using R is that it has an interactive language, data structures, graphics availability, a developed community, and the advantage of adding more functionalities through an entire ecosystem of packages. R is a scriptable language that allows the user to write out a code in which it will execute the commands specified.</p>
<p>Using R to create maps brings these benefits to mapping. Elements of a map can be added or removed with ease. R code can be tweaked to make major enhancements with a stroke of a key. It is also easy to reproduce the same maps for different data sets. It is important to be able to script the elements of a map, so that it can be re-used and interpreted by any user. In essence, comparing typical GIS software and R for drawing maps is similar to comparing word processing software (e.g. Microsoft Office or LibreOffice) and a programmatic typesetting system such as LaTeX, in that typical GIS software implement a WYSIWIG approach (“What You See Is What You Get”), while R implements a WYSIWYM approach (“What You See Is What You Mean”).</p>
<p>The package <code>ggplot2</code> implements the grammar of graphics in R, as a way to create code that make sense to the user: The grammar of graphics is a term used to breaks up graphs into semantic components, such as geometries and layers. Practically speaking, it allows (and forces!) the user to focus on graph elements at a higher level of abstraction, and how the data must be structured to achieve the expected outcome. While <code>ggplot2</code> is becoming the de facto standard for R graphs, it does not handle spatial data specifically. The current state-of-the-art of spatial objects in R relies on <code>Spatial</code> classes defined in the package <a href="https://cran.r-project.org/package=sp"><code>sp</code></a>, but the new package <a href="https://cran.r-project.org/package=sf"><code>sf</code></a> has recently implemented the “simple feature” standard, and is steadily taking over <code>sp</code>. Recently, the package <code>ggplot2</code> has allowed the use of simple features from the package <code>sf</code> as layers in a graph<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>. The combination of <code>ggplot2</code> and <code>sf</code> therefore enables to programmatically create maps, using the grammar of graphics, just as informative or visually appealing as traditional GIS software.</p>
</div>
<div id="getting-started" class="section level3" number="14.7.2">
<h3><span class="header-section-number">14.7.2</span> Getting started</h3>
<p>Many R packages are available from <a href="https://cran.r-project.org/">CRAN</a>, the Comprehensive R Archive Network, which is the primary repository of R packages. The full list of packages necessary for this series of tutorials can be installed with:</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="c20.html#cb569-1"></a><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;cowplot&quot;</span>, <span class="st">&quot;ggrepel&quot;</span>, <span class="st">&quot;tidyverse&quot;</span>, <span class="st">&quot;patchwork&quot;</span></span>
<span id="cb569-2"><a href="c20.html#cb569-2"></a>    <span class="st">&quot;ggspatial&quot;</span>, <span class="st">&quot;libwgeom&quot;</span>, <span class="st">&quot;sf&quot;</span>, <span class="st">&quot;rnaturalearth&quot;</span>, <span class="st">&quot;rnaturalearthdata&quot;</span>)</span></code></pre></div>
<p>We start by loading the basic packages necessary for all maps, i.e. <code>ggplot2</code> and <code>sf</code>. We also suggest to use the classic dark-on-light theme for <code>ggplot2</code> (<code>theme_bw</code>), which is appropriate for maps:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="c20.html#cb570-1"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb570-2"><a href="c20.html#cb570-2"></a><span class="kw">require</span>(sf)</span>
<span id="cb570-3"><a href="c20.html#cb570-3"></a></span>
<span id="cb570-4"><a href="c20.html#cb570-4"></a><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</span></code></pre></div>
<p>The package <code>rnaturalearth</code> provides a map of countries of the entire world. Use <code>ne_countries</code> to pull country data and choose the scale (<code>rnaturalearthhires</code> is necessary for <code>scale = "large"</code>). The function can return <code>sp</code> classes (default) or directly <code>sf</code> classes, as defined in the argument <code>returnclass</code>:</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="c20.html#cb571-1"></a><span class="kw">library</span>(rnaturalearth)</span>
<span id="cb571-2"><a href="c20.html#cb571-2"></a><span class="kw">library</span>(rnaturalearthdata)</span>
<span id="cb571-3"><a href="c20.html#cb571-3"></a></span>
<span id="cb571-4"><a href="c20.html#cb571-4"></a>world &lt;-<span class="st"> </span>rnaturalearth<span class="op">::</span><span class="kw">ne_countries</span>(<span class="dt">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="dt">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb571-5"><a href="c20.html#cb571-5"></a><span class="kw">class</span>(world)</span></code></pre></div>
<pre><code>[1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
</div>
<div id="data-and-basic-plot-ggplot-and-geom_sf" class="section level3" number="14.7.3">
<h3><span class="header-section-number">14.7.3</span> Data and basic plot (<code>ggplot</code> and <code>geom_sf</code>)</h3>
<p>First, let us start with creating a base map of the world using <code>ggplot2</code>. This base map will then be extended with different map elements, as well as zoomed in to an area of interest. We can check that the world map was properly retrieved and converted into an <code>sf</code> object, and plot it with <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="c20.html#cb573-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb573-2"><a href="c20.html#cb573-2"></a><span class="st">    </span><span class="kw">geom_sf</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/world-plot-1.png" width="90%" /></p>
<p>This call nicely introduces the structure of a <code>ggplot</code> call: The first part <code>ggplot(data = world)</code> initiates the <code>ggplot</code> graph, and indicates that the main data is stored in the <code>world</code> object. The line ends up with a <code>+</code> sign, which indicates that the call is not complete yet, and each subsequent line correspond to another layer or scale. In this case, we use the <code>geom_sf</code> function, which simply adds a geometry stored in a <code>sf</code> object. By default, all geometry functions use the main data defined in <code>ggplot()</code>, but we will see later how to provide additional data.</p>
<p>Note that layers are added one at a time in a <code>ggplot</code> call, so the order of each layer is very important. All data will have to be in an <code>sf</code> format to be used by <code>ggplot2</code>; data in other formats (e.g. classes from <code>sp</code>) will be manually converted to <code>sf</code> classes if necessary.</p>
</div>
<div id="title-subtitle-and-axis-labels-ggtitle-xlab-ylab" class="section level3" number="14.7.4">
<h3><span class="header-section-number">14.7.4</span> Title, subtitle, and axis labels (<code>ggtitle</code>, <code>xlab</code>, <code>ylab</code>)</h3>
<p>A title and a subtitle can be added to the map using the function <code>ggtitle</code>, passing any valid character string (e.g. with quotation marks) as arguments. Axis names are absent by default on a map, but can be changed to something more suitable (e.g. “Longitude” and “Latitude”), depending on the map:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="c20.html#cb574-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb574-2"><a href="c20.html#cb574-2"></a><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></span>
<span id="cb574-3"><a href="c20.html#cb574-3"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Longitude&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Latitude&quot;</span>) <span class="op">+</span></span>
<span id="cb574-4"><a href="c20.html#cb574-4"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;World map&quot;</span>, <span class="dt">subtitle =</span> <span class="kw">paste0</span>(<span class="st">&quot;(&quot;</span>, <span class="kw">length</span>(<span class="kw">unique</span>(world<span class="op">$</span>NAME)), <span class="st">&quot; countries)&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/world-title-1.png" width="90%" /></p>
</div>
<div id="map-color-geom_sf" class="section level3" number="14.7.5">
<h3><span class="header-section-number">14.7.5</span> Map color (<code>geom_sf</code>)</h3>
<p>In many ways, <code>sf</code> geometries are no different than regular geometries, and can be displayed with the same level of control on their attributes. Here is an example with the polygons of the countries filled with a green color (argument <code>fill</code>), using black for the outline of the countries (argument <code>color</code>):</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="c20.html#cb575-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span><span class="st"> </span></span>
<span id="cb575-2"><a href="c20.html#cb575-2"></a><span class="st">    </span><span class="kw">geom_sf</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;lightgreen&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/world-colors-1.png" width="90%" /></p>
<p>The package <code>ggplot2</code> allows the use of more complex color schemes, such as a gradient on one variable of the data. Here is another example that shows the population of each country. In this example, we use the “viridis” colorblind-friendly palette for the color gradient (with <code>option = "plasma"</code> for the plasma variant), using the square root of the population (which is stored in the variable <code>pop_est</code> of the <code>world</code> object):</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="c20.html#cb576-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb576-2"><a href="c20.html#cb576-2"></a><span class="st">    </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> pop_est)) <span class="op">+</span></span>
<span id="cb576-3"><a href="c20.html#cb576-3"></a><span class="st">    </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="dt">trans =</span> <span class="st">&quot;sqrt&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/world-colors-pop-1.png" width="90%" /></p>
</div>
<div id="projection-and-extent-coord_sf" class="section level3" number="14.7.6">
<h3><span class="header-section-number">14.7.6</span> Projection and extent (<code>coord_sf</code>)</h3>
<p>The function <code>coord_sf</code> allows to deal with the coordinate system, which includes both projection and extent of the map. By default, the map will use the coordinate system of the first layer that defines one (i.e. scanned in the order provided), or if none, fall back on WGS84 (latitude/longitude, the reference system used in GPS). Using the argument <code>crs</code>, it is possible to override this setting, and project on the fly to any projection. This can be achieved using any valid PROJ4 string (here, the European-centric ETRS89 Lambert Azimuthal Equal-Area projection):</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="c20.html#cb577-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb577-2"><a href="c20.html#cb577-2"></a><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></span>
<span id="cb577-3"><a href="c20.html#cb577-3"></a><span class="st">    </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="st">&quot;+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs &quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/world-coord-1.png" width="672" /></p>
<p>Spatial Reference System Identifier (SRID) or an European Petroleum Survey Group (EPSG) code are available for the projection of interest, they can be used directly instead of the full PROJ4 string. The two following calls are equivalent for the ETRS89 Lambert Azimuthal Equal-Area projection, which is EPSG code 3035:</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="c20.html#cb578-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb578-2"><a href="c20.html#cb578-2"></a><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></span>
<span id="cb578-3"><a href="c20.html#cb578-3"></a><span class="st">    </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="st">&quot;+init=epsg:3035&quot;</span>)</span>
<span id="cb578-4"><a href="c20.html#cb578-4"></a></span>
<span id="cb578-5"><a href="c20.html#cb578-5"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb578-6"><a href="c20.html#cb578-6"></a><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></span>
<span id="cb578-7"><a href="c20.html#cb578-7"></a><span class="st">    </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="kw">st_crs</span>(<span class="dv">3035</span>))</span></code></pre></div>
<p>The extent of the map can also be set in <code>coord_sf</code>, in practice allowing to “zoom” in the area of interest, provided by limits on the x-axis (<code>xlim</code>), and on the y-axis (<code>ylim</code>). Note that the limits are automatically expanded by a fraction to ensure that data and axes don’t overlap; it can also be turned off to exactly match the limits provided with <code>expand = FALSE</code>:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="c20.html#cb579-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb579-2"><a href="c20.html#cb579-2"></a><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></span>
<span id="cb579-3"><a href="c20.html#cb579-3"></a><span class="st">    </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">60</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">35</span>, <span class="dv">8</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/world-zoom-1.png" width="672" /></p>
</div>
<div id="scale-bar-and-north-arrow-package-ggspatial" class="section level3" number="14.7.7">
<h3><span class="header-section-number">14.7.7</span> Scale bar and North arrow (package <code>ggspatial</code>)</h3>
<p>Several packages are available to create a scale bar on a map (e.g. <code>prettymapr</code>, <code>vcd</code>, <code>ggsn</code>, or <code>legendMap</code>). We introduce here the package <code>ggspatial</code>, which provides easy-to-use functions…</p>
<p><code>scale_bar</code> that allows to add simultaneously the north symbol and a scale bar into the <code>ggplot</code> map. Five arguments need to be set manually: <code>lon</code>, <code>lat</code>, <code>distance_lon</code>, <code>distance_lat</code>, and <code>distance_legend</code>. The location of the scale bar has to be specified in longitude/latitude in the <code>lon</code> and <code>lat</code> arguments. The shaded distance inside the scale bar is controlled by the <code>distance_lon</code> argument. while its width is determined by <code>distance_lat</code>. Additionally, it is possible to change the font size for the legend of the scale bar (argument <code>legend_size</code>, which defaults to 3). The North arrow behind the “N” north symbol can also be adjusted for its length (<code>arrow_length</code>), its distance to the scale (<code>arrow_distance</code>), or the size the N north symbol itself (<code>arrow_north_size</code>, which defaults to 6). Note that all distances (<code>distance_lon</code>, <code>distance_lat</code>, <code>distance_legend</code>, <code>arrow_length</code>, <code>arrow_distance</code>) are set to <code>"km"</code> by default in <code>distance_unit</code>; they can also be set to nautical miles with “nm”, or miles with “mi”.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="c20.html#cb580-1"></a><span class="kw">require</span>(ggspatial)</span></code></pre></div>
<pre><code>Loading required package: ggspatial</code></pre>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="c20.html#cb582-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb582-2"><a href="c20.html#cb582-2"></a><span class="st">    </span><span class="kw">geom_sf</span>() <span class="op">+</span></span>
<span id="cb582-3"><a href="c20.html#cb582-3"></a><span class="st">    </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">60</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">35</span>, <span class="dv">8</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb582-4"><a href="c20.html#cb582-4"></a><span class="st">    </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="dt">width_hint =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb582-5"><a href="c20.html#cb582-5"></a><span class="st">    </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">which_north =</span> <span class="st">&quot;true&quot;</span>, </span>
<span id="cb582-6"><a href="c20.html#cb582-6"></a>        <span class="co"># pad_x = unit(0.75, &quot;in&quot;), pad_y = unit(0.5, &quot;in&quot;),</span></span>
<span id="cb582-7"><a href="c20.html#cb582-7"></a>        <span class="dt">style =</span> ggspatial<span class="op">::</span>north_arrow_fancy_orienteering) </span></code></pre></div>
<pre><code>Scale on map varies by more than 10%, scale bar may be inaccurate</code></pre>
<p><img src="geoMarine_files/figure-html/world-scale-north-1.png" width="672" /></p>
<p>Note the warning of the inaccurate scale bar: since the map use unprojected data in longitude/latitude (WGS84) on an equidistant cylindrical projection (all meridians being parallel), length in (kilo)meters on the map directly depends mathematically on the degree of latitude. Plots of small regions or projected data will often allow for more accurate scale bars.</p>
</div>
<div id="country-names-and-other-names-geom_text-and-annotate" class="section level3" number="14.7.8">
<h3><span class="header-section-number">14.7.8</span> Country names and other names (<code>geom_text</code> and <code>annotate</code>)</h3>
<p>The <code>world</code> data set already contains country names and the coordinates of the centroid of each country (among more information). We can use this information to plot country names, using <code>world</code> as a regular <code>data.frame</code> in <code>ggplot2</code>. The function <code>geom_text</code> can be used to add a layer of text to a map using geographic coordinates. The function requires the data needed to enter the country names, which is the same data as the world map. Again, we have a very flexible control to adjust the text at will on many aspects:</p>
<ul>
<li>The size (argument <code>size</code>);</li>
<li>The alignment, which is centered by default on the coordinates provided. The text can be adjusted horizontally or vertically using the arguments <code>hjust</code> and <code>vjust</code>, which can either be a number between 0 (right/bottom) and 1 (top/left) or a character (“left”, “middle”, “right”, “bottom”, “center”, “top”). The text can also be offset horizontally or vertically with the argument <code>nudge_x</code> and <code>nudge_y</code>;</li>
<li>The font of the text, for instance its color (argument <code>color</code>) or the type of font (<code>fontface</code>);</li>
<li>The overlap of labels, using the argument <code>check_overlap</code>, which removes overlapping text. Alternatively, when there is a lot of overlapping labels, the package <code>ggrepel</code> provides a <code>geom_text_repel</code> function that moves label around so that they do not overlap.</li>
<li>For the text labels, we are defining the centroid of the counties with <code>st_centroid</code>, from the package <code>sf</code>. Then we combined the coordinates with the centroid, in the <code>geometry</code> of the spatial data frame. The package <code>sf</code> is necessary for the command <code>st_centroid</code>.</li>
</ul>
<p>Additionally, the <code>annotate</code> function can be used to add a single character string at a specific location, as demonstrated here to add the Gulf of Mexico:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="c20.html#cb584-1"></a><span class="kw">require</span>(sf)</span>
<span id="cb584-2"><a href="c20.html#cb584-2"></a></span>
<span id="cb584-3"><a href="c20.html#cb584-3"></a>country.points =<span class="st"> </span>world <span class="op">%&gt;%</span><span class="st"> </span>wior<span class="op">::</span><span class="kw">polygon_tb</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(lon,lat,<span class="dt">country =</span> sovereignt, continent)</span>
<span id="cb584-4"><a href="c20.html#cb584-4"></a></span>
<span id="cb584-5"><a href="c20.html#cb584-5"></a><span class="co"># world_points&lt;- st_centroid(world)</span></span>
<span id="cb584-6"><a href="c20.html#cb584-6"></a><span class="co"># world_points &lt;- cbind(world, st_coordinates(st_centroid(world$geometry)))</span></span>
<span id="cb584-7"><a href="c20.html#cb584-7"></a></span>
<span id="cb584-8"><a href="c20.html#cb584-8"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> world) <span class="op">+</span></span>
<span id="cb584-9"><a href="c20.html#cb584-9"></a><span class="st">  </span><span class="kw">geom_sf</span>() <span class="op">+</span></span>
<span id="cb584-10"><a href="c20.html#cb584-10"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> country.points, <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">label =</span> country), <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb584-11"><a href="c20.html#cb584-11"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">43</span>, <span class="dt">y =</span> <span class="dv">-27</span>, <span class="dt">label =</span> <span class="st">&quot;INDIAN OCEAN&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="op">+</span></span>
<span id="cb584-12"><a href="c20.html#cb584-12"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">60</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">35</span>, <span class="dv">8</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb584-13"><a href="c20.html#cb584-13"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_scale</span>(<span class="dt">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="dt">width_hint =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb584-14"><a href="c20.html#cb584-14"></a><span class="st">  </span>ggspatial<span class="op">::</span><span class="kw">annotation_north_arrow</span>(<span class="dt">location =</span> <span class="st">&quot;br&quot;</span>, <span class="dt">which_north =</span> <span class="st">&quot;true&quot;</span>, </span>
<span id="cb584-15"><a href="c20.html#cb584-15"></a>        <span class="co"># pad_x = unit(0.75, &quot;in&quot;), pad_y = unit(0.5, &quot;in&quot;),</span></span>
<span id="cb584-16"><a href="c20.html#cb584-16"></a>        <span class="dt">style =</span> ggspatial<span class="op">::</span>north_arrow_fancy_orienteering) </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/world-country-1.png" width="672" /></p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>What is a 5 minute resolution i hear you ask? Well, this geographic reference system treats the globe as if it was a sphere divided into 360 equal parts called degrees. Each degree has 60 minutes and each minute has 60 seconds. Arc-seconds of latitude (horizontal lines in the globe figure below) remain almost constant whilst arc-seconds of longitude (vertical lines in the globe figure below) decrease in a trigonometric cosine-based fashion as you move towards the Earth’s poles. This causes problems as you increase or decrease latitude the longitudial lengths alter…For example at the equator (0°, such as Quito) a degree is 111.3 km whereas at 60° (such as Saint Petersburg) a degree is 55.80 km …In contrast a projected coordinate system is defined on a flat, two-dimensional plane (through projecting a spheriod onto a 2D surface) giving it constant lengths, angles and area<a href="c20.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Note: Support of <code>sf</code> objects is available since version 3.0.0 of <code>ggplot2</code>, recently released on CRAN.<a href="c20.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="maps.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["geoMarine.pdf", "geoMarine.epub"],
"toc": {
"collapse": "section",
"toc_depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
