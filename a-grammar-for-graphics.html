<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 A grammar for graphics | Practical Spatial Data</title>
  <meta name="description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 A grammar for graphics | Practical Spatial Data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://lugoga.github.io/geomarine/" />
  <meta property="og:image" content="https://lugoga.github.io/geomarine/images/coverPage.svg" />
  <meta property="og:description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="github-repo" content="lugoga/geomarine" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 A grammar for graphics | Practical Spatial Data" />
  
  <meta name="twitter:description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="twitter:image" content="https://lugoga.github.io/geomarine/images/coverPage.svg" />

<meta name="author" content="Masumbuko Semba" />


<meta name="date" content="2021-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting-in-r-with-ggplot2.html"/>
<link rel="next" href="feature.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.16/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Practical Spatial Data: Coastal and Mrine in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-will-you-learn"><i class="fa fa-check"></i>What will you learn?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#audience"><i class="fa fa-check"></i>Audience</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-read-this-book"><i class="fa fa-check"></i>Why read this book?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-book-came-to-being"><i class="fa fa-check"></i>How this book came to being</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.1</b> What is a GIS</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#gis-software"><i class="fa fa-check"></i><b>1.2</b> GIS software</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#arcgis"><i class="fa fa-check"></i><b>1.2.1</b> ArcGIS</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#qgis"><i class="fa fa-check"></i><b>1.2.2</b> QGIS</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#r"><i class="fa fa-check"></i><b>1.2.3</b> R</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#why-r"><i class="fa fa-check"></i><b>1.2.4</b> Why R?</a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>1.2.5</b> Rstudio</a></li>
<li class="chapter" data-level="1.2.6" data-path="intro.html"><a href="intro.html#why-rstudio"><i class="fa fa-check"></i><b>1.2.6</b> Why RStudio?</a></li>
<li class="chapter" data-level="1.2.7" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.2.7</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#communication-of-results"><i class="fa fa-check"></i><b>1.3</b> Communication of results</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html"><i class="fa fa-check"></i><b>2</b> A glimpse of R, Rstudio and Packages</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#the-data-analysis-workflow"><i class="fa fa-check"></i><b>2.1</b> The Data Analysis Workflow</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#data-wrangling"><i class="fa fa-check"></i><b>2.1.1</b> Data Wrangling</a></li>
<li class="chapter" data-level="2.1.2" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#importing-data"><i class="fa fa-check"></i><b>2.1.2</b> Importing Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#tidying-data"><i class="fa fa-check"></i><b>2.1.3</b> Tidying Data</a></li>
<li class="chapter" data-level="2.1.4" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#transforming-data"><i class="fa fa-check"></i><b>2.1.4</b> Transforming Data</a></li>
<li class="chapter" data-level="2.1.5" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#visualizing-data"><i class="fa fa-check"></i><b>2.1.5</b> Visualizing Data</a></li>
<li class="chapter" data-level="2.1.6" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#models"><i class="fa fa-check"></i><b>2.1.6</b> Models</a></li>
<li class="chapter" data-level="2.1.7" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#data-collaboration-and-publishing"><i class="fa fa-check"></i><b>2.1.7</b> Data Collaboration and Publishing</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#installation"><i class="fa fa-check"></i><b>2.2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#installing-r"><i class="fa fa-check"></i><b>2.2.1</b> Installing R</a></li>
<li class="chapter" data-level="2.2.2" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="2.2.3" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#installing-packages"><i class="fa fa-check"></i><b>2.2.3</b> Installing Packages</a></li>
<li class="chapter" data-level="2.2.4" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#other-packages"><i class="fa fa-check"></i><b>2.2.4</b> Other packages</a></li>
<li class="chapter" data-level="2.2.5" data-path="a-glimpse-of-r-rstudio-and-packages.html"><a href="a-glimpse-of-r-rstudio-and-packages.html#loading-installed-packages"><i class="fa fa-check"></i><b>2.2.5</b> Loading installed packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataTypes.html"><a href="dataTypes.html"><i class="fa fa-check"></i><b>3</b> Understanding Data in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataTypes.html"><a href="dataTypes.html#data-types"><i class="fa fa-check"></i><b>3.1</b> Data Types</a></li>
<li class="chapter" data-level="3.2" data-path="dataTypes.html"><a href="dataTypes.html#vectors"><i class="fa fa-check"></i><b>3.2</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dataTypes.html"><a href="dataTypes.html#numeric-vector"><i class="fa fa-check"></i><b>3.2.1</b> Numeric Vector</a></li>
<li class="chapter" data-level="3.2.2" data-path="dataTypes.html"><a href="dataTypes.html#integer-vector"><i class="fa fa-check"></i><b>3.2.2</b> Integer vector</a></li>
<li class="chapter" data-level="3.2.3" data-path="dataTypes.html"><a href="dataTypes.html#character-vector"><i class="fa fa-check"></i><b>3.2.3</b> Character vector</a></li>
<li class="chapter" data-level="3.2.4" data-path="dataTypes.html"><a href="dataTypes.html#factor-vector"><i class="fa fa-check"></i><b>3.2.4</b> Factor vector</a></li>
<li class="chapter" data-level="3.2.5" data-path="dataTypes.html"><a href="dataTypes.html#logical-vector"><i class="fa fa-check"></i><b>3.2.5</b> Logical Vector</a></li>
<li class="chapter" data-level="3.2.6" data-path="dataTypes.html"><a href="dataTypes.html#date-and-time"><i class="fa fa-check"></i><b>3.2.6</b> Date and Time</a></li>
<li class="chapter" data-level="3.2.7" data-path="dataTypes.html"><a href="dataTypes.html#indexing-the-element"><i class="fa fa-check"></i><b>3.2.7</b> Indexing the element</a></li>
<li class="chapter" data-level="3.2.8" data-path="dataTypes.html"><a href="dataTypes.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>3.2.8</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="3.2.9" data-path="dataTypes.html"><a href="dataTypes.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>3.2.9</b> Number of elements in a vector</a></li>
<li class="chapter" data-level="3.2.10" data-path="dataTypes.html"><a href="dataTypes.html#generating-sequence-of-vectors-numbers"><i class="fa fa-check"></i><b>3.2.10</b> Generating sequence of vectors Numbers</a></li>
<li class="chapter" data-level="3.2.11" data-path="dataTypes.html"><a href="dataTypes.html#generating-vector-of-normal-distribution"><i class="fa fa-check"></i><b>3.2.11</b> Generating vector of normal distribution</a></li>
<li class="chapter" data-level="3.2.12" data-path="dataTypes.html"><a href="dataTypes.html#rounding-off-numbers"><i class="fa fa-check"></i><b>3.2.12</b> Rounding off numbers</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataTypes.html"><a href="dataTypes.html#data-frame"><i class="fa fa-check"></i><b>3.3</b> Data Frame</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-data-frames"><i class="fa fa-check"></i><b>3.3.1</b> Creating data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataTypes.html"><a href="dataTypes.html#matrix"><i class="fa fa-check"></i><b>3.4</b> Matrix</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-matrices"><i class="fa fa-check"></i><b>3.4.1</b> Creating Matrices</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataTypes.html"><a href="dataTypes.html#adding-attributes-to-matrices"><i class="fa fa-check"></i><b>3.4.2</b> Adding attributes to Matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataTypes.html"><a href="dataTypes.html#arrays"><i class="fa fa-check"></i><b>3.5</b> Arrays</a></li>
<li class="chapter" data-level="3.6" data-path="dataTypes.html"><a href="dataTypes.html#dealing-with-misiing-values"><i class="fa fa-check"></i><b>3.6</b> Dealing with Misiing Values</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>4</b> Importing data with <strong>readr</strong></a>
<ul>
<li class="chapter" data-level="4.1" data-path="readr.html"><a href="readr.html#getting-data-into-r"><i class="fa fa-check"></i><b>4.1</b> Getting Data into R</a></li>
<li class="chapter" data-level="4.2" data-path="readr.html"><a href="readr.html#comma-separated-.csv"><i class="fa fa-check"></i><b>4.2</b> Comma-Separated (.csv)</a></li>
<li class="chapter" data-level="4.3" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>4.3</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="4.4" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>4.4</b> Writing t a File</a></li>
<li class="chapter" data-level="4.5" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>4.5</b> Basic Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>4.5.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="4.5.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>4.5.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>5</b> Reshaping data with <strong>tidyr</strong></a>
<ul>
<li class="chapter" data-level="5.1" data-path="tidy.html"><a href="tidy.html#what-is-tidy-data"><i class="fa fa-check"></i><b>5.1</b> What is Tidy Data?</a></li>
<li class="chapter" data-level="5.2" data-path="tidy.html"><a href="tidy.html#gatherfrom-wide-to-long-format."><i class="fa fa-check"></i><b>5.2</b> Gather—from wide to long format.</a></li>
<li class="chapter" data-level="5.3" data-path="tidy.html"><a href="tidy.html#spreadfrom-long-to-wide-format"><i class="fa fa-check"></i><b>5.3</b> spread—from long to wide format</a></li>
<li class="chapter" data-level="5.4" data-path="tidy.html"><a href="tidy.html#separate-columns"><i class="fa fa-check"></i><b>5.4</b> separate columns</a></li>
<li class="chapter" data-level="5.5" data-path="tidy.html"><a href="tidy.html#unite-columns"><i class="fa fa-check"></i><b>5.5</b> unite columns</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Manipulating Data with <strong>dplyr</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#why-use-dplyr"><i class="fa fa-check"></i><b>6.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#core-dplyr-functions"><i class="fa fa-check"></i><b>6.2</b> Core dplyr Functions</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#data"><i class="fa fa-check"></i><b>6.3</b> Data</a></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filtering-observations"><i class="fa fa-check"></i><b>6.4</b> Choosing rows: Filtering observations</a></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>6.5</b> select</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>6.5.1</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="6.5.2" data-path="dplyr.html"><a href="dplyr.html#arranging-rows"><i class="fa fa-check"></i><b>6.5.2</b> Arranging rows</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#summarizing-and-grouping"><i class="fa fa-check"></i><b>6.6</b> Summarizing and Grouping</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Plotting in R with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#a-dataset"><i class="fa fa-check"></i><b>7.1</b> A dataset</a></li>
<li class="chapter" data-level="7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#components-of-ggplot-objects-components"><i class="fa fa-check"></i><b>7.2</b> Components of ggplot objects {components}</a></li>
<li class="chapter" data-level="7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#building-a-plot"><i class="fa fa-check"></i><b>7.3</b> Building a plot</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#plotting-layers"><i class="fa fa-check"></i><b>7.3.1</b> Plotting layers</a></li>
<li class="chapter" data-level="7.3.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-legend"><i class="fa fa-check"></i><b>7.3.2</b> Customize legend</a></li>
<li class="chapter" data-level="7.3.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#working-with-titles-and-labels"><i class="fa fa-check"></i><b>7.3.3</b> Working with titles and labels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-glidline-and-axis-labels"><i class="fa fa-check"></i><b>7.4</b> Customize glidline and axis labels</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#remove-the-gray-box-of-points-on-legend"><i class="fa fa-check"></i><b>7.4.1</b> Remove the gray box of points on legend</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-the-position-of-the-legend"><i class="fa fa-check"></i><b>7.5</b> Modify the position of the legend</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-legend-background-and-stroke-color"><i class="fa fa-check"></i><b>7.5.1</b> Change the legend background and stroke color</a></li>
<li class="chapter" data-level="7.5.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-background-colors"><i class="fa fa-check"></i><b>7.5.2</b> Modify background colors</a></li>
<li class="chapter" data-level="7.5.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-gridlines"><i class="fa fa-check"></i><b>7.5.3</b> change the gridlines</a></li>
<li class="chapter" data-level="7.5.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-font-size-for-axis-labels-and-titles"><i class="fa fa-check"></i><b>7.5.4</b> Change the font size for axis, labels and titles</a></li>
<li class="chapter" data-level="7.5.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#limit-axis-to-a-range"><i class="fa fa-check"></i><b>7.5.5</b> Limit axis to a range</a></li>
<li class="chapter" data-level="7.5.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-labels"><i class="fa fa-check"></i><b>7.5.6</b> Adding labels</a></li>
<li class="chapter" data-level="7.5.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-text-annotation"><i class="fa fa-check"></i><b>7.5.7</b> Add text annotation</a></li>
<li class="chapter" data-level="7.5.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#make-the-x-and-y-axis-the-same"><i class="fa fa-check"></i><b>7.5.8</b> Make the x and y axis the same</a></li>
<li class="chapter" data-level="7.5.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#faceting-creating-multipanel-plots"><i class="fa fa-check"></i><b>7.5.9</b> Faceting —Creating multi–panel plots</a></li>
<li class="chapter" data-level="7.5.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#allow-scales-to-roam-free-scales"><i class="fa fa-check"></i><b>7.5.10</b> Allow scales to roam free (scales)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#basic-plots"><i class="fa fa-check"></i><b>7.6</b> Basic plots</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scatterplot"><i class="fa fa-check"></i><b>7.6.1</b> scatterplot</a></li>
<li class="chapter" data-level="7.6.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-regression-line"><i class="fa fa-check"></i><b>7.6.2</b> adding regression line</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#linegraph"><i class="fa fa-check"></i><b>7.7</b> Linegraph</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#histogram"><i class="fa fa-check"></i><b>7.7.1</b> histogram</a></li>
<li class="chapter" data-level="7.7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#boxplot"><i class="fa fa-check"></i><b>7.7.2</b> boxplot</a></li>
<li class="chapter" data-level="7.7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot"><i class="fa fa-check"></i><b>7.7.3</b> barplot</a></li>
<li class="chapter" data-level="7.7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot-for-values"><i class="fa fa-check"></i><b>7.7.4</b> barplot for values</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#advanced-plots"><i class="fa fa-check"></i><b>7.8</b> Advanced plots</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>7.8.1</b> Facets</a></li>
<li class="chapter" data-level="7.8.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#sea-surface-temperature"><i class="fa fa-check"></i><b>7.8.2</b> Sea Surface Temperature</a></li>
<li class="chapter" data-level="7.8.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#subplot"><i class="fa fa-check"></i><b>7.8.3</b> Subplot</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#colour"><i class="fa fa-check"></i><b>7.9</b> Colour</a></li>
<li class="chapter" data-level="7.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#size"><i class="fa fa-check"></i><b>7.10</b> size</a></li>
<li class="chapter" data-level="7.11" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scaling"><i class="fa fa-check"></i><b>7.11</b> scaling</a></li>
<li class="chapter" data-level="7.12" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#guides"><i class="fa fa-check"></i><b>7.12</b> Guides</a></li>
<li class="chapter" data-level="7.13" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>7.13</b> Add-on packages</a></li>
<li class="chapter" data-level="7.14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#ggridges"><i class="fa fa-check"></i><b>7.14</b> ggridges</a></li>
<li class="chapter" data-level="7.15" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#varying-fill-colors-along-the-x-axis"><i class="fa fa-check"></i><b>7.15</b> Varying fill colors along the x axis</a></li>
<li class="chapter" data-level="7.16" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#metr"><i class="fa fa-check"></i><b>7.16</b> metR</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html"><i class="fa fa-check"></i><b>8</b> A grammar for graphics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#geoms"><i class="fa fa-check"></i><b>8.1</b> geoms</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#regression-line"><i class="fa fa-check"></i><b>8.1.1</b> Regression Line</a></li>
<li class="chapter" data-level="8.1.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#horizontal-vertical-lines"><i class="fa fa-check"></i><b>8.1.2</b> Horizontal/ vertical lines</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#aes"><i class="fa fa-check"></i><b>8.2</b> aes()</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#color"><i class="fa fa-check"></i><b>8.2.1</b> Color</a></li>
<li class="chapter" data-level="8.2.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#shape"><i class="fa fa-check"></i><b>8.2.2</b> shape</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#axis-and-labels"><i class="fa fa-check"></i><b>8.3</b> Axis and labels</a></li>
<li class="chapter" data-level="8.4" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#text-annotaion"><i class="fa fa-check"></i><b>8.4</b> Text annotaion</a></li>
<li class="chapter" data-level="8.5" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#scales"><i class="fa fa-check"></i><b>8.5</b> Scales</a></li>
<li class="chapter" data-level="8.6" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#guides-1"><i class="fa fa-check"></i><b>8.6</b> Guides</a></li>
<li class="chapter" data-level="8.7" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#themes"><i class="fa fa-check"></i><b>8.7</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="feature.html"><a href="feature.html"><i class="fa fa-check"></i><b>9</b> Feature Representation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="feature.html"><a href="feature.html#vector"><i class="fa fa-check"></i><b>9.1</b> Vector</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="feature.html"><a href="feature.html#a-point"><i class="fa fa-check"></i><b>9.1.1</b> A point</a></li>
<li class="chapter" data-level="9.1.2" data-path="feature.html"><a href="feature.html#polyline"><i class="fa fa-check"></i><b>9.1.2</b> Polyline</a></li>
<li class="chapter" data-level="9.1.3" data-path="feature.html"><a href="feature.html#polygon"><i class="fa fa-check"></i><b>9.1.3</b> Polygon</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="feature.html"><a href="feature.html#raster"><i class="fa fa-check"></i><b>9.2</b> Raster</a></li>
<li class="chapter" data-level="9.3" data-path="feature.html"><a href="feature.html#important-gis-data-formats"><i class="fa fa-check"></i><b>9.3</b> Important GIS data formats</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="feature.html"><a href="feature.html#shapefiles"><i class="fa fa-check"></i><b>9.3.1</b> Shapefiles</a></li>
<li class="chapter" data-level="9.3.2" data-path="feature.html"><a href="feature.html#raster-1"><i class="fa fa-check"></i><b>9.3.2</b> Raster</a></li>
<li class="chapter" data-level="9.3.3" data-path="feature.html"><a href="feature.html#attribute-tables"><i class="fa fa-check"></i><b>9.3.3</b> Attribute Tables</a></li>
<li class="chapter" data-level="9.3.4" data-path="feature.html"><a href="feature.html#geodatabase"><i class="fa fa-check"></i><b>9.3.4</b> Geodatabase</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="feature.html"><a href="feature.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>9.4</b> Coordinate reference systems</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="feature.html"><a href="feature.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.4.1</b> Geographic coordinate systems</a></li>
<li class="chapter" data-level="9.4.2" data-path="feature.html"><a href="feature.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.4.2</b> Projected coordinate systems</a></li>
<li class="chapter" data-level="9.4.3" data-path="feature.html"><a href="feature.html#setting-coordinate-reference-systems-in-r"><i class="fa fa-check"></i><b>9.4.3</b> Setting Coordinate Reference Systems in R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="feature.html"><a href="feature.html#practicals"><i class="fa fa-check"></i><b>9.5</b> Practicals</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="feature.html"><a href="feature.html#plotting-point-data"><i class="fa fa-check"></i><b>9.5.1</b> Plotting Point Data</a></li>
<li class="chapter" data-level="9.5.2" data-path="feature.html"><a href="feature.html#geographic-coordinate-sytem"><i class="fa fa-check"></i><b>9.5.2</b> Geographic Coordinate Sytem</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="feature.html"><a href="feature.html#summary"><i class="fa fa-check"></i><b>9.6</b> Summary</a></li>
<li class="chapter" data-level="9.7" data-path="feature.html"><a href="feature.html#questions"><i class="fa fa-check"></i><b>9.7</b> Questions</a></li>
<li class="chapter" data-level="9.8" data-path="feature.html"><a href="feature.html#further-readings"><i class="fa fa-check"></i><b>9.8</b> FUrther readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html"><i class="fa fa-check"></i><b>10</b> Creating Geospatial Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#getting-data-from-the-web"><i class="fa fa-check"></i><b>10.1</b> Getting data from the web</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#usage"><i class="fa fa-check"></i><b>10.1.1</b> Usage</a></li>
<li class="chapter" data-level="10.1.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#to-download-natural-earth-data-not-already-in-the-package"><i class="fa fa-check"></i><b>10.1.2</b> To download Natural Earth data not already in the package</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-point-data"><i class="fa fa-check"></i><b>10.2</b> Creating Point Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-point-features"><i class="fa fa-check"></i><b>10.2.1</b> Creating point features</a></li>
<li class="chapter" data-level="10.2.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-line-features"><i class="fa fa-check"></i><b>10.2.2</b> Creating line features</a></li>
<li class="chapter" data-level="10.2.3" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-polygon-features"><i class="fa fa-check"></i><b>10.2.3</b> Creating Polygon features</a></li>
<li class="chapter" data-level="10.2.4" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#adding-features-to-vector-data"><i class="fa fa-check"></i><b>10.2.4</b> Adding features to vector data</a></li>
<li class="chapter" data-level="10.2.5" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#digitizing-a-map"><i class="fa fa-check"></i><b>10.2.5</b> Digitizing a map</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#summary-1"><i class="fa fa-check"></i><b>10.3</b> Summary</a></li>
<li class="chapter" data-level="10.4" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#questions-1"><i class="fa fa-check"></i><b>10.4</b> Questions</a></li>
<li class="chapter" data-level="10.5" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#further-reading"><i class="fa fa-check"></i><b>10.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html"><i class="fa fa-check"></i><b>11</b> Working with vector data in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#combining-shapefile-in-r"><i class="fa fa-check"></i><b>11.1</b> Combining shapefile in R</a></li>
<li class="chapter" data-level="11.2" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#clipping-in-r"><i class="fa fa-check"></i><b>11.2</b> Clipping in R</a></li>
<li class="chapter" data-level="11.3" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#differences-in-r"><i class="fa fa-check"></i><b>11.3</b> DIfferences in R</a></li>
<li class="chapter" data-level="11.4" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#area-calculation-in-r"><i class="fa fa-check"></i><b>11.4</b> Area calculation in R</a></li>
<li class="chapter" data-level="11.5" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#buffer"><i class="fa fa-check"></i><b>11.5</b> Buffer</a></li>
<li class="chapter" data-level="11.6" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#intersection"><i class="fa fa-check"></i><b>11.6</b> Intersection</a></li>
<li class="chapter" data-level="11.7" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#statistical-summary-of-vector-layers"><i class="fa fa-check"></i><b>11.7</b> Statistical summary of vector layers</a></li>
<li class="chapter" data-level="11.8" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#summary-2"><i class="fa fa-check"></i><b>11.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html"><i class="fa fa-check"></i><b>12</b> Working with raster data in R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#nc-data"><i class="fa fa-check"></i><b>12.1</b> NC data</a></li>
<li class="chapter" data-level="12.2" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#changing-the-projection-system-of-a-raster-file"><i class="fa fa-check"></i><b>12.2</b> Changing the projection system of a raster file</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#reading-tiff-format"><i class="fa fa-check"></i><b>12.2.1</b> Reading Tiff format</a></li>
<li class="chapter" data-level="12.2.2" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#reclassifying-rasters"><i class="fa fa-check"></i><b>12.2.2</b> Reclassifying rasters</a></li>
<li class="chapter" data-level="12.2.3" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#mapping-raster"><i class="fa fa-check"></i><b>12.2.3</b> Mapping raster</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#summary-3"><i class="fa fa-check"></i><b>12.3</b> Summary</a></li>
<li class="chapter" data-level="12.4" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#questions-2"><i class="fa fa-check"></i><b>12.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>13</b> Maps</a>
<ul>
<li class="chapter" data-level="13.1" data-path="maps.html"><a href="maps.html#geographical-data-in-a-tidy-format"><i class="fa fa-check"></i><b>13.1</b> Geographical data in a tidy format</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="maps.html"><a href="maps.html#create-simple-feature-from-data.frame"><i class="fa fa-check"></i><b>13.1.1</b> Create simple feature from data.frame</a></li>
<li class="chapter" data-level="13.1.2" data-path="maps.html"><a href="maps.html#importing-shapefile"><i class="fa fa-check"></i><b>13.1.2</b> Importing shapefile</a></li>
<li class="chapter" data-level="13.1.3" data-path="maps.html"><a href="maps.html#reading-other-format"><i class="fa fa-check"></i><b>13.1.3</b> Reading other format</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="maps.html"><a href="maps.html#introduction"><i class="fa fa-check"></i><b>13.2</b> Introduction</a></li>
<li class="chapter" data-level="13.3" data-path="maps.html"><a href="maps.html#static-maps"><i class="fa fa-check"></i><b>13.3</b> Static Maps</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="maps.html"><a href="maps.html#the-bathmetry-data"><i class="fa fa-check"></i><b>13.3.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="maps.html"><a href="maps.html#basemap"><i class="fa fa-check"></i><b>13.4</b> Basemap</a></li>
<li class="chapter" data-level="13.5" data-path="maps.html"><a href="maps.html#creating-contour-map"><i class="fa fa-check"></i><b>13.5</b> Creating contour map</a></li>
<li class="chapter" data-level="13.6" data-path="maps.html"><a href="maps.html#inset-maps"><i class="fa fa-check"></i><b>13.6</b> Inset maps</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="maps.html"><a href="maps.html#choropleth-maps"><i class="fa fa-check"></i><b>13.6.1</b> Choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="maps.html"><a href="maps.html#animated-maps"><i class="fa fa-check"></i><b>13.7</b> Animated maps</a></li>
<li class="chapter" data-level="13.8" data-path="maps.html"><a href="maps.html#interactive-maps"><i class="fa fa-check"></i><b>13.8</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="c20.html"><a href="c20.html"><i class="fa fa-check"></i><b>14</b> Appendices</a>
<ul>
<li class="chapter" data-level="14.1" data-path="c20.html"><a href="c20.html#practical-a-getting-started"><i class="fa fa-check"></i><b>14.1</b> Practical A: Getting started</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="c20.html"><a href="c20.html#install-necessary-packages"><i class="fa fa-check"></i><b>14.1.1</b> Install necessary packages</a></li>
<li class="chapter" data-level="14.1.2" data-path="c20.html"><a href="c20.html#create-an-rstudio-project"><i class="fa fa-check"></i><b>14.1.2</b> Create An Rstudio Project</a></li>
<li class="chapter" data-level="14.1.3" data-path="c20.html"><a href="c20.html#create-an-r-markdown-file"><i class="fa fa-check"></i><b>14.1.3</b> Create an R Markdown file</a></li>
<li class="chapter" data-level="14.1.4" data-path="c20.html"><a href="c20.html#create-new-folders"><i class="fa fa-check"></i><b>14.1.4</b> Create New folders</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="c20.html"><a href="c20.html#practical-b-working-with-climate-data"><i class="fa fa-check"></i><b>14.2</b> Practical B: Working with climate data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="c20.html"><a href="c20.html#part-1-rasters"><i class="fa fa-check"></i><b>14.2.1</b> Part 1: rasters</a></li>
<li class="chapter" data-level="14.2.2" data-path="c20.html"><a href="c20.html#part-2-descriptive-statistics"><i class="fa fa-check"></i><b>14.2.2</b> Part 2 descriptive statistics</a></li>
<li class="chapter" data-level="14.2.3" data-path="c20.html"><a href="c20.html#using-more-data"><i class="fa fa-check"></i><b>14.2.3</b> Using more data</a></li>
<li class="chapter" data-level="14.2.4" data-path="c20.html"><a href="c20.html#wind"><i class="fa fa-check"></i><b>14.2.4</b> Wind</a></li>
<li class="chapter" data-level="14.2.5" data-path="c20.html"><a href="c20.html#precipitation"><i class="fa fa-check"></i><b>14.2.5</b> Precipitation</a></li>
<li class="chapter" data-level="14.2.6" data-path="c20.html"><a href="c20.html#advanced-analysis"><i class="fa fa-check"></i><b>14.2.6</b> Advanced analysis</a></li>
<li class="chapter" data-level="14.2.7" data-path="c20.html"><a href="c20.html#stars-package"><i class="fa fa-check"></i><b>14.2.7</b> stars package</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="c20.html"><a href="c20.html#practical-c-handling-projections-and-coordinate-systems"><i class="fa fa-check"></i><b>14.3</b> Practical C: Handling Projections and Coordinate Systems</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="c20.html"><a href="c20.html#assigning-coordinate-reference-system"><i class="fa fa-check"></i><b>14.3.1</b> Assigning Coordinate reference system</a></li>
<li class="chapter" data-level="14.3.2" data-path="c20.html"><a href="c20.html#transforming-coordinate-system"><i class="fa fa-check"></i><b>14.3.2</b> Transforming coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="c20.html"><a href="c20.html#practical-d-finding-loading-and-cleaning-spatial-data"><i class="fa fa-check"></i><b>14.4</b> Practical D: Finding, loading, and cleaning Spatial data</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="c20.html"><a href="c20.html#thinking-about-map-data-the-way-r-does"><i class="fa fa-check"></i><b>14.4.1</b> Thinking about map data the way R does</a></li>
<li class="chapter" data-level="14.4.2" data-path="c20.html"><a href="c20.html#a-brief-introduction-to-simple-features-data-in-r"><i class="fa fa-check"></i><b>14.4.2</b> A brief introduction to simple features data in R</a></li>
<li class="chapter" data-level="14.4.3" data-path="c20.html"><a href="c20.html#finding-data"><i class="fa fa-check"></i><b>14.4.3</b> Finding data</a></li>
<li class="chapter" data-level="14.4.4" data-path="c20.html"><a href="c20.html#finding-non-geospatial-data"><i class="fa fa-check"></i><b>14.4.4</b> Finding non-geospatial data</a></li>
<li class="chapter" data-level="14.4.5" data-path="c20.html"><a href="c20.html#combining-spatial-data-with-non-spatial-data"><i class="fa fa-check"></i><b>14.4.5</b> Combining spatial data with non-spatial data</a></li>
<li class="chapter" data-level="14.4.6" data-path="c20.html"><a href="c20.html#conclusion"><i class="fa fa-check"></i><b>14.4.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="c20.html"><a href="c20.html#practical-e-making-maps-with-ggplot2"><i class="fa fa-check"></i><b>14.5</b> Practical E: Making maps with ggplot2</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="c20.html"><a href="c20.html#import-and-clean-the-datasets"><i class="fa fa-check"></i><b>14.5.1</b> Import and clean the datasets</a></li>
<li class="chapter" data-level="14.5.2" data-path="c20.html"><a href="c20.html#add-highlights-and-annotations"><i class="fa fa-check"></i><b>14.5.2</b> Add highlights and annotations</a></li>
<li class="chapter" data-level="14.5.3" data-path="c20.html"><a href="c20.html#inset-map"><i class="fa fa-check"></i><b>14.5.3</b> inset map</a></li>
<li class="chapter" data-level="14.5.4" data-path="c20.html"><a href="c20.html#final-beautification"><i class="fa fa-check"></i><b>14.5.4</b> Final beautification</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="c20.html"><a href="c20.html#practical-f-the-bathmetry-data"><i class="fa fa-check"></i><b>14.6</b> Practical F: The bathmetry data</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="c20.html"><a href="c20.html#zoom-in-on-a-region-of-interest"><i class="fa fa-check"></i><b>14.6.1</b> Zoom in on a region of interest</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="c20.html"><a href="c20.html#practical-g-drawing-maps-programmatically-with-r"><i class="fa fa-check"></i><b>14.7</b> Practical G: Drawing maps programmatically with R</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="c20.html"><a href="c20.html#a-solution-using-r-and-its-ecosystem-of-packages"><i class="fa fa-check"></i><b>14.7.1</b> A solution using R and its ecosystem of packages</a></li>
<li class="chapter" data-level="14.7.2" data-path="c20.html"><a href="c20.html#getting-started"><i class="fa fa-check"></i><b>14.7.2</b> Getting started</a></li>
<li class="chapter" data-level="14.7.3" data-path="c20.html"><a href="c20.html#data-and-basic-plot-ggplot-and-geom_sf"><i class="fa fa-check"></i><b>14.7.3</b> Data and basic plot (<code>ggplot</code> and <code>geom_sf</code>)</a></li>
<li class="chapter" data-level="14.7.4" data-path="c20.html"><a href="c20.html#title-subtitle-and-axis-labels-ggtitle-xlab-ylab"><i class="fa fa-check"></i><b>14.7.4</b> Title, subtitle, and axis labels (<code>ggtitle</code>, <code>xlab</code>, <code>ylab</code>)</a></li>
<li class="chapter" data-level="14.7.5" data-path="c20.html"><a href="c20.html#map-color-geom_sf"><i class="fa fa-check"></i><b>14.7.5</b> Map color (<code>geom_sf</code>)</a></li>
<li class="chapter" data-level="14.7.6" data-path="c20.html"><a href="c20.html#projection-and-extent-coord_sf"><i class="fa fa-check"></i><b>14.7.6</b> Projection and extent (<code>coord_sf</code>)</a></li>
<li class="chapter" data-level="14.7.7" data-path="c20.html"><a href="c20.html#scale-bar-and-north-arrow-package-ggspatial"><i class="fa fa-check"></i><b>14.7.7</b> Scale bar and North arrow (package <code>ggspatial</code>)</a></li>
<li class="chapter" data-level="14.7.8" data-path="c20.html"><a href="c20.html#country-names-and-other-names-geom_text-and-annotate"><i class="fa fa-check"></i><b>14.7.8</b> Country names and other names (<code>geom_text</code> and <code>annotate</code>)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://lugoga.github.io/geomarine/" aria-label='Author Website Link'>
      <img src="images/geoR.svg" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a https://github.com/lugoga/geomarine/" aria-label='GitHub Link'>
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" aria-label="Creative commons CCBYSA link">
         <i class="fab fa-creative-commons fa-lg"></i> 
         <i class="fab fa-creative-commons-by fa-lg"></i> 
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>      

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practical Spatial Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-grammar-for-graphics" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> A grammar for graphics</h1>
<div id="geoms" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> geoms</h2>
<p>In this section, we will create some of the most routinely used plots to explore data using the <code>geom_</code> functions.</p>
<p>We will use the following libraries in this post:</p>
<ul>
<li><strong>readr</strong></li>
<li><strong>ggplot2</strong></li>
<li><strong>tibble</strong></li>
<li><strong>dplyr</strong></li>
</ul>
<p>Which are part of the tidyverse. By loading the tidyverse, we also load all the packages mentioned above</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="a-grammar-for-graphics.html#cb315-1"></a><span class="kw">require</span>(tidyverse)</span></code></pre></div>
<p>All the data sets used in this post can be found here and code can be downloaded from <a href="www.">here</a>.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="a-grammar-for-graphics.html#cb316-1"></a>octopus =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;./data/octopus_data.csv&quot;</span>)</span></code></pre></div>
<p>The variables representing the <code>X</code> and <code>Y</code> axis can be specified either in <code>ggplot()</code> or in <code>geom_point()</code>. We will learn to modify the appearance of the points in a different post.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="a-grammar-for-graphics.html#cb317-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb317-2"><a href="a-grammar-for-graphics.html#cb317-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb317-3"><a href="a-grammar-for-graphics.html#cb317-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
<div id="regression-line" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Regression Line</h3>
<p>You can fit the regression on the scatterplot with <code>geom_smooth()</code></p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="a-grammar-for-graphics.html#cb318-1"></a>lm =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb318-2"><a href="a-grammar-for-graphics.html#cb318-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb318-3"><a href="a-grammar-for-graphics.html#cb318-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb318-4"><a href="a-grammar-for-graphics.html#cb318-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb318-5"><a href="a-grammar-for-graphics.html#cb318-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;linear model&quot;</span>)</span>
<span id="cb318-6"><a href="a-grammar-for-graphics.html#cb318-6"></a></span>
<span id="cb318-7"><a href="a-grammar-for-graphics.html#cb318-7"></a>gam =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb318-8"><a href="a-grammar-for-graphics.html#cb318-8"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb318-9"><a href="a-grammar-for-graphics.html#cb318-9"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb318-10"><a href="a-grammar-for-graphics.html#cb318-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb318-11"><a href="a-grammar-for-graphics.html#cb318-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;GAM&quot;</span>)</span>
<span id="cb318-12"><a href="a-grammar-for-graphics.html#cb318-12"></a></span>
<span id="cb318-13"><a href="a-grammar-for-graphics.html#cb318-13"></a>loess =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb318-14"><a href="a-grammar-for-graphics.html#cb318-14"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb318-15"><a href="a-grammar-for-graphics.html#cb318-15"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb318-16"><a href="a-grammar-for-graphics.html#cb318-16"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb318-17"><a href="a-grammar-for-graphics.html#cb318-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">title =</span> <span class="st">&quot;LOESS&quot;</span>)</span>
<span id="cb318-18"><a href="a-grammar-for-graphics.html#cb318-18"></a></span>
<span id="cb318-19"><a href="a-grammar-for-graphics.html#cb318-19"></a>egg<span class="op">::</span><span class="kw">ggarrange</span>(lm,gam, loess, <span class="dt">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-219-1.png" width="672" /></p>
</div>
<div id="horizontal-vertical-lines" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Horizontal/ vertical lines</h3>
<p>A segment of horizontal or vertical line can be added on the plot using egg::ggarrange</p>
<div id="vertical-line" class="section level4" number="8.1.2.1">
<h4><span class="header-section-number">8.1.2.1</span> Vertical Line</h4>
<p>For the vertical line, the <code>x</code> axis intercept must be specified in <code>geom_vline()</code></p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="a-grammar-for-graphics.html#cb319-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb319-2"><a href="a-grammar-for-graphics.html#cb319-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb319-3"><a href="a-grammar-for-graphics.html#cb319-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb319-4"><a href="a-grammar-for-graphics.html#cb319-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb319-5"><a href="a-grammar-for-graphics.html#cb319-5"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">100</span>, <span class="dt">linetype =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
</div>
<div id="vertical-line-1" class="section level4" number="8.1.2.2">
<h4><span class="header-section-number">8.1.2.2</span> Vertical Line</h4>
<p>In similar manner, for the horizontal line, the <code>y</code> axis intercept must be specified in <code>geom_hline()</code></p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="a-grammar-for-graphics.html#cb320-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb320-2"><a href="a-grammar-for-graphics.html#cb320-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb320-3"><a href="a-grammar-for-graphics.html#cb320-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb320-4"><a href="a-grammar-for-graphics.html#cb320-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb320-5"><a href="a-grammar-for-graphics.html#cb320-5"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">2</span>, <span class="dt">linetype =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="aes" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> aes()</h2>
<p>In this section, we focus on the <code>aesthetics</code> i.e. color, shape, size, alpha, line type, line width etc. We can map these to variables or specify values for them. If we want to map the above to variables, we have to specify them within the <code>aes()</code> function. We will look at both methods in the following sections.</p>
<p>Explore aesthetics such as</p>
<ul>
<li>color</li>
<li>shape</li>
<li>size</li>
<li>fill</li>
<li>alpha</li>
<li>width</li>
</ul>
<div id="color" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Color</h3>
<p>In <strong>ggplot2</strong>, when we mention color or colour, it usually refers to the color of the geoms. The <code>fill</code> argument is used to specify the color of the shapes in certain cases. In this section, we will see how we can specify the color for the different geoms we learnt in the previous post.</p>
<p>For points, the color argument specifies the color of the point for certain shapes and border for others. The fill argument is used to specify the background for some shapes and will not work with other shapes. Let us look at an example:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="a-grammar-for-graphics.html#cb321-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb321-2"><a href="a-grammar-for-graphics.html#cb321-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight, <span class="dt">col =</span> sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb321-3"><a href="a-grammar-for-graphics.html#cb321-3"></a><span class="st">  </span><span class="kw">geom_point</span>() </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
<p>If you do not want to map a variable to color, you can specify it separately using the color argument but in this case it should be outside the aes() function.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="a-grammar-for-graphics.html#cb322-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb322-2"><a href="a-grammar-for-graphics.html#cb322-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight, <span class="dt">col =</span> sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb322-3"><a href="a-grammar-for-graphics.html#cb322-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-223-1.png" width="672" /></p>
</div>
<div id="shape" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> shape</h3>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="a-grammar-for-graphics.html#cb323-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb323-2"><a href="a-grammar-for-graphics.html#cb323-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight, <span class="dt">shape =</span> sex)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb323-3"><a href="a-grammar-for-graphics.html#cb323-3"></a><span class="st">  </span><span class="kw">geom_point</span>() </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
<p>Let us map size of points to a variable. It is advised to map size only to continuous variables and not categorical variables.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="a-grammar-for-graphics.html#cb324-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb324-2"><a href="a-grammar-for-graphics.html#cb324-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight, <span class="dt">col =</span> sex, <span class="dt">size =</span> dml)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb324-3"><a href="a-grammar-for-graphics.html#cb324-3"></a><span class="st">  </span><span class="kw">geom_point</span>() </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
</div>
</div>
<div id="axis-and-labels" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Axis and labels</h2>
<p>In this section, we learn about about aesthetic and focus on</p>
<ul>
<li>add title and subtitle to the plot</li>
<li>modify axis labels</li>
<li>modify axis range</li>
<li>remove axis
format axis</li>
</ul>
<p>Let us start with a simple scatter plot. We will continue to use the octopus data set and examine the relationship between total length and body weight using <code>geom_point()</code>.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="a-grammar-for-graphics.html#cb325-1"></a>oct =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb325-2"><a href="a-grammar-for-graphics.html#cb325-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb325-3"><a href="a-grammar-for-graphics.html#cb325-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb325-4"><a href="a-grammar-for-graphics.html#cb325-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>We add the axis labels, title and subtitle for the plot using the <code>labs()</code></p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="a-grammar-for-graphics.html#cb326-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb326-2"><a href="a-grammar-for-graphics.html#cb326-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb326-3"><a href="a-grammar-for-graphics.html#cb326-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb326-4"><a href="a-grammar-for-graphics.html#cb326-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb326-5"><a href="a-grammar-for-graphics.html#cb326-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Weight (g)&quot;</span>, </span>
<span id="cb326-6"><a href="a-grammar-for-graphics.html#cb326-6"></a>       <span class="dt">title =</span> <span class="st">&quot;Octopus&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;The total length and body weight of octopus&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-227-1.png" width="672" />
## Axis Range
Often times, you may want to modify the range of the axis value. In <strong>ggplot2</strong>, we can achieve this using <code>scale_</code>function</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="a-grammar-for-graphics.html#cb327-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb327-2"><a href="a-grammar-for-graphics.html#cb327-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb327-3"><a href="a-grammar-for-graphics.html#cb327-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb327-4"><a href="a-grammar-for-graphics.html#cb327-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb327-5"><a href="a-grammar-for-graphics.html#cb327-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Total length (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Weight (g)&quot;</span>, </span>
<span id="cb327-6"><a href="a-grammar-for-graphics.html#cb327-6"></a>       <span class="dt">title =</span> <span class="st">&quot;Octopus&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;The total length and body weight of octopus&quot;</span>)<span class="op">+</span></span>
<span id="cb327-7"><a href="a-grammar-for-graphics.html#cb327-7"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">30</span>,<span class="dv">180</span>,<span class="dv">30</span>))<span class="op">+</span></span>
<span id="cb327-8"><a href="a-grammar-for-graphics.html#cb327-8"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
<p>Sometimes the axis label become a reduntat</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="a-grammar-for-graphics.html#cb328-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb328-2"><a href="a-grammar-for-graphics.html#cb328-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb328-3"><a href="a-grammar-for-graphics.html#cb328-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb328-4"><a href="a-grammar-for-graphics.html#cb328-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb328-5"><a href="a-grammar-for-graphics.html#cb328-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-229-1.png" width="672" /></p>
</div>
<div id="text-annotaion" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Text annotaion</h2>
<p>Annotation help to add custom text to the plot.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="a-grammar-for-graphics.html#cb329-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb329-2"><a href="a-grammar-for-graphics.html#cb329-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb329-3"><a href="a-grammar-for-graphics.html#cb329-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb329-4"><a href="a-grammar-for-graphics.html#cb329-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb329-5"><a href="a-grammar-for-graphics.html#cb329-5"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">20</span>, <span class="dt">y =</span> <span class="fl">2.2</span>, <span class="dt">label =</span> <span class="st">&quot;outlier&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
</div>
<div id="scales" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Scales</h2>
<p>Whenever you specify an aesthetic mapping, <strong>ggplot2</strong> uses a particular scale to determine the range of values that the data encoding should be mapped to. However, there times you need to customize the scale. <strong>ggplot2</strong> has <code>scales_*()</code> function that allows to modify titles, labels, limits, breaks and position of the axis.
Each scale can be represented by a function named in the following format: <code>scale_</code>, followed by the name of the aesthetic property (e.g., x or color), followed by an <code>_</code> and the type of the scale (e.g., continuous or discrete). A continuous scale will handle values such as numeric data (where there is a continuous set of numbers), whereas a discrete scale will handle values such as colors (since there is a small discrete list of distinct colors). In simple language, the x and y-axis of a continuous data is modified with the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> functions.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="a-grammar-for-graphics.html#cb330-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> octopus, </span>
<span id="cb330-2"><a href="a-grammar-for-graphics.html#cb330-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> tl, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb330-3"><a href="a-grammar-for-graphics.html#cb330-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb330-4"><a href="a-grammar-for-graphics.html#cb330-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;gam&quot;</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb330-5"><a href="a-grammar-for-graphics.html#cb330-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">150</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">50</span>,<span class="dv">150</span>,<span class="dv">20</span>))<span class="op">+</span></span>
<span id="cb330-6"><a href="a-grammar-for-graphics.html#cb330-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(.<span class="dv">5</span>, <span class="dv">3</span>, <span class="fl">.5</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-231-1.png" width="672" /></p>
<p>The x and y-axis of a continuous data is modified with the <code>scale_x_discrete()</code> and <code>scale_y_continuous()</code> functions.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="a-grammar-for-graphics.html#cb331-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mafia.chl.season , <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl))<span class="op">+</span></span>
<span id="cb331-2"><a href="a-grammar-for-graphics.html#cb331-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb331-3"><a href="a-grammar-for-graphics.html#cb331-3"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>))<span class="op">+</span></span>
<span id="cb331-4"><a href="a-grammar-for-graphics.html#cb331-4"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>,.<span class="dv">4</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-233-1.png" width="672" /></p>
<p>when the data has been transformed, for instance because of the low value, chlorophyll-a are often stretched with the log-tranformation for visual appeal. But the log-transformed values make no sense about concentration and hence the real values must replace them. We can change the tick labels using the labels argument. When adding labels, tick breaks and labels must have the same length.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="a-grammar-for-graphics.html#cb332-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mafia.chl.season , <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log</span>()))<span class="op">+</span></span>
<span id="cb332-2"><a href="a-grammar-for-graphics.html#cb332-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb332-3"><a href="a-grammar-for-graphics.html#cb332-3"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>), </span>
<span id="cb332-4"><a href="a-grammar-for-graphics.html#cb332-4"></a>                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inter&quot;</span>, <span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;Southeast&quot;</span>))<span class="op">+</span></span>
<span id="cb332-5"><a href="a-grammar-for-graphics.html#cb332-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dt">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb332-6"><a href="a-grammar-for-graphics.html#cb332-6"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.6</span>,<span class="dt">length.out =</span> <span class="dv">5</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-234-1.png" width="672" /></p>
<p>The position of the axes can be changed using the <code>position</code> argument. For instance, to move the the x-axis to the top of the plot you only need to specify <code>position = top</code> as written in code below;</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="a-grammar-for-graphics.html#cb333-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mafia.chl.season , <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log</span>()))<span class="op">+</span></span>
<span id="cb333-2"><a href="a-grammar-for-graphics.html#cb333-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb333-3"><a href="a-grammar-for-graphics.html#cb333-3"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb333-4"><a href="a-grammar-for-graphics.html#cb333-4"></a>                   <span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>), </span>
<span id="cb333-5"><a href="a-grammar-for-graphics.html#cb333-5"></a>                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inter&quot;</span>, <span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;Southeast&quot;</span>))<span class="op">+</span></span>
<span id="cb333-6"><a href="a-grammar-for-graphics.html#cb333-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dt">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb333-7"><a href="a-grammar-for-graphics.html#cb333-7"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.6</span>,<span class="dt">length.out =</span> <span class="dv">5</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<p>Fill the boxplot with season to specify the colors and arrange the colors manual with <code>scale_fill_manual()</code> function as written below.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="a-grammar-for-graphics.html#cb334-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mafia.chl.season , <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log</span>(), <span class="dt">fill =</span> season))<span class="op">+</span></span>
<span id="cb334-2"><a href="a-grammar-for-graphics.html#cb334-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb334-3"><a href="a-grammar-for-graphics.html#cb334-3"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb334-4"><a href="a-grammar-for-graphics.html#cb334-4"></a>                   <span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>), </span>
<span id="cb334-5"><a href="a-grammar-for-graphics.html#cb334-5"></a>                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inter&quot;</span>, <span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;Southeast&quot;</span>))<span class="op">+</span></span>
<span id="cb334-6"><a href="a-grammar-for-graphics.html#cb334-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dt">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb334-7"><a href="a-grammar-for-graphics.html#cb334-7"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.6</span>,<span class="dt">length.out =</span> <span class="dv">5</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-236-1.png" width="672" /></p>
<p>Note the order of layers matter here: you <code>scale_fill_manual()</code> function must start before <code>scale_x_discrete()</code> function. Otherwise the colours you specify mismatch with legend colors as shown</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="a-grammar-for-graphics.html#cb335-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mafia.chl.season , <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log</span>(), <span class="dt">fill =</span> season))<span class="op">+</span></span>
<span id="cb335-2"><a href="a-grammar-for-graphics.html#cb335-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)<span class="op">+</span></span>
<span id="cb335-3"><a href="a-grammar-for-graphics.html#cb335-3"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb335-4"><a href="a-grammar-for-graphics.html#cb335-4"></a>                   <span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;NE&quot;</span>, <span class="st">&quot;IN&quot;</span>, <span class="st">&quot;SE&quot;</span>), </span>
<span id="cb335-5"><a href="a-grammar-for-graphics.html#cb335-5"></a>                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Inter&quot;</span>, <span class="st">&quot;Northeast&quot;</span>, <span class="st">&quot;Southeast&quot;</span>))<span class="op">+</span></span>
<span id="cb335-6"><a href="a-grammar-for-graphics.html#cb335-6"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>))<span class="op">+</span></span>
<span id="cb335-7"><a href="a-grammar-for-graphics.html#cb335-7"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dt">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb335-8"><a href="a-grammar-for-graphics.html#cb335-8"></a>                     <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.6</span>,<span class="dt">length.out =</span> <span class="dv">5</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
<p>The <code>scale_*_reverse()</code> allows to reverse the order of the axis. For instance, when plotting profiles, we reverse y-xis and position the label of x-axis at the top</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="a-grammar-for-graphics.html#cb336-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> algoa.average, </span>
<span id="cb336-2"><a href="a-grammar-for-graphics.html#cb336-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> pressure))<span class="op">+</span></span>
<span id="cb336-3"><a href="a-grammar-for-graphics.html#cb336-3"></a><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb336-4"><a href="a-grammar-for-graphics.html#cb336-4"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">800</span>,<span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb336-5"><a href="a-grammar-for-graphics.html#cb336-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb336-6"><a href="a-grammar-for-graphics.html#cb336-6"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>variable, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
</div>
<div id="guides-1" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Guides</h2>
<p><code>guides()</code> helps to set, modify and remove legend for a specific aesthetic. It has two functions—<code>guide_legend()</code> or <code>guide_colorbar()</code>. Let make a section plot of the fluorescence with the default options for the legend</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="a-grammar-for-graphics.html#cb337-1"></a>section =<span class="kw">ggplot</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-10</span>),</span>
<span id="cb337-2"><a href="a-grammar-for-graphics.html#cb337-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> pressure, <span class="dt">z =</span> fluorescence)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb337-3"><a href="a-grammar-for-graphics.html#cb337-3"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">60</span>) <span class="op">+</span></span>
<span id="cb337-4"><a href="a-grammar-for-graphics.html#cb337-4"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_longitude</span>(<span class="dt">ticks =</span> <span class="fl">.15</span>) <span class="op">+</span></span>
<span id="cb337-5"><a href="a-grammar-for-graphics.html#cb337-5"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">200</span>,<span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb337-6"><a href="a-grammar-for-graphics.html#cb337-6"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), </span>
<span id="cb337-7"><a href="a-grammar-for-graphics.html#cb337-7"></a>                       <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.15</span>,<span class="fl">1.25</span>, <span class="dt">length.out =</span> <span class="dv">6</span>) <span class="op">%&gt;%</span><span class="kw">round</span>(<span class="dv">2</span>))<span class="op">+</span></span>
<span id="cb337-8"><a href="a-grammar-for-graphics.html#cb337-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;Section of oxygen along latitude&quot;</span>, metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="op">-</span><span class="fl">10.54</span>)))<span class="op">+</span></span>
<span id="cb337-9"><a href="a-grammar-for-graphics.html#cb337-9"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">TRUE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">180</span>,<span class="dv">15</span>))</span>
<span id="cb337-10"><a href="a-grammar-for-graphics.html#cb337-10"></a></span>
<span id="cb337-11"><a href="a-grammar-for-graphics.html#cb337-11"></a>section</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-240-1.png" width="672" /></p>
<p>We can add the contour labels and remove the legend in a graph</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="a-grammar-for-graphics.html#cb338-1"></a>section <span class="op">+</span></span>
<span id="cb338-2"><a href="a-grammar-for-graphics.html#cb338-2"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour2</span>() <span class="op">+</span></span>
<span id="cb338-3"><a href="a-grammar-for-graphics.html#cb338-3"></a><span class="st">  </span><span class="co"># metR::geom_text_contour() +</span></span>
<span id="cb338-4"><a href="a-grammar-for-graphics.html#cb338-4"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-241-1.png" width="672" /></p>
<p>The <code>guide_colorbar()</code> modify the look and appearance of the legend to smooth colorbar. for instane the code of lines below highlight the key arguments that one has to specify to modify the legend of colorbar.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="a-grammar-for-graphics.html#cb339-1"></a>section <span class="op">+</span></span>
<span id="cb339-2"><a href="a-grammar-for-graphics.html#cb339-2"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concentration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb339-3"><a href="a-grammar-for-graphics.html#cb339-3"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb339-4"><a href="a-grammar-for-graphics.html#cb339-4"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>),</span>
<span id="cb339-5"><a href="a-grammar-for-graphics.html#cb339-5"></a>                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>,</span>
<span id="cb339-6"><a href="a-grammar-for-graphics.html#cb339-6"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">11</span>),</span>
<span id="cb339-7"><a href="a-grammar-for-graphics.html#cb339-7"></a>                               <span class="dt">label.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb339-8"><a href="a-grammar-for-graphics.html#cb339-8"></a>                               <span class="dt">raster =</span> <span class="ot">FALSE</span>,</span>
<span id="cb339-9"><a href="a-grammar-for-graphics.html#cb339-9"></a>                               <span class="dt">nbin =</span> <span class="dv">12</span>,</span>
<span id="cb339-10"><a href="a-grammar-for-graphics.html#cb339-10"></a>                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>,</span>
<span id="cb339-11"><a href="a-grammar-for-graphics.html#cb339-11"></a>                               <span class="dt">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb339-12"><a href="a-grammar-for-graphics.html#cb339-12"></a>                               <span class="dt">barheight =</span> <span class="dv">15</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-242-1.png" width="672" /></p>
<p>If you want the legend to appear as individual key, use <code>guide_colorbar()</code> as written in the code below</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="a-grammar-for-graphics.html#cb340-1"></a>section <span class="op">+</span></span>
<span id="cb340-2"><a href="a-grammar-for-graphics.html#cb340-2"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span></span>
<span id="cb340-3"><a href="a-grammar-for-graphics.html#cb340-3"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concentration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb340-4"><a href="a-grammar-for-graphics.html#cb340-4"></a>                             <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb340-5"><a href="a-grammar-for-graphics.html#cb340-5"></a>                             <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">13</span>),</span>
<span id="cb340-6"><a href="a-grammar-for-graphics.html#cb340-6"></a>                             <span class="dt">title.hjust =</span> <span class="fl">.5</span>,<span class="dt">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb340-7"><a href="a-grammar-for-graphics.html#cb340-7"></a>                             <span class="dt">reverse =</span> <span class="ot">FALSE</span>, </span>
<span id="cb340-8"><a href="a-grammar-for-graphics.html#cb340-8"></a>                             <span class="dt">keywidth =</span> <span class="fl">3.</span>, <span class="dt">keyheight =</span> <span class="fl">.8</span>,</span>
<span id="cb340-9"><a href="a-grammar-for-graphics.html#cb340-9"></a>                             <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb340-10"><a href="a-grammar-for-graphics.html#cb340-10"></a>                             <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">11</span>),</span>
<span id="cb340-11"><a href="a-grammar-for-graphics.html#cb340-11"></a>                             <span class="dt">label.position =</span> <span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-243-1.png" width="672" /></p>
</div>
<div id="themes" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Themes</h2>
<p>Themes in <strong>ggplot</strong> modify the appearance of all non data compoments in the plot like: axis, legend, panel, plot area, background, margin, facets etc. Let’s create a profile plot of temperature with default theme settings</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="a-grammar-for-graphics.html#cb341-1"></a>profile =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-10</span>), </span>
<span id="cb341-2"><a href="a-grammar-for-graphics.html#cb341-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">color =</span> station))<span class="op">+</span></span>
<span id="cb341-3"><a href="a-grammar-for-graphics.html#cb341-3"></a><span class="st">  </span><span class="kw">geom_path</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb341-4"><a href="a-grammar-for-graphics.html#cb341-4"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">800</span>,<span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb341-5"><a href="a-grammar-for-graphics.html#cb341-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></span>
<span id="cb341-6"><a href="a-grammar-for-graphics.html#cb341-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Pressure [m]&quot;</span>,<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)))</span>
<span id="cb341-7"><a href="a-grammar-for-graphics.html#cb341-7"></a></span>
<span id="cb341-8"><a href="a-grammar-for-graphics.html#cb341-8"></a>profile</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-244-1.png" width="672" /></p>
<p>We can modify the size and color of axis label with the <code>axis.text()</code> and axis title with <code>axis.title()</code> functions. You can use <code>axis.title.y</code> to modify the Y axis title and to modify the title of both the axis together, <code>use axis.title</code>.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="a-grammar-for-graphics.html#cb342-1"></a>profile <span class="op">+</span></span>
<span id="cb342-2"><a href="a-grammar-for-graphics.html#cb342-2"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb342-3"><a href="a-grammar-for-graphics.html#cb342-3"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-245-1.png" width="672" /></p>
<p>To modify the appearance of the axis ticks, use the <code>axis.ticks_*</code> argument. You can change the color, size, linetype and length of the ticks using the <code>element_line()</code> function as shown below.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="a-grammar-for-graphics.html#cb343-1"></a>profile <span class="op">+</span></span>
<span id="cb343-2"><a href="a-grammar-for-graphics.html#cb343-2"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb343-3"><a href="a-grammar-for-graphics.html#cb343-3"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb343-4"><a href="a-grammar-for-graphics.html#cb343-4"></a>        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-246-1.png" width="672" /></p>
<p>The <code>panel_grid</code> argument is used to modify the appearance of the gridlines. You can change the color, size and linetype of the line using the element_line() function.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="a-grammar-for-graphics.html#cb344-1"></a>profile <span class="op">+</span></span>
<span id="cb344-2"><a href="a-grammar-for-graphics.html#cb344-2"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb344-3"><a href="a-grammar-for-graphics.html#cb344-3"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb344-4"><a href="a-grammar-for-graphics.html#cb344-4"></a>        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb344-5"><a href="a-grammar-for-graphics.html#cb344-5"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-247-1.png" width="672" /></p>
<p>The background of the legend can be modified using the legend.background argument. You can change the background color, the border color and line type using <code>element_rect()</code>.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="a-grammar-for-graphics.html#cb345-1"></a>profile <span class="op">+</span></span>
<span id="cb345-2"><a href="a-grammar-for-graphics.html#cb345-2"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb345-3"><a href="a-grammar-for-graphics.html#cb345-3"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb345-4"><a href="a-grammar-for-graphics.html#cb345-4"></a>        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb345-5"><a href="a-grammar-for-graphics.html#cb345-5"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>),</span>
<span id="cb345-6"><a href="a-grammar-for-graphics.html#cb345-6"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-248-1.png" width="672" /></p>
<p>Now, let us look at modifying the non-data components of a legend.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="a-grammar-for-graphics.html#cb346-1"></a>profile <span class="op">+</span></span>
<span id="cb346-2"><a href="a-grammar-for-graphics.html#cb346-2"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb346-3"><a href="a-grammar-for-graphics.html#cb346-3"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb346-4"><a href="a-grammar-for-graphics.html#cb346-4"></a>        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb346-5"><a href="a-grammar-for-graphics.html#cb346-5"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>),</span>
<span id="cb346-6"><a href="a-grammar-for-graphics.html#cb346-6"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb346-7"><a href="a-grammar-for-graphics.html#cb346-7"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb346-8"><a href="a-grammar-for-graphics.html#cb346-8"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">3</span>),</span>
<span id="cb346-9"><a href="a-grammar-for-graphics.html#cb346-9"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-249-1.png" width="672" /></p>
<p>The appearance of the text can be modified using the legend.text argument. You can change the color, size and font using the element_text() function. The position and direction of the legend can be changed using <code>legend.position()</code> function.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="a-grammar-for-graphics.html#cb347-1"></a>profile <span class="op">+</span></span>
<span id="cb347-2"><a href="a-grammar-for-graphics.html#cb347-2"></a><span class="st">  </span><span class="kw">scale_color_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Stations&quot;</span>)<span class="op">+</span></span>
<span id="cb347-3"><a href="a-grammar-for-graphics.html#cb347-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span>  <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb347-4"><a href="a-grammar-for-graphics.html#cb347-4"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>), </span>
<span id="cb347-5"><a href="a-grammar-for-graphics.html#cb347-5"></a>        <span class="dt">axis.ticks.length =</span> <span class="kw">unit</span>(.<span class="dv">3</span>,  <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb347-6"><a href="a-grammar-for-graphics.html#cb347-6"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>),</span>
<span id="cb347-7"><a href="a-grammar-for-graphics.html#cb347-7"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb347-8"><a href="a-grammar-for-graphics.html#cb347-8"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb347-9"><a href="a-grammar-for-graphics.html#cb347-9"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">3</span>),</span>
<span id="cb347-10"><a href="a-grammar-for-graphics.html#cb347-10"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb347-11"><a href="a-grammar-for-graphics.html#cb347-11"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb347-12"><a href="a-grammar-for-graphics.html#cb347-12"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-250-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting-in-r-with-ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="feature.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["geoMarine.pdf", "geoMarine.epub"],
"toc": {
"collapse": "section",
"toc_depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
