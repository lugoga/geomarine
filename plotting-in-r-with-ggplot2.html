<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Plotting in R with ggplot2 | Practical Spatial Data</title>
  <meta name="description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Plotting in R with ggplot2 | Practical Spatial Data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://lugoga.github.io/geomarine/" />
  <meta property="og:image" content="https://lugoga.github.io/geomarine/images/coverPage.svg" />
  <meta property="og:description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="github-repo" content="lugoga/geomarine" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Plotting in R with ggplot2 | Practical Spatial Data" />
  
  <meta name="twitter:description" content="Dealing with spatial data for Coastal and Marine Environment in R is for people who want to analyze, visualize and model geographic data with open source software. It is based on R, a statistical programming language that has powerful data processing, manipulating, and visualizing spatial data. The book equips you with the knowledge and skills to tackle a wide range of issues manifested in geographic data, including those with scientific, societal, and environmental implications. This book will interest people from many backgrounds, especially Geographic Information Systems (GIS), who are interested in applying their domain-specific knowledge in a powerful open source language for data science, and R users interested in extending their skills to handle spatial data." />
  <meta name="twitter:image" content="https://lugoga.github.io/geomarine/images/coverPage.svg" />

<meta name="author" content="Masumbuko Semba" />


<meta name="date" content="2021-01-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dplyr.html"/>
<link rel="next" href="a-grammar-for-graphics.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.16/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Practical Spatial Data: Coastal and Mrine in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-will-you-learn"><i class="fa fa-check"></i>What will you learn?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#audience"><i class="fa fa-check"></i>Audience</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#dedications"><i class="fa fa-check"></i><b>0.1</b> Dedications</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-this-book-came-to-being"><i class="fa fa-check"></i>How this book came to being</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-author"><i class="fa fa-check"></i>About the author</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to GIS</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Learning Objectives</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#what-is-a-gis"><i class="fa fa-check"></i><b>1.2</b> What is a GIS</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#gis-software"><i class="fa fa-check"></i><b>1.3</b> GIS software</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#arcgis"><i class="fa fa-check"></i><b>1.3.1</b> ArcGIS</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#qgis"><i class="fa fa-check"></i><b>1.3.2</b> QGIS</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#r"><i class="fa fa-check"></i><b>1.3.3</b> R</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#why-r"><i class="fa fa-check"></i><b>1.3.4</b> Why R?</a></li>
<li class="chapter" data-level="1.3.5" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>1.3.5</b> Rstudio</a></li>
<li class="chapter" data-level="1.3.6" data-path="intro.html"><a href="intro.html#why-rstudio"><i class="fa fa-check"></i><b>1.3.6</b> Why RStudio?</a></li>
<li class="chapter" data-level="1.3.7" data-path="intro.html"><a href="intro.html#packages"><i class="fa fa-check"></i><b>1.3.7</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#communication-of-results"><i class="fa fa-check"></i><b>1.4</b> Communication of results</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="glimpse.html"><a href="glimpse.html"><i class="fa fa-check"></i><b>2</b> A glimpse of R, Rstudio and Packages</a>
<ul>
<li class="chapter" data-level="2.1" data-path="glimpse.html"><a href="glimpse.html#the-data-analysis-workflow"><i class="fa fa-check"></i><b>2.1</b> The Data Analysis Workflow</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="glimpse.html"><a href="glimpse.html#data-wrangling"><i class="fa fa-check"></i><b>2.1.1</b> Data Wrangling</a></li>
<li class="chapter" data-level="2.1.2" data-path="glimpse.html"><a href="glimpse.html#importing-data"><i class="fa fa-check"></i><b>2.1.2</b> Importing Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="glimpse.html"><a href="glimpse.html#tidying-data"><i class="fa fa-check"></i><b>2.1.3</b> Tidying Data</a></li>
<li class="chapter" data-level="2.1.4" data-path="glimpse.html"><a href="glimpse.html#transforming-data"><i class="fa fa-check"></i><b>2.1.4</b> Transforming Data</a></li>
<li class="chapter" data-level="2.1.5" data-path="glimpse.html"><a href="glimpse.html#visualizing-data"><i class="fa fa-check"></i><b>2.1.5</b> Visualizing Data</a></li>
<li class="chapter" data-level="2.1.6" data-path="glimpse.html"><a href="glimpse.html#models"><i class="fa fa-check"></i><b>2.1.6</b> Models</a></li>
<li class="chapter" data-level="2.1.7" data-path="glimpse.html"><a href="glimpse.html#data-collaboration-and-publishing"><i class="fa fa-check"></i><b>2.1.7</b> Data Collaboration and Publishing</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="glimpse.html"><a href="glimpse.html#installation"><i class="fa fa-check"></i><b>2.2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="glimpse.html"><a href="glimpse.html#installing-r"><i class="fa fa-check"></i><b>2.2.1</b> Installing R</a></li>
<li class="chapter" data-level="2.2.2" data-path="glimpse.html"><a href="glimpse.html#installing-rstudio"><i class="fa fa-check"></i><b>2.2.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="2.2.3" data-path="glimpse.html"><a href="glimpse.html#rstudio-layout"><i class="fa fa-check"></i><b>2.2.3</b> Rstudio Layout</a></li>
<li class="chapter" data-level="2.2.4" data-path="glimpse.html"><a href="glimpse.html#installing-packages"><i class="fa fa-check"></i><b>2.2.4</b> Installing Packages</a></li>
<li class="chapter" data-level="2.2.5" data-path="glimpse.html"><a href="glimpse.html#other-packages"><i class="fa fa-check"></i><b>2.2.5</b> Other packages</a></li>
<li class="chapter" data-level="2.2.6" data-path="glimpse.html"><a href="glimpse.html#loading-installed-packages"><i class="fa fa-check"></i><b>2.2.6</b> Loading installed packages</a></li>
<li class="chapter" data-level="2.2.7" data-path="glimpse.html"><a href="glimpse.html#exploring-r-with-the-swirl-package"><i class="fa fa-check"></i><b>2.2.7</b> Exploring R with the {swirl} Package</a></li>
<li class="chapter" data-level="2.2.8" data-path="glimpse.html"><a href="glimpse.html#conclusion"><i class="fa fa-check"></i><b>2.2.8</b> Conclusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataTypes.html"><a href="dataTypes.html"><i class="fa fa-check"></i><b>3</b> Understanding Data in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataTypes.html"><a href="dataTypes.html#data-types"><i class="fa fa-check"></i><b>3.1</b> Data Types</a></li>
<li class="chapter" data-level="3.2" data-path="dataTypes.html"><a href="dataTypes.html#vectors"><i class="fa fa-check"></i><b>3.2</b> Vectors</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dataTypes.html"><a href="dataTypes.html#numeric-vector"><i class="fa fa-check"></i><b>3.2.1</b> Numeric Vector</a></li>
<li class="chapter" data-level="3.2.2" data-path="dataTypes.html"><a href="dataTypes.html#integer-vector"><i class="fa fa-check"></i><b>3.2.2</b> Integer vector</a></li>
<li class="chapter" data-level="3.2.3" data-path="dataTypes.html"><a href="dataTypes.html#character-vector"><i class="fa fa-check"></i><b>3.2.3</b> Character vector</a></li>
<li class="chapter" data-level="3.2.4" data-path="dataTypes.html"><a href="dataTypes.html#factor-vector"><i class="fa fa-check"></i><b>3.2.4</b> Factor vector</a></li>
<li class="chapter" data-level="3.2.5" data-path="dataTypes.html"><a href="dataTypes.html#logical-vector"><i class="fa fa-check"></i><b>3.2.5</b> Logical Vector</a></li>
<li class="chapter" data-level="3.2.6" data-path="dataTypes.html"><a href="dataTypes.html#date-and-time"><i class="fa fa-check"></i><b>3.2.6</b> Date and Time</a></li>
<li class="chapter" data-level="3.2.7" data-path="dataTypes.html"><a href="dataTypes.html#indexing-the-element"><i class="fa fa-check"></i><b>3.2.7</b> Indexing the element</a></li>
<li class="chapter" data-level="3.2.8" data-path="dataTypes.html"><a href="dataTypes.html#adding-and-replacing-an-element-in-a-vector"><i class="fa fa-check"></i><b>3.2.8</b> Adding and Replacing an element in a vector</a></li>
<li class="chapter" data-level="3.2.9" data-path="dataTypes.html"><a href="dataTypes.html#number-of-elements-in-a-vector"><i class="fa fa-check"></i><b>3.2.9</b> Number of elements in a vector</a></li>
<li class="chapter" data-level="3.2.10" data-path="dataTypes.html"><a href="dataTypes.html#generating-sequence-of-vectors-numbers"><i class="fa fa-check"></i><b>3.2.10</b> Generating sequence of vectors Numbers</a></li>
<li class="chapter" data-level="3.2.11" data-path="dataTypes.html"><a href="dataTypes.html#generating-vector-of-normal-distribution"><i class="fa fa-check"></i><b>3.2.11</b> Generating vector of normal distribution</a></li>
<li class="chapter" data-level="3.2.12" data-path="dataTypes.html"><a href="dataTypes.html#rounding-off-numbers"><i class="fa fa-check"></i><b>3.2.12</b> Rounding off numbers</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="dataTypes.html"><a href="dataTypes.html#data-frame"><i class="fa fa-check"></i><b>3.3</b> Data Frame</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-data-frames"><i class="fa fa-check"></i><b>3.3.1</b> Creating data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataTypes.html"><a href="dataTypes.html#matrix"><i class="fa fa-check"></i><b>3.4</b> Matrix</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="dataTypes.html"><a href="dataTypes.html#creating-matrices"><i class="fa fa-check"></i><b>3.4.1</b> Creating Matrices</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataTypes.html"><a href="dataTypes.html#adding-attributes-to-matrices"><i class="fa fa-check"></i><b>3.4.2</b> Adding attributes to Matrices</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataTypes.html"><a href="dataTypes.html#arrays"><i class="fa fa-check"></i><b>3.5</b> Arrays</a></li>
<li class="chapter" data-level="3.6" data-path="dataTypes.html"><a href="dataTypes.html#dealing-with-misiing-values"><i class="fa fa-check"></i><b>3.6</b> Dealing with Misiing Values</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>4</b> Importing data with <strong>readr</strong></a>
<ul>
<li class="chapter" data-level="4.1" data-path="readr.html"><a href="readr.html#getting-data-into-r"><i class="fa fa-check"></i><b>4.1</b> Getting Data into R</a></li>
<li class="chapter" data-level="4.2" data-path="readr.html"><a href="readr.html#comma-separated-.csv"><i class="fa fa-check"></i><b>4.2</b> Comma-Separated (.csv)</a></li>
<li class="chapter" data-level="4.3" data-path="readr.html"><a href="readr.html#microsoft-excel.xlsx"><i class="fa fa-check"></i><b>4.3</b> Microsoft Excel(.xlsx)</a></li>
<li class="chapter" data-level="4.4" data-path="readr.html"><a href="readr.html#writing-t-a-file"><i class="fa fa-check"></i><b>4.4</b> Writing t a File</a></li>
<li class="chapter" data-level="4.5" data-path="readr.html"><a href="readr.html#basic-data-manipulation"><i class="fa fa-check"></i><b>4.5</b> Basic Data Manipulation</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="readr.html"><a href="readr.html#explore-the-data-frame"><i class="fa fa-check"></i><b>4.5.1</b> Explore the Data Frame</a></li>
<li class="chapter" data-level="4.5.2" data-path="readr.html"><a href="readr.html#simmple-summary-statistics"><i class="fa fa-check"></i><b>4.5.2</b> simmple summary statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>5</b> Reshaping data with <strong>tidyr</strong></a>
<ul>
<li class="chapter" data-level="5.1" data-path="tidy.html"><a href="tidy.html#what-is-tidy-data"><i class="fa fa-check"></i><b>5.1</b> What is Tidy Data?</a></li>
<li class="chapter" data-level="5.2" data-path="tidy.html"><a href="tidy.html#gatherfrom-wide-to-long-format."><i class="fa fa-check"></i><b>5.2</b> Gather—from wide to long format.</a></li>
<li class="chapter" data-level="5.3" data-path="tidy.html"><a href="tidy.html#spreadfrom-long-to-wide-format"><i class="fa fa-check"></i><b>5.3</b> spread—from long to wide format</a></li>
<li class="chapter" data-level="5.4" data-path="tidy.html"><a href="tidy.html#separate-columns"><i class="fa fa-check"></i><b>5.4</b> separate columns</a></li>
<li class="chapter" data-level="5.5" data-path="tidy.html"><a href="tidy.html#unite-columns"><i class="fa fa-check"></i><b>5.5</b> unite columns</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Manipulating Data with <strong>dplyr</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#why-use-dplyr"><i class="fa fa-check"></i><b>6.1</b> Why use dplyr?</a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#core-dplyr-functions"><i class="fa fa-check"></i><b>6.2</b> Core dplyr Functions</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#data"><i class="fa fa-check"></i><b>6.3</b> Data</a></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#choosing-rows-filtering-observations"><i class="fa fa-check"></i><b>6.4</b> Choosing rows: Filtering observations</a></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>6.5</b> select</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="dplyr.html"><a href="dplyr.html#adding-new-variables-mutate-transmute-add_rownames"><i class="fa fa-check"></i><b>6.5.1</b> Adding new variables: mutate, transmute, add_rownames</a></li>
<li class="chapter" data-level="6.5.2" data-path="dplyr.html"><a href="dplyr.html#arranging-rows"><i class="fa fa-check"></i><b>6.5.2</b> Arranging rows</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#summarizing-and-grouping"><i class="fa fa-check"></i><b>6.6</b> Summarizing and Grouping</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Plotting in R with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#a-dataset"><i class="fa fa-check"></i><b>7.1</b> A dataset</a></li>
<li class="chapter" data-level="7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#components-of-ggplot-objects-components"><i class="fa fa-check"></i><b>7.2</b> Components of ggplot objects {components}</a></li>
<li class="chapter" data-level="7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#building-a-plot"><i class="fa fa-check"></i><b>7.3</b> Building a plot</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#plotting-layers"><i class="fa fa-check"></i><b>7.3.1</b> Plotting layers</a></li>
<li class="chapter" data-level="7.3.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-legend"><i class="fa fa-check"></i><b>7.3.2</b> Customize legend</a></li>
<li class="chapter" data-level="7.3.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#working-with-titles-and-labels"><i class="fa fa-check"></i><b>7.3.3</b> Working with titles and labels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#customize-glidline-and-axis-labels"><i class="fa fa-check"></i><b>7.4</b> Customize glidline and axis labels</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#remove-the-gray-box-of-points-on-legend"><i class="fa fa-check"></i><b>7.4.1</b> Remove the gray box of points on legend</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-the-position-of-the-legend"><i class="fa fa-check"></i><b>7.5</b> Modify the position of the legend</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-legend-background-and-stroke-color"><i class="fa fa-check"></i><b>7.5.1</b> Change the legend background and stroke color</a></li>
<li class="chapter" data-level="7.5.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#modify-background-colors"><i class="fa fa-check"></i><b>7.5.2</b> Modify background colors</a></li>
<li class="chapter" data-level="7.5.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-gridlines"><i class="fa fa-check"></i><b>7.5.3</b> change the gridlines</a></li>
<li class="chapter" data-level="7.5.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#change-the-font-size-for-axis-labels-and-titles"><i class="fa fa-check"></i><b>7.5.4</b> Change the font size for axis, labels and titles</a></li>
<li class="chapter" data-level="7.5.5" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#limit-axis-to-a-range"><i class="fa fa-check"></i><b>7.5.5</b> Limit axis to a range</a></li>
<li class="chapter" data-level="7.5.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-labels"><i class="fa fa-check"></i><b>7.5.6</b> Adding labels</a></li>
<li class="chapter" data-level="7.5.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-text-annotation"><i class="fa fa-check"></i><b>7.5.7</b> Add text annotation</a></li>
<li class="chapter" data-level="7.5.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#make-the-x-and-y-axis-the-same"><i class="fa fa-check"></i><b>7.5.8</b> Make the x and y axis the same</a></li>
<li class="chapter" data-level="7.5.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#faceting-creating-multipanel-plots"><i class="fa fa-check"></i><b>7.5.9</b> Faceting —Creating multi–panel plots</a></li>
<li class="chapter" data-level="7.5.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#allow-scales-to-roam-free-scales"><i class="fa fa-check"></i><b>7.5.10</b> Allow scales to roam free (scales)</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#basic-plots"><i class="fa fa-check"></i><b>7.6</b> Basic plots</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scatterplot"><i class="fa fa-check"></i><b>7.6.1</b> scatterplot</a></li>
<li class="chapter" data-level="7.6.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#adding-regression-line"><i class="fa fa-check"></i><b>7.6.2</b> adding regression line</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#linegraph"><i class="fa fa-check"></i><b>7.7</b> Linegraph</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#histogram"><i class="fa fa-check"></i><b>7.7.1</b> histogram</a></li>
<li class="chapter" data-level="7.7.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#boxplot"><i class="fa fa-check"></i><b>7.7.2</b> boxplot</a></li>
<li class="chapter" data-level="7.7.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot"><i class="fa fa-check"></i><b>7.7.3</b> barplot</a></li>
<li class="chapter" data-level="7.7.4" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#barplot-for-values"><i class="fa fa-check"></i><b>7.7.4</b> barplot for values</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#advanced-plots"><i class="fa fa-check"></i><b>7.8</b> Advanced plots</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#facets"><i class="fa fa-check"></i><b>7.8.1</b> Facets</a></li>
<li class="chapter" data-level="7.8.2" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#sea-surface-temperature"><i class="fa fa-check"></i><b>7.8.2</b> Sea Surface Temperature</a></li>
<li class="chapter" data-level="7.8.3" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#subplot"><i class="fa fa-check"></i><b>7.8.3</b> Subplot</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#colour"><i class="fa fa-check"></i><b>7.9</b> Colour</a></li>
<li class="chapter" data-level="7.10" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#size"><i class="fa fa-check"></i><b>7.10</b> size</a></li>
<li class="chapter" data-level="7.11" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#scaling"><i class="fa fa-check"></i><b>7.11</b> scaling</a></li>
<li class="chapter" data-level="7.12" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#guides"><i class="fa fa-check"></i><b>7.12</b> Guides</a></li>
<li class="chapter" data-level="7.13" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#add-on-packages"><i class="fa fa-check"></i><b>7.13</b> Add-on packages</a></li>
<li class="chapter" data-level="7.14" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#ggridges"><i class="fa fa-check"></i><b>7.14</b> ggridges</a></li>
<li class="chapter" data-level="7.15" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#varying-fill-colors-along-the-x-axis"><i class="fa fa-check"></i><b>7.15</b> Varying fill colors along the x axis</a></li>
<li class="chapter" data-level="7.16" data-path="plotting-in-r-with-ggplot2.html"><a href="plotting-in-r-with-ggplot2.html#metr"><i class="fa fa-check"></i><b>7.16</b> metR</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html"><i class="fa fa-check"></i><b>8</b> A grammar for graphics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#geoms"><i class="fa fa-check"></i><b>8.1</b> geoms</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#regression-line"><i class="fa fa-check"></i><b>8.1.1</b> Regression Line</a></li>
<li class="chapter" data-level="8.1.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#horizontal-vertical-lines"><i class="fa fa-check"></i><b>8.1.2</b> Horizontal/ vertical lines</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#aes"><i class="fa fa-check"></i><b>8.2</b> aes()</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#color"><i class="fa fa-check"></i><b>8.2.1</b> Color</a></li>
<li class="chapter" data-level="8.2.2" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#shape"><i class="fa fa-check"></i><b>8.2.2</b> shape</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#axis-and-labels"><i class="fa fa-check"></i><b>8.3</b> Axis and labels</a></li>
<li class="chapter" data-level="8.4" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#text-annotaion"><i class="fa fa-check"></i><b>8.4</b> Text annotaion</a></li>
<li class="chapter" data-level="8.5" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#scales"><i class="fa fa-check"></i><b>8.5</b> Scales</a></li>
<li class="chapter" data-level="8.6" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#guides-1"><i class="fa fa-check"></i><b>8.6</b> Guides</a></li>
<li class="chapter" data-level="8.7" data-path="a-grammar-for-graphics.html"><a href="a-grammar-for-graphics.html#themes"><i class="fa fa-check"></i><b>8.7</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="feature.html"><a href="feature.html"><i class="fa fa-check"></i><b>9</b> Feature Representation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="feature.html"><a href="feature.html#vector"><i class="fa fa-check"></i><b>9.1</b> Vector</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="feature.html"><a href="feature.html#a-point"><i class="fa fa-check"></i><b>9.1.1</b> A point</a></li>
<li class="chapter" data-level="9.1.2" data-path="feature.html"><a href="feature.html#polyline"><i class="fa fa-check"></i><b>9.1.2</b> Polyline</a></li>
<li class="chapter" data-level="9.1.3" data-path="feature.html"><a href="feature.html#polygon"><i class="fa fa-check"></i><b>9.1.3</b> Polygon</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="feature.html"><a href="feature.html#raster"><i class="fa fa-check"></i><b>9.2</b> Raster</a></li>
<li class="chapter" data-level="9.3" data-path="feature.html"><a href="feature.html#important-gis-data-formats"><i class="fa fa-check"></i><b>9.3</b> Important GIS data formats</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="feature.html"><a href="feature.html#shapefiles"><i class="fa fa-check"></i><b>9.3.1</b> Shapefiles</a></li>
<li class="chapter" data-level="9.3.2" data-path="feature.html"><a href="feature.html#raster-1"><i class="fa fa-check"></i><b>9.3.2</b> Raster</a></li>
<li class="chapter" data-level="9.3.3" data-path="feature.html"><a href="feature.html#attribute-tables"><i class="fa fa-check"></i><b>9.3.3</b> Attribute Tables</a></li>
<li class="chapter" data-level="9.3.4" data-path="feature.html"><a href="feature.html#geodatabase"><i class="fa fa-check"></i><b>9.3.4</b> Geodatabase</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="feature.html"><a href="feature.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>9.4</b> Coordinate reference systems</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="feature.html"><a href="feature.html#geographic-coordinate-systems"><i class="fa fa-check"></i><b>9.4.1</b> Geographic coordinate systems</a></li>
<li class="chapter" data-level="9.4.2" data-path="feature.html"><a href="feature.html#projected-coordinate-systems"><i class="fa fa-check"></i><b>9.4.2</b> Projected coordinate systems</a></li>
<li class="chapter" data-level="9.4.3" data-path="feature.html"><a href="feature.html#setting-coordinate-reference-systems-in-r"><i class="fa fa-check"></i><b>9.4.3</b> Setting Coordinate Reference Systems in R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="feature.html"><a href="feature.html#practicals"><i class="fa fa-check"></i><b>9.5</b> Practicals</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="feature.html"><a href="feature.html#plotting-point-data"><i class="fa fa-check"></i><b>9.5.1</b> Plotting Point Data</a></li>
<li class="chapter" data-level="9.5.2" data-path="feature.html"><a href="feature.html#geographic-coordinate-sytem"><i class="fa fa-check"></i><b>9.5.2</b> Geographic Coordinate Sytem</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="feature.html"><a href="feature.html#summary"><i class="fa fa-check"></i><b>9.6</b> Summary</a></li>
<li class="chapter" data-level="9.7" data-path="feature.html"><a href="feature.html#questions"><i class="fa fa-check"></i><b>9.7</b> Questions</a></li>
<li class="chapter" data-level="9.8" data-path="feature.html"><a href="feature.html#further-readings"><i class="fa fa-check"></i><b>9.8</b> FUrther readings</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html"><i class="fa fa-check"></i><b>10</b> Creating Geospatial Data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#getting-data-from-the-web"><i class="fa fa-check"></i><b>10.1</b> Getting data from the web</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#usage"><i class="fa fa-check"></i><b>10.1.1</b> Usage</a></li>
<li class="chapter" data-level="10.1.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#to-download-natural-earth-data-not-already-in-the-package"><i class="fa fa-check"></i><b>10.1.2</b> To download Natural Earth data not already in the package</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-point-data"><i class="fa fa-check"></i><b>10.2</b> Creating Point Data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-point-features"><i class="fa fa-check"></i><b>10.2.1</b> Creating point features</a></li>
<li class="chapter" data-level="10.2.2" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-line-features"><i class="fa fa-check"></i><b>10.2.2</b> Creating line features</a></li>
<li class="chapter" data-level="10.2.3" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#creating-polygon-features"><i class="fa fa-check"></i><b>10.2.3</b> Creating Polygon features</a></li>
<li class="chapter" data-level="10.2.4" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#adding-features-to-vector-data"><i class="fa fa-check"></i><b>10.2.4</b> Adding features to vector data</a></li>
<li class="chapter" data-level="10.2.5" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#digitizing-a-map"><i class="fa fa-check"></i><b>10.2.5</b> Digitizing a map</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#summary-1"><i class="fa fa-check"></i><b>10.3</b> Summary</a></li>
<li class="chapter" data-level="10.4" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#questions-1"><i class="fa fa-check"></i><b>10.4</b> Questions</a></li>
<li class="chapter" data-level="10.5" data-path="creating-geospatial-data.html"><a href="creating-geospatial-data.html#further-reading"><i class="fa fa-check"></i><b>10.5</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html"><i class="fa fa-check"></i><b>11</b> Working with vector data in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#combining-shapefile-in-r"><i class="fa fa-check"></i><b>11.1</b> Combining shapefile in R</a></li>
<li class="chapter" data-level="11.2" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#clipping-in-r"><i class="fa fa-check"></i><b>11.2</b> Clipping in R</a></li>
<li class="chapter" data-level="11.3" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#differences-in-r"><i class="fa fa-check"></i><b>11.3</b> DIfferences in R</a></li>
<li class="chapter" data-level="11.4" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#area-calculation-in-r"><i class="fa fa-check"></i><b>11.4</b> Area calculation in R</a></li>
<li class="chapter" data-level="11.5" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#buffer"><i class="fa fa-check"></i><b>11.5</b> Buffer</a></li>
<li class="chapter" data-level="11.6" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#intersection"><i class="fa fa-check"></i><b>11.6</b> Intersection</a></li>
<li class="chapter" data-level="11.7" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#statistical-summary-of-vector-layers"><i class="fa fa-check"></i><b>11.7</b> Statistical summary of vector layers</a></li>
<li class="chapter" data-level="11.8" data-path="working-with-vector-data-in-r.html"><a href="working-with-vector-data-in-r.html#summary-2"><i class="fa fa-check"></i><b>11.8</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html"><i class="fa fa-check"></i><b>12</b> Working with raster data in R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#nc-data"><i class="fa fa-check"></i><b>12.1</b> NC data</a></li>
<li class="chapter" data-level="12.2" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#changing-the-projection-system-of-a-raster-file"><i class="fa fa-check"></i><b>12.2</b> Changing the projection system of a raster file</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#reading-tiff-format"><i class="fa fa-check"></i><b>12.2.1</b> Reading Tiff format</a></li>
<li class="chapter" data-level="12.2.2" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#reclassifying-rasters"><i class="fa fa-check"></i><b>12.2.2</b> Reclassifying rasters</a></li>
<li class="chapter" data-level="12.2.3" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#mapping-raster"><i class="fa fa-check"></i><b>12.2.3</b> Mapping raster</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#summary-3"><i class="fa fa-check"></i><b>12.3</b> Summary</a></li>
<li class="chapter" data-level="12.4" data-path="working-with-raster-data-in-r.html"><a href="working-with-raster-data-in-r.html#questions-2"><i class="fa fa-check"></i><b>12.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>13</b> Maps</a>
<ul>
<li class="chapter" data-level="13.1" data-path="maps.html"><a href="maps.html#geographical-data-in-a-tidy-format"><i class="fa fa-check"></i><b>13.1</b> Geographical data in a tidy format</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="maps.html"><a href="maps.html#create-simple-feature-from-data.frame"><i class="fa fa-check"></i><b>13.1.1</b> Create simple feature from data.frame</a></li>
<li class="chapter" data-level="13.1.2" data-path="maps.html"><a href="maps.html#importing-shapefile"><i class="fa fa-check"></i><b>13.1.2</b> Importing shapefile</a></li>
<li class="chapter" data-level="13.1.3" data-path="maps.html"><a href="maps.html#reading-other-format"><i class="fa fa-check"></i><b>13.1.3</b> Reading other format</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="maps.html"><a href="maps.html#introduction"><i class="fa fa-check"></i><b>13.2</b> Introduction</a></li>
<li class="chapter" data-level="13.3" data-path="maps.html"><a href="maps.html#static-maps"><i class="fa fa-check"></i><b>13.3</b> Static Maps</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="maps.html"><a href="maps.html#the-bathmetry-data"><i class="fa fa-check"></i><b>13.3.1</b> The bathmetry data</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="maps.html"><a href="maps.html#basemap"><i class="fa fa-check"></i><b>13.4</b> Basemap</a></li>
<li class="chapter" data-level="13.5" data-path="maps.html"><a href="maps.html#creating-contour-map"><i class="fa fa-check"></i><b>13.5</b> Creating contour map</a></li>
<li class="chapter" data-level="13.6" data-path="maps.html"><a href="maps.html#inset-maps"><i class="fa fa-check"></i><b>13.6</b> Inset maps</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="maps.html"><a href="maps.html#choropleth-maps"><i class="fa fa-check"></i><b>13.6.1</b> Choropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="maps.html"><a href="maps.html#animated-maps"><i class="fa fa-check"></i><b>13.7</b> Animated maps</a></li>
<li class="chapter" data-level="13.8" data-path="maps.html"><a href="maps.html#interactive-maps"><i class="fa fa-check"></i><b>13.8</b> Interactive maps</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="c18.html"><a href="c18.html"><i class="fa fa-check"></i><b>14</b> Additional Resources</a>
<ul>
<li class="chapter" data-level="14.1" data-path="c18.html"><a href="c18.html#chapter-overview"><i class="fa fa-check"></i><b>14.1</b> Chapter Overview</a></li>
<li class="chapter" data-level="14.2" data-path="c18.html"><a href="c18.html#data-science-courses"><i class="fa fa-check"></i><b>14.2</b> Data Science Courses</a></li>
<li class="chapter" data-level="14.3" data-path="c18.html"><a href="c18.html#workshop-materials"><i class="fa fa-check"></i><b>14.3</b> Workshop Materials</a></li>
<li class="chapter" data-level="14.4" data-path="c18.html"><a href="c18.html#data-visualization"><i class="fa fa-check"></i><b>14.4</b> Data Visualization</a></li>
<li class="chapter" data-level="14.5" data-path="c18.html"><a href="c18.html#books-related-to-data-science-in-education"><i class="fa fa-check"></i><b>14.5</b> Books Related to Data Science in Education</a></li>
<li class="chapter" data-level="14.6" data-path="c18.html"><a href="c18.html#articles-related-to-data-science-in-education"><i class="fa fa-check"></i><b>14.6</b> Articles Related to Data Science in Education</a></li>
<li class="chapter" data-level="14.7" data-path="c18.html"><a href="c18.html#equity-resources"><i class="fa fa-check"></i><b>14.7</b> Equity Resources</a></li>
<li class="chapter" data-level="14.8" data-path="c18.html"><a href="c18.html#programming-with-r"><i class="fa fa-check"></i><b>14.8</b> Programming with R</a></li>
<li class="chapter" data-level="14.9" data-path="c18.html"><a href="c18.html#statistics"><i class="fa fa-check"></i><b>14.9</b> Statistics</a>
<ul>
<li class="chapter" data-level="14.9.1" data-path="c18.html"><a href="c18.html#introductory-statistics"><i class="fa fa-check"></i><b>14.9.1</b> Introductory Statistics</a></li>
<li class="chapter" data-level="14.9.2" data-path="c18.html"><a href="c18.html#advanced-statistics"><i class="fa fa-check"></i><b>14.9.2</b> Advanced Statistics</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="c18.html"><a href="c18.html#r-packages-and-statistical-software-development"><i class="fa fa-check"></i><b>14.10</b> R packages and Statistical Software Development</a></li>
<li class="chapter" data-level="14.11" data-path="c18.html"><a href="c18.html#a-career-in-data-science"><i class="fa fa-check"></i><b>14.11</b> A Career in Data Science</a></li>
<li class="chapter" data-level="14.12" data-path="c18.html"><a href="c18.html#places-to-share-your-work"><i class="fa fa-check"></i><b>14.12</b> Places to Share Your Work</a></li>
<li class="chapter" data-level="14.13" data-path="c18.html"><a href="c18.html#cheat-sheets"><i class="fa fa-check"></i><b>14.13</b> Cheat Sheets</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="c20.html"><a href="c20.html"><i class="fa fa-check"></i><b>15</b> Appendices</a>
<ul>
<li class="chapter" data-level="15.1" data-path="c20.html"><a href="c20.html#practical-a-getting-started"><i class="fa fa-check"></i><b>15.1</b> Practical A: Getting started</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="c20.html"><a href="c20.html#install-necessary-packages"><i class="fa fa-check"></i><b>15.1.1</b> Install necessary packages</a></li>
<li class="chapter" data-level="15.1.2" data-path="c20.html"><a href="c20.html#create-an-rstudio-project"><i class="fa fa-check"></i><b>15.1.2</b> Create An Rstudio Project</a></li>
<li class="chapter" data-level="15.1.3" data-path="c20.html"><a href="c20.html#create-an-r-markdown-file"><i class="fa fa-check"></i><b>15.1.3</b> Create an R Markdown file</a></li>
<li class="chapter" data-level="15.1.4" data-path="c20.html"><a href="c20.html#create-new-folders"><i class="fa fa-check"></i><b>15.1.4</b> Create New folders</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="c20.html"><a href="c20.html#practical-b-working-with-climate-data"><i class="fa fa-check"></i><b>15.2</b> Practical B: Working with climate data</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="c20.html"><a href="c20.html#part-1-rasters"><i class="fa fa-check"></i><b>15.2.1</b> Part 1: rasters</a></li>
<li class="chapter" data-level="15.2.2" data-path="c20.html"><a href="c20.html#part-2-descriptive-statistics"><i class="fa fa-check"></i><b>15.2.2</b> Part 2 descriptive statistics</a></li>
<li class="chapter" data-level="15.2.3" data-path="c20.html"><a href="c20.html#using-more-data"><i class="fa fa-check"></i><b>15.2.3</b> Using more data</a></li>
<li class="chapter" data-level="15.2.4" data-path="c20.html"><a href="c20.html#wind"><i class="fa fa-check"></i><b>15.2.4</b> Wind</a></li>
<li class="chapter" data-level="15.2.5" data-path="c20.html"><a href="c20.html#precipitation"><i class="fa fa-check"></i><b>15.2.5</b> Precipitation</a></li>
<li class="chapter" data-level="15.2.6" data-path="c20.html"><a href="c20.html#advanced-analysis"><i class="fa fa-check"></i><b>15.2.6</b> Advanced analysis</a></li>
<li class="chapter" data-level="15.2.7" data-path="c20.html"><a href="c20.html#stars-package"><i class="fa fa-check"></i><b>15.2.7</b> stars package</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="c20.html"><a href="c20.html#practical-c-handling-projections-and-coordinate-systems"><i class="fa fa-check"></i><b>15.3</b> Practical C: Handling Projections and Coordinate Systems</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="c20.html"><a href="c20.html#assigning-coordinate-reference-system"><i class="fa fa-check"></i><b>15.3.1</b> Assigning Coordinate reference system</a></li>
<li class="chapter" data-level="15.3.2" data-path="c20.html"><a href="c20.html#transforming-coordinate-system"><i class="fa fa-check"></i><b>15.3.2</b> Transforming coordinate System</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="c20.html"><a href="c20.html#practical-d-finding-loading-and-cleaning-spatial-data"><i class="fa fa-check"></i><b>15.4</b> Practical D: Finding, loading, and cleaning Spatial data</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="c20.html"><a href="c20.html#thinking-about-map-data-the-way-r-does"><i class="fa fa-check"></i><b>15.4.1</b> Thinking about map data the way R does</a></li>
<li class="chapter" data-level="15.4.2" data-path="c20.html"><a href="c20.html#a-brief-introduction-to-simple-features-data-in-r"><i class="fa fa-check"></i><b>15.4.2</b> A brief introduction to simple features data in R</a></li>
<li class="chapter" data-level="15.4.3" data-path="c20.html"><a href="c20.html#finding-data"><i class="fa fa-check"></i><b>15.4.3</b> Finding data</a></li>
<li class="chapter" data-level="15.4.4" data-path="c20.html"><a href="c20.html#finding-non-geospatial-data"><i class="fa fa-check"></i><b>15.4.4</b> Finding non-geospatial data</a></li>
<li class="chapter" data-level="15.4.5" data-path="c20.html"><a href="c20.html#combining-spatial-data-with-non-spatial-data"><i class="fa fa-check"></i><b>15.4.5</b> Combining spatial data with non-spatial data</a></li>
<li class="chapter" data-level="15.4.6" data-path="c20.html"><a href="c20.html#conclusion-1"><i class="fa fa-check"></i><b>15.4.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="c20.html"><a href="c20.html#practical-e-making-maps-with-ggplot2"><i class="fa fa-check"></i><b>15.5</b> Practical E: Making maps with ggplot2</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="c20.html"><a href="c20.html#import-and-clean-the-datasets"><i class="fa fa-check"></i><b>15.5.1</b> Import and clean the datasets</a></li>
<li class="chapter" data-level="15.5.2" data-path="c20.html"><a href="c20.html#add-highlights-and-annotations"><i class="fa fa-check"></i><b>15.5.2</b> Add highlights and annotations</a></li>
<li class="chapter" data-level="15.5.3" data-path="c20.html"><a href="c20.html#inset-map"><i class="fa fa-check"></i><b>15.5.3</b> inset map</a></li>
<li class="chapter" data-level="15.5.4" data-path="c20.html"><a href="c20.html#final-beautification"><i class="fa fa-check"></i><b>15.5.4</b> Final beautification</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="c20.html"><a href="c20.html#practical-f-the-bathmetry-data"><i class="fa fa-check"></i><b>15.6</b> Practical F: The bathmetry data</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="c20.html"><a href="c20.html#zoom-in-on-a-region-of-interest"><i class="fa fa-check"></i><b>15.6.1</b> Zoom in on a region of interest</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="c20.html"><a href="c20.html#practical-g-drawing-maps-programmatically-with-r"><i class="fa fa-check"></i><b>15.7</b> Practical G: Drawing maps programmatically with R</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="c20.html"><a href="c20.html#a-solution-using-r-and-its-ecosystem-of-packages"><i class="fa fa-check"></i><b>15.7.1</b> A solution using R and its ecosystem of packages</a></li>
<li class="chapter" data-level="15.7.2" data-path="c20.html"><a href="c20.html#getting-started"><i class="fa fa-check"></i><b>15.7.2</b> Getting started</a></li>
<li class="chapter" data-level="15.7.3" data-path="c20.html"><a href="c20.html#data-and-basic-plot-ggplot-and-geom_sf"><i class="fa fa-check"></i><b>15.7.3</b> Data and basic plot (<code>ggplot</code> and <code>geom_sf</code>)</a></li>
<li class="chapter" data-level="15.7.4" data-path="c20.html"><a href="c20.html#title-subtitle-and-axis-labels-ggtitle-xlab-ylab"><i class="fa fa-check"></i><b>15.7.4</b> Title, subtitle, and axis labels (<code>ggtitle</code>, <code>xlab</code>, <code>ylab</code>)</a></li>
<li class="chapter" data-level="15.7.5" data-path="c20.html"><a href="c20.html#map-color-geom_sf"><i class="fa fa-check"></i><b>15.7.5</b> Map color (<code>geom_sf</code>)</a></li>
<li class="chapter" data-level="15.7.6" data-path="c20.html"><a href="c20.html#projection-and-extent-coord_sf"><i class="fa fa-check"></i><b>15.7.6</b> Projection and extent (<code>coord_sf</code>)</a></li>
<li class="chapter" data-level="15.7.7" data-path="c20.html"><a href="c20.html#scale-bar-and-north-arrow-package-ggspatial"><i class="fa fa-check"></i><b>15.7.7</b> Scale bar and North arrow (package <code>ggspatial</code>)</a></li>
<li class="chapter" data-level="15.7.8" data-path="c20.html"><a href="c20.html#country-names-and-other-names-geom_text-and-annotate"><i class="fa fa-check"></i><b>15.7.8</b> Country names and other names (<code>geom_text</code> and <code>annotate</code>)</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="c20.html"><a href="c20.html#colophon"><i class="fa fa-check"></i><b>15.8</b> Colophon</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://lugoga.github.io/geomarine/" aria-label='Author Website Link'>
      <img src="images/geoR.svg" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a https://github.com/lugoga/geomarine/" aria-label='GitHub Link'>
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/" aria-label="Creative commons CCBYSA link">
         <i class="fab fa-creative-commons fa-lg"></i> 
         <i class="fab fa-creative-commons-by fa-lg"></i> 
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>      

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Practical Spatial Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-in-r-with-ggplot2" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Plotting in R with <code>ggplot2</code></h1>
<p><strong>ggplot2</strong> is a package we’ll be using a lot for graphing our education datasets. <strong>ggplot2</strong> is designed to build graphs layer by layer, where each layer is a building block for your graph. Making graphs in layers is useful because we can think of building up our graphs in separate parts: the data comes first, then the x-axis and y-axis, and finally other components like text labels and graph shapes. When something goes wrong and your <strong>ggplot2</strong> code returns an error, you can learn about what’s happening by removing one layer at a time and running it again until the code works properly. Once you know which line is causing the problem, you can focus on fixing it.</p>
<p>The ability to create visualizations—graphical representations of data is an important step to convey your results—information and findings to others. In this chapter, we illustrate how you can use visualize your data and create elegant graphics. One of things that makes R such a great tools is it’s data visualization capabilities. R has many systems for visualization and creating plots, some of which are—base R graphics, <strong>lattice</strong> and <strong>ggplot2</strong>, but we focus on the use of <strong>ggplot2</strong>. The <strong>ggplot2</strong> package is a phenomenal tool for creating graphics in R. It provide a unifying framework—a <em>grammar of graphics</em> for describing and building graphs.</p>
<p>Just as the <em>grammar of language</em> helps you construct meaningful sentences out of words, the <em>Grammar of Graphics</em> helps you construct graphics out of different visual elements. This grammar provides a way to talk about parts of a visual plot: all the circles, lines, arrows, and text that are combined into a diagram for visualizing data. Originally developed by Leland Wilkinson, the Grammar of Graphics was adapted by Hadley Wickham <span class="citation">(<a href="#ref-ggplot" role="doc-biblioref">2016</a>)</span> to describe the components of a plot</p>
<p>The <strong>ggplot2</strong> package provides a powerful and flexible approach to data visualization, and its is suitable both for rapdi exploration of different visualization approaches and for producing carefully crafted publication–quality figures. However, getting ggplot2 to make figures that look exactly the way you want them to, can sometimes be challenging and beginners and expert alike can get consufed by themes, scales, coords, guides or facets. <strong>ggplot2</strong> further organizes these components into layers, where each layer displays a single type of (highly configurable) geometric object.</p>
<p>Even the most experienced R users need to refer to <strong>ggplot2</strong> Cheat Sheet while creating elegant graphics, we will demonstrate step–by–step how to get the most out of <strong>ggplot2</strong> package, including how to choose and customize scales, how to theme plots, and when to use add-in packages that extend the <strong>ggplot2</strong> capabilities. Some of the extension of <strong>ggplot2</strong> that we will introuduce to your include <strong>ggspatial</strong> <span class="citation">(Dunnington <a href="#ref-ggspatial" role="doc-biblioref">2020</a>)</span>, <strong>metR</strong> <span class="citation">(Campitelli <a href="#ref-metr" role="doc-biblioref">2019</a>)</span>, <strong>ggrepel</strong> <span class="citation">(Slowikowski <a href="#ref-ggrepel" role="doc-biblioref">2020</a>)</span>, <strong>cowplot</strong> <span class="citation">(Wilke <a href="#ref-cowplot" role="doc-biblioref">2018</a>)</span>, <strong>patchwork</strong> <span class="citation">(Pedersen <a href="#ref-patchwork" role="doc-biblioref">2020</a>)</span>, etc. Rather than loading these extension packages with <code>require()</code> function, we’ll call their functions using the <code>::</code> notation. This will help make it clear which funcions are built into <strong>ggplot2</strong>, and which comes from extensions.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="plotting-in-r-with-ggplot2.html#cb221-1"></a><span class="kw">require</span>(tidyverse)</span>
<span id="cb221-2"><a href="plotting-in-r-with-ggplot2.html#cb221-2"></a><span class="kw">require</span>(magrittr)</span></code></pre></div>
<p>load addition functions</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="plotting-in-r-with-ggplot2.html#cb222-1"></a><span class="kw">source</span>(<span class="st">&quot;e:/Data Manipulation/semba_functions.R&quot;</span>)</span></code></pre></div>
<div id="a-dataset" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> A dataset</h2>
<p>We’re using a CTD profile data along the coastal water of Tanzania collected in August 2004 with Algoa. I have processed and cleaned the profile data from a CTD instrument, and created a very basic and simple dataset for us to start with. I have tidy the data into a data frame and it contains 10 variables collected at 22 stations (Table <a href="plotting-in-r-with-ggplot2.html#tab:tabE01">7.1</a>). These variables include the <code>time</code>, <code>longitude</code> and <code>latitude</code> coordinates and the <code>name</code> at each station. It also contains the measured profile of <code>temperature</code>, <code>salinity</code>, <code>oxygen</code>, and <code>fluorescence</code>, <code>spar</code>, <code>par</code> and <code>density</code> as function of <code>pressure.</code></p>
<table>
<caption>
<span id="tab:tabE01">Table 7.1: </span>A sample of CTD profile dataset. For visibility of all the 22 stations, only variables measured at 5 meter standard depth are shown
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cast Time
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Cast Location
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Measured Variabes
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Station
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:right;">
Hour
</th>
<th style="text-align:right;">
Lon
</th>
<th style="text-align:right;">
Lat
</th>
<th style="text-align:right;">
Pressure
</th>
<th style="text-align:right;">
Temperature
</th>
<th style="text-align:right;">
Salinity
</th>
<th style="text-align:right;">
Oxygen
</th>
<th style="text-align:right;">
Fluorescence
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 2cm; ">
st1
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-18
</td>
<td style="text-align:right;width: 2cm; ">
15
</td>
<td style="text-align:right;width: 2cm; ">
40.61
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.17
</td>
<td style="text-align:right;width: 2.5cm; ">
33.92
</td>
<td style="text-align:right;width: 2.5cm; ">
3.93
</td>
<td style="text-align:right;width: 2.5cm; ">
0.56
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st2
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-18
</td>
<td style="text-align:right;width: 2cm; ">
17
</td>
<td style="text-align:right;width: 2cm; ">
40.77
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.16
</td>
<td style="text-align:right;width: 2.5cm; ">
34.85
</td>
<td style="text-align:right;width: 2.5cm; ">
4.47
</td>
<td style="text-align:right;width: 2.5cm; ">
0.62
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st3
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-18
</td>
<td style="text-align:right;width: 2cm; ">
20
</td>
<td style="text-align:right;width: 2cm; ">
40.95
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st4
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-18
</td>
<td style="text-align:right;width: 2cm; ">
22
</td>
<td style="text-align:right;width: 2cm; ">
41.12
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st5
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
0
</td>
<td style="text-align:right;width: 2cm; ">
41.28
</td>
<td style="text-align:right;width: 2cm; ">
-10.54
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st6
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
11
</td>
<td style="text-align:right;width: 2cm; ">
40.34
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.21
</td>
<td style="text-align:right;width: 2.5cm; ">
34.86
</td>
<td style="text-align:right;width: 2.5cm; ">
4.48
</td>
<td style="text-align:right;width: 2.5cm; ">
0.24
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st7
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
13
</td>
<td style="text-align:right;width: 2cm; ">
40.18
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.25
</td>
<td style="text-align:right;width: 2.5cm; ">
34.87
</td>
<td style="text-align:right;width: 2.5cm; ">
4.52
</td>
<td style="text-align:right;width: 2.5cm; ">
0.44
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st8
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
15
</td>
<td style="text-align:right;width: 2cm; ">
40.00
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.02
</td>
<td style="text-align:right;width: 2.5cm; ">
34.86
</td>
<td style="text-align:right;width: 2.5cm; ">
4.59
</td>
<td style="text-align:right;width: 2.5cm; ">
1.14
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st9
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
17
</td>
<td style="text-align:right;width: 2cm; ">
39.82
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.11
</td>
<td style="text-align:right;width: 2.5cm; ">
34.86
</td>
<td style="text-align:right;width: 2.5cm; ">
4.64
</td>
<td style="text-align:right;width: 2.5cm; ">
1.53
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st10
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-19
</td>
<td style="text-align:right;width: 2cm; ">
19
</td>
<td style="text-align:right;width: 2cm; ">
39.67
</td>
<td style="text-align:right;width: 2cm; ">
-8.83
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
<td style="text-align:right;width: 2.5cm; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st11
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-22
</td>
<td style="text-align:right;width: 2cm; ">
16
</td>
<td style="text-align:right;width: 2cm; ">
39.60
</td>
<td style="text-align:right;width: 2cm; ">
-9.03
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.44
</td>
<td style="text-align:right;width: 2.5cm; ">
34.91
</td>
<td style="text-align:right;width: 2.5cm; ">
4.98
</td>
<td style="text-align:right;width: 2.5cm; ">
1.71
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st12
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
3
</td>
<td style="text-align:right;width: 2cm; ">
40.26
</td>
<td style="text-align:right;width: 2cm; ">
-7.04
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.12
</td>
<td style="text-align:right;width: 2.5cm; ">
34.87
</td>
<td style="text-align:right;width: 2.5cm; ">
4.50
</td>
<td style="text-align:right;width: 2.5cm; ">
0.99
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st13
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
6
</td>
<td style="text-align:right;width: 2cm; ">
40.10
</td>
<td style="text-align:right;width: 2cm; ">
-7.05
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.18
</td>
<td style="text-align:right;width: 2.5cm; ">
34.87
</td>
<td style="text-align:right;width: 2.5cm; ">
4.49
</td>
<td style="text-align:right;width: 2.5cm; ">
0.45
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st14
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
7
</td>
<td style="text-align:right;width: 2cm; ">
39.93
</td>
<td style="text-align:right;width: 2cm; ">
-7.05
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.28
</td>
<td style="text-align:right;width: 2.5cm; ">
34.88
</td>
<td style="text-align:right;width: 2.5cm; ">
4.60
</td>
<td style="text-align:right;width: 2.5cm; ">
0.84
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st15
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
9
</td>
<td style="text-align:right;width: 2cm; ">
39.76
</td>
<td style="text-align:right;width: 2cm; ">
-7.04
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.26
</td>
<td style="text-align:right;width: 2.5cm; ">
34.89
</td>
<td style="text-align:right;width: 2.5cm; ">
4.66
</td>
<td style="text-align:right;width: 2.5cm; ">
1.06
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st16
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
11
</td>
<td style="text-align:right;width: 2cm; ">
39.59
</td>
<td style="text-align:right;width: 2cm; ">
-7.04
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.92
</td>
<td style="text-align:right;width: 2.5cm; ">
34.88
</td>
<td style="text-align:right;width: 2.5cm; ">
4.31
</td>
<td style="text-align:right;width: 2.5cm; ">
0.62
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st17
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
19
</td>
<td style="text-align:right;width: 2cm; ">
40.07
</td>
<td style="text-align:right;width: 2cm; ">
-5.49
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.64
</td>
<td style="text-align:right;width: 2.5cm; ">
35.19
</td>
<td style="text-align:right;width: 2.5cm; ">
4.40
</td>
<td style="text-align:right;width: 2.5cm; ">
0.82
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st18
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-23
</td>
<td style="text-align:right;width: 2cm; ">
22
</td>
<td style="text-align:right;width: 2cm; ">
39.90
</td>
<td style="text-align:right;width: 2cm; ">
-5.49
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.28
</td>
<td style="text-align:right;width: 2.5cm; ">
34.90
</td>
<td style="text-align:right;width: 2.5cm; ">
4.52
</td>
<td style="text-align:right;width: 2.5cm; ">
0.85
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st19
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-24
</td>
<td style="text-align:right;width: 2cm; ">
1
</td>
<td style="text-align:right;width: 2cm; ">
39.56
</td>
<td style="text-align:right;width: 2cm; ">
-5.49
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.27
</td>
<td style="text-align:right;width: 2.5cm; ">
34.90
</td>
<td style="text-align:right;width: 2.5cm; ">
4.53
</td>
<td style="text-align:right;width: 2.5cm; ">
0.98
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st20
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-24
</td>
<td style="text-align:right;width: 2cm; ">
3
</td>
<td style="text-align:right;width: 2cm; ">
39.40
</td>
<td style="text-align:right;width: 2cm; ">
-5.47
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.23
</td>
<td style="text-align:right;width: 2.5cm; ">
34.89
</td>
<td style="text-align:right;width: 2.5cm; ">
4.81
</td>
<td style="text-align:right;width: 2.5cm; ">
1.11
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st21
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-24
</td>
<td style="text-align:right;width: 2cm; ">
4
</td>
<td style="text-align:right;width: 2cm; ">
39.24
</td>
<td style="text-align:right;width: 2cm; ">
-5.48
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
25.82
</td>
<td style="text-align:right;width: 2.5cm; ">
34.93
</td>
<td style="text-align:right;width: 2.5cm; ">
4.34
</td>
<td style="text-align:right;width: 2.5cm; ">
0.21
</td>
</tr>
<tr>
<td style="text-align:left;width: 2cm; ">
st22
</td>
<td style="text-align:left;width: 2cm; ">
2004-08-24
</td>
<td style="text-align:right;width: 2cm; ">
5
</td>
<td style="text-align:right;width: 2cm; ">
39.10
</td>
<td style="text-align:right;width: 2cm; ">
-5.48
</td>
<td style="text-align:right;width: 2.5cm; ">
5
</td>
<td style="text-align:right;width: 2.5cm; ">
26.05
</td>
<td style="text-align:right;width: 2.5cm; ">
34.95
</td>
<td style="text-align:right;width: 2.5cm; ">
4.32
</td>
<td style="text-align:right;width: 2.5cm; ">
0.42
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="plotting-in-r-with-ggplot2.html#cb223-1"></a><span class="co">## make a variable with labelled latitude</span></span>
<span id="cb223-2"><a href="plotting-in-r-with-ggplot2.html#cb223-2"></a>ctd =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">transect =</span> <span class="st">&quot;transect 1&quot;</span>, <span class="dt">Lat.label =</span> <span class="kw">median</span>(lat)) <span class="op">%&gt;%</span></span>
<span id="cb223-3"><a href="plotting-in-r-with-ggplot2.html#cb223-3"></a><span class="st">  </span><span class="kw">bind_rows</span>(ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-8</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-6</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">transect =</span> <span class="st">&quot;transect 2&quot;</span>, <span class="dt">Lat.label =</span> <span class="kw">median</span>(lat)),</span>
<span id="cb223-4"><a href="plotting-in-r-with-ggplot2.html#cb223-4"></a>            ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&gt;</span><span class="st"> </span><span class="dv">-10</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-8</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">transect =</span> <span class="st">&quot;transect 3&quot;</span>, <span class="dt">Lat.label =</span> <span class="kw">median</span>(lat)),</span>
<span id="cb223-5"><a href="plotting-in-r-with-ggplot2.html#cb223-5"></a>            ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">transect =</span> <span class="st">&quot;transect 4&quot;</span>,  <span class="dt">Lat.label =</span> <span class="kw">median</span>(lat))) <span class="op">%&gt;%</span></span>
<span id="cb223-6"><a href="plotting-in-r-with-ggplot2.html#cb223-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Lat.label =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(Lat.label<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="kw">as.factor</span>()) </span></code></pre></div>
</div>
<div id="components-of-ggplot-objects-components" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Components of ggplot objects {components}</h2>
<p>I have created a simple plot of this data that show scatterplot of temperature versus fluorescence at the four different transects (Fig @fig:fig1299). The plot show the concentration of fluorescence against temperature for the twenty one stations along the coastal water of Tanzania.</p>
<div class="figure"><span id="fig:fig1299"></span>
<img src="geoMarine_files/figure-html/fig1299-1.png" alt="Association of fluorescence concentration per temperature collected in August 2004" width="672" />
<p class="caption">
Figure 7.1: Association of fluorescence concentration per temperature collected in August 2004
</p>
</div>
<p>Let’s explore in details the key elements used to make figure <a href="plotting-in-r-with-ggplot2.html#fig:fig1299">7.1</a>:</p>
<ul>
<li><strong>data</strong>: The data like the one illustrated in table <a href="plotting-in-r-with-ggplot2.html#tab:tabE01">7.1</a>. It must be a data frame for ggplot2 read and understand.</li>
<li><strong>aesthetics</strong>: is used to map the <code>x</code> and <code>y</code> axis for 2–dimensional plot and add the <code>z</code> value for 3–dimensionla plots. It is also used to define visual properties like color, size, shapes or height etc, and. For instance in the figure <a href="plotting-in-r-with-ggplot2.html#fig:fig1299">7.1</a>, the position along the <code>y</code>-axis is mapped to the concentration of fluorescence and the <code>x</code> - axis is mapped to temperature values. For the points, the color is mapped to the geogrphical location along the transects. Other aesthetics—like size, shape, and transparency have been left at their default settings.</li>
<li><strong>geometry</strong>; a layer which define the type of plot you want to make, whether is <code>histogram</code>, <code>boxplot</code>, <code>barplot</code>, <code>scatterplot</code>, <code>lineplot</code> etc.</li>
<li><strong>coordinate system</strong>: used to set a limit for the plot. The cartesian coordinate is the most familiar and common system that is widely used to zoom the plot and does not change the underlying data.</li>
<li><strong>scales</strong>: scales allows to customize the plot. For instance in figure <a href="plotting-in-r-with-ggplot2.html#fig:fig1299">7.1</a> both x and y-axis used continuous data and hence the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> were used to modiy the values of the axis. For color, I simply stick on <code>scale_colour_discrete()</code> and customize the legend name.</li>
<li><strong>labels</strong>: The plot is well labelled and easy to understand. It has title, subtitle, axes and caption for the courtesy of the data.</li>
<li><strong>theme</strong>: the plot stick on the default <code>theme_gray</code> theme, which has a gray background color and white gridlines, a sans serif font family, and a base font size of 11. We can customize all the propoerties in the theme to suit our standard.</li>
</ul>
</div>
<div id="building-a-plot" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Building a plot</h2>
<p>Since you now have a clue of the different layers added to create a plot, its time to work around to create a plot with the <strong>ggplot2</strong> package. We use the same profile dataset that used to make figure <a href="plotting-in-r-with-ggplot2.html#fig:fig1299">7.1</a>. First, you neeed to import the data into your R session.</p>
<div id="plotting-layers" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Plotting layers</h3>
<p>To create a data visualization using <strong>ggplot2</strong> package, we will add <code>layers</code> for each of the plot elements described in section <a href="#components"><strong>??</strong></a>. I will take you through step by step of the key ines needed to make such a plot. First make sure the <strong>ggplot2</strong> or <strong>tidyverse</strong> packages are loaded in your R’s session. You can load the package with this code;</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="plotting-in-r-with-ggplot2.html#cb224-1"></a><span class="kw">require</span>(tidyverse)</span></code></pre></div>
<p>The <strong>ggplot2</strong> create a <code>ggplot</code> object, and you initialize the object with the <code>ggplot()</code> function</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="plotting-in-r-with-ggplot2.html#cb225-1"></a><span class="kw">ggplot</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-120-1.png" width="672" />
The plot above is black with grey background. This is because we have not specified the data and aesthetic arguments inside the <code>ggplot()</code> function. Let’s specify the data, which in our case is the ctd dataset and also specify the x-axis with temperature and y-axis with fluorescence.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="plotting-in-r-with-ggplot2.html#cb226-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb226-2"><a href="plotting-in-r-with-ggplot2.html#cb226-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<p>Now the plot has gridlines and axis with values and labels—x-axis show the value of temperature and the y-axis show the value of fluorescence concentrations. However, there is no graphics. This is because we have not added any geom yet. Therefore, since we have already specified the data and the aesthetic values, now we can add the geom where we map the aesthetics to columns in the dataset. Let’s add the <code>geom_point()</code> and specify the size to 3</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="plotting-in-r-with-ggplot2.html#cb227-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb227-2"><a href="plotting-in-r-with-ggplot2.html#cb227-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb227-3"><a href="plotting-in-r-with-ggplot2.html#cb227-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size  =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-122-1.png" width="672" /></p>
</div>
<div id="customize-legend" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Customize legend</h3>
<p>The plot now show points distributed in the panel plot. But our interest is to color the point at each transect. Next, we add an argument <code>col</code> in the aesthetic that map points that fall along a certain transect with similar color. Since we have a variable called transect in the dataset, we specify this as the code below</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="plotting-in-r-with-ggplot2.html#cb228-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb228-2"><a href="plotting-in-r-with-ggplot2.html#cb228-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb228-3"><a href="plotting-in-r-with-ggplot2.html#cb228-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-123-1.png" width="672" />
The plot above show the points are color–coded to refrect the transect in the legend. Note that the colors scheme used in this plot is the default one. Sometimes you will want to customize the aesthetic for all the points in the plot. To change a color scale, you can use the <code>scale_color_viridis_d()</code>. The <code>_d</code> here represent the discrete variable. If you were using the continuous data, you would use <code>scale_color_viridis_c()</code> scheme instead.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="plotting-in-r-with-ggplot2.html#cb229-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb229-2"><a href="plotting-in-r-with-ggplot2.html#cb229-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb229-3"><a href="plotting-in-r-with-ggplot2.html#cb229-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb229-4"><a href="plotting-in-r-with-ggplot2.html#cb229-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<p>To change the title of the legend you must specify the name argument in your <code>scale_*</code> function. For instance, we specified <code>scale_colour_viridis_d(name = "Transects")</code> to change the legend title for this plot</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="plotting-in-r-with-ggplot2.html#cb230-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb230-2"><a href="plotting-in-r-with-ggplot2.html#cb230-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb230-3"><a href="plotting-in-r-with-ggplot2.html#cb230-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb230-4"><a href="plotting-in-r-with-ggplot2.html#cb230-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects</span><span class="ch">\n</span><span class="st"> of CTD Casts&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-125-1.png" width="672" /></p>
<p>If you want to remove the legend title, we can add a theme layer and specify <code>theme(legend.title = element_blank())</code></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="plotting-in-r-with-ggplot2.html#cb231-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb231-2"><a href="plotting-in-r-with-ggplot2.html#cb231-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb231-3"><a href="plotting-in-r-with-ggplot2.html#cb231-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb231-4"><a href="plotting-in-r-with-ggplot2.html#cb231-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>) <span class="op">+</span></span>
<span id="cb231-5"><a href="plotting-in-r-with-ggplot2.html#cb231-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-126-1.png" width="672" />
We can also change the legend title by specifying theme(legend.title = element_blank())</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="plotting-in-r-with-ggplot2.html#cb232-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb232-2"><a href="plotting-in-r-with-ggplot2.html#cb232-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb232-3"><a href="plotting-in-r-with-ggplot2.html#cb232-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb232-4"><a href="plotting-in-r-with-ggplot2.html#cb232-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects</span><span class="ch">\n</span><span class="st">of CTD Casts&quot;</span>) <span class="op">+</span></span>
<span id="cb232-5"><a href="plotting-in-r-with-ggplot2.html#cb232-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="st">&quot;chocolate&quot;</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-127-1.png" width="672" /></p>
</div>
<div id="working-with-titles-and-labels" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Working with titles and labels</h3>
<p>Often times you need to customize the axis labels. By default, the scale label for each scale is the name of the variable in the dataset. We can change the labels with <code>labs()</code> function. The other elements we would like to add are the plot title and subtitle. If you want to label SI unit in the ggplot, use the <code>expression()</code> function. Note that I used the <code>expression()</code> function to express mathematical symbols in the x and y–axis of the plot.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="plotting-in-r-with-ggplot2.html#cb233-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb233-2"><a href="plotting-in-r-with-ggplot2.html#cb233-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb233-3"><a href="plotting-in-r-with-ggplot2.html#cb233-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb233-4"><a href="plotting-in-r-with-ggplot2.html#cb233-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb233-5"><a href="plotting-in-r-with-ggplot2.html#cb233-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb233-6"><a href="plotting-in-r-with-ggplot2.html#cb233-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb233-7"><a href="plotting-in-r-with-ggplot2.html#cb233-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb233-8"><a href="plotting-in-r-with-ggplot2.html#cb233-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb233-9"><a href="plotting-in-r-with-ggplot2.html#cb233-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
</div>
</div>
<div id="customize-glidline-and-axis-labels" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Customize glidline and axis labels</h2>
<p>The other layer that we would like to add to customize our plot are the <code>scale_x_continous()</code>, which change the gridline of the x-axis and the <code>scale_y_continuous()</code>, which change the gridlines of the y-axis.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="plotting-in-r-with-ggplot2.html#cb234-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb234-2"><a href="plotting-in-r-with-ggplot2.html#cb234-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb234-3"><a href="plotting-in-r-with-ggplot2.html#cb234-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb234-4"><a href="plotting-in-r-with-ggplot2.html#cb234-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb234-5"><a href="plotting-in-r-with-ggplot2.html#cb234-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb234-6"><a href="plotting-in-r-with-ggplot2.html#cb234-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb234-7"><a href="plotting-in-r-with-ggplot2.html#cb234-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb234-8"><a href="plotting-in-r-with-ggplot2.html#cb234-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb234-9"><a href="plotting-in-r-with-ggplot2.html#cb234-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb234-10"><a href="plotting-in-r-with-ggplot2.html#cb234-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb234-11"><a href="plotting-in-r-with-ggplot2.html#cb234-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
<div id="remove-the-gray-box-of-points-on-legend" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Remove the gray box of points on legend</h3>
<p>The default ggplot always put a gray background of the scatterplot. You can remove it by adding a theme layer and specify the argument <code>legend.key = element_blank()</code> to get rid of them</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="plotting-in-r-with-ggplot2.html#cb235-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb235-2"><a href="plotting-in-r-with-ggplot2.html#cb235-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb235-3"><a href="plotting-in-r-with-ggplot2.html#cb235-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb235-4"><a href="plotting-in-r-with-ggplot2.html#cb235-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb235-5"><a href="plotting-in-r-with-ggplot2.html#cb235-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb235-6"><a href="plotting-in-r-with-ggplot2.html#cb235-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb235-7"><a href="plotting-in-r-with-ggplot2.html#cb235-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb235-8"><a href="plotting-in-r-with-ggplot2.html#cb235-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb235-9"><a href="plotting-in-r-with-ggplot2.html#cb235-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb235-10"><a href="plotting-in-r-with-ggplot2.html#cb235-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb235-11"><a href="plotting-in-r-with-ggplot2.html#cb235-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb235-12"><a href="plotting-in-r-with-ggplot2.html#cb235-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
</div>
</div>
<div id="modify-the-position-of-the-legend" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Modify the position of the legend</h2>
<p>By default, ggplot2 place the legend on the right position. You can decided to place either left, right, top or bottom. For example, if we want to place the legend at the bottom, we simply specifying the argument <code>legend.position = "bottom"</code> in the theme layer.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="plotting-in-r-with-ggplot2.html#cb236-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb236-2"><a href="plotting-in-r-with-ggplot2.html#cb236-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb236-3"><a href="plotting-in-r-with-ggplot2.html#cb236-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb236-4"><a href="plotting-in-r-with-ggplot2.html#cb236-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb236-5"><a href="plotting-in-r-with-ggplot2.html#cb236-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb236-6"><a href="plotting-in-r-with-ggplot2.html#cb236-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb236-7"><a href="plotting-in-r-with-ggplot2.html#cb236-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb236-8"><a href="plotting-in-r-with-ggplot2.html#cb236-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb236-9"><a href="plotting-in-r-with-ggplot2.html#cb236-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb236-10"><a href="plotting-in-r-with-ggplot2.html#cb236-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb236-11"><a href="plotting-in-r-with-ggplot2.html#cb236-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb236-12"><a href="plotting-in-r-with-ggplot2.html#cb236-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb236-13"><a href="plotting-in-r-with-ggplot2.html#cb236-13"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-131-1.png" width="672" /></p>
<p>We can also position the legend insite the plot and specify the x and y coordinates. The coordinates range from 0 to 1, from left to right or bottom to top of the plot. For instance, we can place the legend at the top right corner of the plot by specifying <code>legend.position = c(.9,.75)</code> in the theme layer.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="plotting-in-r-with-ggplot2.html#cb237-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb237-2"><a href="plotting-in-r-with-ggplot2.html#cb237-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb237-3"><a href="plotting-in-r-with-ggplot2.html#cb237-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb237-4"><a href="plotting-in-r-with-ggplot2.html#cb237-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb237-5"><a href="plotting-in-r-with-ggplot2.html#cb237-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb237-6"><a href="plotting-in-r-with-ggplot2.html#cb237-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb237-7"><a href="plotting-in-r-with-ggplot2.html#cb237-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb237-8"><a href="plotting-in-r-with-ggplot2.html#cb237-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb237-9"><a href="plotting-in-r-with-ggplot2.html#cb237-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb237-10"><a href="plotting-in-r-with-ggplot2.html#cb237-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb237-11"><a href="plotting-in-r-with-ggplot2.html#cb237-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb237-12"><a href="plotting-in-r-with-ggplot2.html#cb237-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb237-13"><a href="plotting-in-r-with-ggplot2.html#cb237-13"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<div id="change-the-legend-background-and-stroke-color" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Change the legend background and stroke color</h3>
<p>By default, ggplot legend has a white fill for background and without color for stroke. We can customize the look of the legend in the theme layer. For example, we want our legend to have an ivory fill and black stroke of 0.25 size. This can be achieved by adding and argument<code>legend.background = element_rect(fill = "ivory", colour = "black", size = .25)</code> in the theme layer.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="plotting-in-r-with-ggplot2.html#cb238-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb238-2"><a href="plotting-in-r-with-ggplot2.html#cb238-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb238-3"><a href="plotting-in-r-with-ggplot2.html#cb238-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb238-4"><a href="plotting-in-r-with-ggplot2.html#cb238-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb238-5"><a href="plotting-in-r-with-ggplot2.html#cb238-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb238-6"><a href="plotting-in-r-with-ggplot2.html#cb238-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb238-7"><a href="plotting-in-r-with-ggplot2.html#cb238-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb238-8"><a href="plotting-in-r-with-ggplot2.html#cb238-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb238-9"><a href="plotting-in-r-with-ggplot2.html#cb238-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb238-10"><a href="plotting-in-r-with-ggplot2.html#cb238-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb238-11"><a href="plotting-in-r-with-ggplot2.html#cb238-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb238-12"><a href="plotting-in-r-with-ggplot2.html#cb238-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb238-13"><a href="plotting-in-r-with-ggplot2.html#cb238-13"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),</span>
<span id="cb238-14"><a href="plotting-in-r-with-ggplot2.html#cb238-14"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
</div>
<div id="modify-background-colors" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Modify background colors</h3>
<p>You can remove the background fill and stroke color with the <code>panel.background = element_blank()</code></p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="plotting-in-r-with-ggplot2.html#cb239-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb239-2"><a href="plotting-in-r-with-ggplot2.html#cb239-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb239-3"><a href="plotting-in-r-with-ggplot2.html#cb239-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb239-4"><a href="plotting-in-r-with-ggplot2.html#cb239-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb239-5"><a href="plotting-in-r-with-ggplot2.html#cb239-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb239-6"><a href="plotting-in-r-with-ggplot2.html#cb239-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb239-7"><a href="plotting-in-r-with-ggplot2.html#cb239-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb239-8"><a href="plotting-in-r-with-ggplot2.html#cb239-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb239-9"><a href="plotting-in-r-with-ggplot2.html#cb239-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb239-10"><a href="plotting-in-r-with-ggplot2.html#cb239-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb239-11"><a href="plotting-in-r-with-ggplot2.html#cb239-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb239-12"><a href="plotting-in-r-with-ggplot2.html#cb239-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb239-13"><a href="plotting-in-r-with-ggplot2.html#cb239-13"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),</span>
<span id="cb239-14"><a href="plotting-in-r-with-ggplot2.html#cb239-14"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>),</span>
<span id="cb239-15"><a href="plotting-in-r-with-ggplot2.html#cb239-15"></a>        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-134-1.png" width="672" /></p>
<p>You can customize the the background fill and stroke colors to your what fit you best with the <code>panel.background = element_rect()</code> and specify the stroke with <code>color</code> and background with the <code>fill</code> arguments.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="plotting-in-r-with-ggplot2.html#cb240-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb240-2"><a href="plotting-in-r-with-ggplot2.html#cb240-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb240-3"><a href="plotting-in-r-with-ggplot2.html#cb240-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb240-4"><a href="plotting-in-r-with-ggplot2.html#cb240-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb240-5"><a href="plotting-in-r-with-ggplot2.html#cb240-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb240-6"><a href="plotting-in-r-with-ggplot2.html#cb240-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb240-7"><a href="plotting-in-r-with-ggplot2.html#cb240-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb240-8"><a href="plotting-in-r-with-ggplot2.html#cb240-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb240-9"><a href="plotting-in-r-with-ggplot2.html#cb240-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb240-10"><a href="plotting-in-r-with-ggplot2.html#cb240-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb240-11"><a href="plotting-in-r-with-ggplot2.html#cb240-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb240-12"><a href="plotting-in-r-with-ggplot2.html#cb240-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb240-13"><a href="plotting-in-r-with-ggplot2.html#cb240-13"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),</span>
<span id="cb240-14"><a href="plotting-in-r-with-ggplot2.html#cb240-14"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>),</span>
<span id="cb240-15"><a href="plotting-in-r-with-ggplot2.html#cb240-15"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-135-1.png" width="672" /></p>
</div>
<div id="change-the-gridlines" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> change the gridlines</h3>
<p>You can also customize the color and shape of the gridlines. You can remove the gridline with <code>panel.grid = element_blank()</code> argument in the theme layer. But if you want to customize the gridlines, then you use the <code>panel.grid = element_line()</code> and specify the <code>color</code> and <code>linetype</code> etc.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="plotting-in-r-with-ggplot2.html#cb241-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb241-2"><a href="plotting-in-r-with-ggplot2.html#cb241-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb241-3"><a href="plotting-in-r-with-ggplot2.html#cb241-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb241-4"><a href="plotting-in-r-with-ggplot2.html#cb241-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb241-5"><a href="plotting-in-r-with-ggplot2.html#cb241-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb241-6"><a href="plotting-in-r-with-ggplot2.html#cb241-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb241-7"><a href="plotting-in-r-with-ggplot2.html#cb241-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb241-8"><a href="plotting-in-r-with-ggplot2.html#cb241-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb241-9"><a href="plotting-in-r-with-ggplot2.html#cb241-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb241-10"><a href="plotting-in-r-with-ggplot2.html#cb241-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb241-11"><a href="plotting-in-r-with-ggplot2.html#cb241-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb241-12"><a href="plotting-in-r-with-ggplot2.html#cb241-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb241-13"><a href="plotting-in-r-with-ggplot2.html#cb241-13"></a>        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),</span>
<span id="cb241-14"><a href="plotting-in-r-with-ggplot2.html#cb241-14"></a>        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;ivory&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>),</span>
<span id="cb241-15"><a href="plotting-in-r-with-ggplot2.html#cb241-15"></a>        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb241-16"><a href="plotting-in-r-with-ggplot2.html#cb241-16"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size =</span> <span class="fl">.25</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>
</div>
<div id="change-the-font-size-for-axis-labels-and-titles" class="section level3" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Change the font size for axis, labels and titles</h3>
<p>The fonts for axis ticks, axis-title text have a default font size of 11, if we want to increase the font size to 12 then then we can do that inside the <code>theme()</code>. We can also change the font size for titles, subtitles and legend text and title as the chunk below highlight.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="plotting-in-r-with-ggplot2.html#cb242-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb242-2"><a href="plotting-in-r-with-ggplot2.html#cb242-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb242-3"><a href="plotting-in-r-with-ggplot2.html#cb242-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb242-4"><a href="plotting-in-r-with-ggplot2.html#cb242-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb242-5"><a href="plotting-in-r-with-ggplot2.html#cb242-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb242-6"><a href="plotting-in-r-with-ggplot2.html#cb242-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb242-7"><a href="plotting-in-r-with-ggplot2.html#cb242-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb242-8"><a href="plotting-in-r-with-ggplot2.html#cb242-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb242-9"><a href="plotting-in-r-with-ggplot2.html#cb242-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb242-10"><a href="plotting-in-r-with-ggplot2.html#cb242-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb242-11"><a href="plotting-in-r-with-ggplot2.html#cb242-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb242-12"><a href="plotting-in-r-with-ggplot2.html#cb242-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb242-13"><a href="plotting-in-r-with-ggplot2.html#cb242-13"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), </span>
<span id="cb242-14"><a href="plotting-in-r-with-ggplot2.html#cb242-14"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>), </span>
<span id="cb242-15"><a href="plotting-in-r-with-ggplot2.html#cb242-15"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb242-16"><a href="plotting-in-r-with-ggplot2.html#cb242-16"></a>        <span class="dt">plot.title =</span> <span class="kw">element_text</span>( <span class="dt">size =</span> <span class="dv">20</span>), </span>
<span id="cb242-17"><a href="plotting-in-r-with-ggplot2.html#cb242-17"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), </span>
<span id="cb242-18"><a href="plotting-in-r-with-ggplot2.html#cb242-18"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), </span>
<span id="cb242-19"><a href="plotting-in-r-with-ggplot2.html#cb242-19"></a>        <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
</div>
<div id="limit-axis-to-a-range" class="section level3" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> Limit axis to a range</h3>
<p>We use the <code>coord_cartesian()</code> function to adjust the visible area of the plot. You should specify the range of the <code>ylim=c()</code> and <code>xlim = c()</code> and <code>expand = FALSE</code> to show only the area of the plot you want to visualize.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="plotting-in-r-with-ggplot2.html#cb243-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb243-2"><a href="plotting-in-r-with-ggplot2.html#cb243-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb243-3"><a href="plotting-in-r-with-ggplot2.html#cb243-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb243-4"><a href="plotting-in-r-with-ggplot2.html#cb243-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb243-5"><a href="plotting-in-r-with-ggplot2.html#cb243-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb243-6"><a href="plotting-in-r-with-ggplot2.html#cb243-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb243-7"><a href="plotting-in-r-with-ggplot2.html#cb243-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb243-8"><a href="plotting-in-r-with-ggplot2.html#cb243-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb243-9"><a href="plotting-in-r-with-ggplot2.html#cb243-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb243-10"><a href="plotting-in-r-with-ggplot2.html#cb243-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb243-11"><a href="plotting-in-r-with-ggplot2.html#cb243-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb243-12"><a href="plotting-in-r-with-ggplot2.html#cb243-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb243-13"><a href="plotting-in-r-with-ggplot2.html#cb243-13"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), </span>
<span id="cb243-14"><a href="plotting-in-r-with-ggplot2.html#cb243-14"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>), </span>
<span id="cb243-15"><a href="plotting-in-r-with-ggplot2.html#cb243-15"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb243-16"><a href="plotting-in-r-with-ggplot2.html#cb243-16"></a>        <span class="dt">plot.title =</span> <span class="kw">element_text</span>( <span class="dt">size =</span> <span class="dv">20</span>), </span>
<span id="cb243-17"><a href="plotting-in-r-with-ggplot2.html#cb243-17"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), </span>
<span id="cb243-18"><a href="plotting-in-r-with-ggplot2.html#cb243-18"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), </span>
<span id="cb243-19"><a href="plotting-in-r-with-ggplot2.html#cb243-19"></a>        <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>)) <span class="op">+</span></span>
<span id="cb243-20"><a href="plotting-in-r-with-ggplot2.html#cb243-20"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">24.9</span>,<span class="fl">26.05</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">2</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-138-1.png" width="672" /></p>
</div>
<div id="adding-labels" class="section level3" number="7.5.6">
<h3><span class="header-section-number">7.5.6</span> Adding labels</h3>
<p>ggplot2 provide <code>geom_tex()</code> and <code>geom_label</code> function for adding label on the plot. <code>geom_text()</code> adds text directly to the plot. <code>geom_label()</code> draws a rectangle behind the text, making it easier to read.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="plotting-in-r-with-ggplot2.html#cb244-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb244-2"><a href="plotting-in-r-with-ggplot2.html#cb244-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb244-3"><a href="plotting-in-r-with-ggplot2.html#cb244-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb244-4"><a href="plotting-in-r-with-ggplot2.html#cb244-4"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> station), <span class="dt">nudge_x =</span> <span class="fl">0.05</span>, <span class="dt">nudge_y =</span> <span class="fl">.04</span>)<span class="op">+</span></span>
<span id="cb244-5"><a href="plotting-in-r-with-ggplot2.html#cb244-5"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<p>I find it difficult to position label with <code>geom_text()</code>, especially when you have a lot of points to label. I often use the <strong>ggrepel</strong> package, which provides text and label geoms for <strong>ggplot2</strong> that help to avoid overlapping text labels. These function makes labels repel away from each other and away from the data points.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="plotting-in-r-with-ggplot2.html#cb245-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb245-2"><a href="plotting-in-r-with-ggplot2.html#cb245-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb245-3"><a href="plotting-in-r-with-ggplot2.html#cb245-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb245-4"><a href="plotting-in-r-with-ggplot2.html#cb245-4"></a><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> station))<span class="op">+</span></span>
<span id="cb245-5"><a href="plotting-in-r-with-ggplot2.html#cb245-5"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
<div id="add-text-annotation" class="section level3" number="7.5.7">
<h3><span class="header-section-number">7.5.7</span> Add text annotation</h3>
<p>There are times you may need to add a text on top of the plot. In <em>ggplot2</em> you can place a label using the real values on the plot instead of the hard-core coorinates to specify the location based on scaled coordinates where 0 is low and 1 is high. This is useful for adding small annotations (such as text labels) or if you have your data in vectors, and for some reason don’t want to put them in a data frame.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="plotting-in-r-with-ggplot2.html#cb246-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>), </span>
<span id="cb246-2"><a href="plotting-in-r-with-ggplot2.html#cb246-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb246-3"><a href="plotting-in-r-with-ggplot2.html#cb246-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb246-4"><a href="plotting-in-r-with-ggplot2.html#cb246-4"></a><span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">name =</span> <span class="st">&quot;Transects&quot;</span>)<span class="op">+</span></span>
<span id="cb246-5"><a href="plotting-in-r-with-ggplot2.html#cb246-5"></a><span class="st">   </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb246-6"><a href="plotting-in-r-with-ggplot2.html#cb246-6"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})), </span>
<span id="cb246-7"><a href="plotting-in-r-with-ggplot2.html#cb246-7"></a>       <span class="dt">title =</span> <span class="st">&quot;Association of Temperature and Profile&quot;</span>,</span>
<span id="cb246-8"><a href="plotting-in-r-with-ggplot2.html#cb246-8"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;The plot indicat a remarkable sign of transect dependency&quot;</span>, </span>
<span id="cb246-9"><a href="plotting-in-r-with-ggplot2.html#cb246-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Courtesy of IIOE-2&quot;</span>)<span class="op">+</span></span>
<span id="cb246-10"><a href="plotting-in-r-with-ggplot2.html#cb246-10"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="op">+</span></span>
<span id="cb246-11"><a href="plotting-in-r-with-ggplot2.html#cb246-11"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb246-12"><a href="plotting-in-r-with-ggplot2.html#cb246-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb246-13"><a href="plotting-in-r-with-ggplot2.html#cb246-13"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), </span>
<span id="cb246-14"><a href="plotting-in-r-with-ggplot2.html#cb246-14"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">13</span>), </span>
<span id="cb246-15"><a href="plotting-in-r-with-ggplot2.html#cb246-15"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb246-16"><a href="plotting-in-r-with-ggplot2.html#cb246-16"></a>        <span class="dt">plot.title =</span> <span class="kw">element_text</span>( <span class="dt">size =</span> <span class="dv">20</span>), </span>
<span id="cb246-17"><a href="plotting-in-r-with-ggplot2.html#cb246-17"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), </span>
<span id="cb246-18"><a href="plotting-in-r-with-ggplot2.html#cb246-18"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>), </span>
<span id="cb246-19"><a href="plotting-in-r-with-ggplot2.html#cb246-19"></a>        <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>)) <span class="op">+</span></span>
<span id="cb246-20"><a href="plotting-in-r-with-ggplot2.html#cb246-20"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">24.9</span>,<span class="fl">26.05</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">2</span>), <span class="dt">expand =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb246-21"><a href="plotting-in-r-with-ggplot2.html#cb246-21"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">25.95</span> , <span class="dt">y =</span> <span class="fl">1.82</span>, <span class="dt">label =</span> <span class="st">&quot;My label&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
</div>
<div id="make-the-x-and-y-axis-the-same" class="section level3" number="7.5.8">
<h3><span class="header-section-number">7.5.8</span> Make the x and y axis the same</h3>
<p>The <code>coord_cartesian()</code> is the coordinate system that you will use most of the time because most of the plot are created from two or more variables that have different scales. However, there are situations where you create plots that use the same scale of x-and y-coordinates. For example, ploting temperature profiles from two stations, then an appropriate coordinae system in that case is the <code>coord_equal()</code></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="plotting-in-r-with-ggplot2.html#cb247-1"></a><span class="co">## tidy the temperature from long to wide format </span></span>
<span id="cb247-2"><a href="plotting-in-r-with-ggplot2.html#cb247-2"></a>ctd.temprature.wide =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb247-3"><a href="plotting-in-r-with-ggplot2.html#cb247-3"></a><span class="st">  </span><span class="kw">select</span>(station, temperature, pressure) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb247-4"><a href="plotting-in-r-with-ggplot2.html#cb247-4"></a><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> <span class="st">&quot;station&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;temperature&quot;</span>)</span>
<span id="cb247-5"><a href="plotting-in-r-with-ggplot2.html#cb247-5"></a></span>
<span id="cb247-6"><a href="plotting-in-r-with-ggplot2.html#cb247-6"></a><span class="co">## make aplot</span></span>
<span id="cb247-7"><a href="plotting-in-r-with-ggplot2.html#cb247-7"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.temprature.wide, </span>
<span id="cb247-8"><a href="plotting-in-r-with-ggplot2.html#cb247-8"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> st3, <span class="dt">y =</span> st8)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb247-9"><a href="plotting-in-r-with-ggplot2.html#cb247-9"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb247-10"><a href="plotting-in-r-with-ggplot2.html#cb247-10"></a><span class="st">  </span><span class="kw">coord_equal</span>() </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
</div>
<div id="faceting-creating-multipanel-plots" class="section level3" number="7.5.9">
<h3><span class="header-section-number">7.5.9</span> Faceting —Creating multi–panel plots</h3>
<p>Facets are ways of arranging plots into multiple different pieces (subplots). This allows you to view a separate plot for each unique value in a categorical variable. The <strong>ggplot2</strong> package has a nice function for creating multi-panel plots. The <code>facet_wrap</code> creates essentially a ribbon of plots based on a single variable. For example the plot below, I first filtered only profile below 201 meters and classify them into bins of below 50 meters, 50 to 100 and above 100 meters. This computed depth class was used to make multiple plot of boxplot of fluorescence at the four transects. in the <code>facet_wrap()</code> layer, I specified the <code>~depth.class</code> to use this variable for faceting and <code>nrow = 1</code>, for the canvas to have one row with multiple columns depending on the groups, four our case we get three columns from the depth classes.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="plotting-in-r-with-ggplot2.html#cb248-1"></a><span class="co">## filter the pressure and break them into class of 50,100,200</span></span>
<span id="cb248-2"><a href="plotting-in-r-with-ggplot2.html#cb248-2"></a>ctd.class.depth =<span class="st"> </span>ctd <span class="op">%&gt;%</span></span>
<span id="cb248-3"><a href="plotting-in-r-with-ggplot2.html#cb248-3"></a><span class="st">  </span><span class="kw">filter</span>(pressure <span class="op">&lt;</span><span class="st"> </span><span class="dv">201</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb248-4"><a href="plotting-in-r-with-ggplot2.html#cb248-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">depth.class =</span> <span class="kw">cut</span>(pressure, </span>
<span id="cb248-5"><a href="plotting-in-r-with-ggplot2.html#cb248-5"></a>                           <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>), </span>
<span id="cb248-6"><a href="plotting-in-r-with-ggplot2.html#cb248-6"></a>                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Below 50&quot;</span>, <span class="st">&quot;50-100&quot;</span>, <span class="st">&quot;Above 100&quot;</span>))) </span>
<span id="cb248-7"><a href="plotting-in-r-with-ggplot2.html#cb248-7"></a>  </span>
<span id="cb248-8"><a href="plotting-in-r-with-ggplot2.html#cb248-8"></a>  </span>
<span id="cb248-9"><a href="plotting-in-r-with-ggplot2.html#cb248-9"></a>  <span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.class.depth, </span>
<span id="cb248-10"><a href="plotting-in-r-with-ggplot2.html#cb248-10"></a>         <span class="kw">aes</span>(<span class="dt">x =</span> transect,<span class="dt">y =</span> fluorescence, <span class="dt">fill =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb248-11"><a href="plotting-in-r-with-ggplot2.html#cb248-11"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb248-12"><a href="plotting-in-r-with-ggplot2.html#cb248-12"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span></span>
<span id="cb248-13"><a href="plotting-in-r-with-ggplot2.html#cb248-13"></a><span class="st">    </span><span class="kw">scale_fill_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;transect 1&quot;</span>, <span class="st">&quot;transect 2&quot;</span>, <span class="st">&quot;transect 3&quot;</span>, <span class="st">&quot;transect 4&quot;</span>), </span>
<span id="cb248-14"><a href="plotting-in-r-with-ggplot2.html#cb248-14"></a>                        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pemba&quot;</span>, <span class="st">&quot;Kimbiji&quot;</span>, <span class="st">&quot;Lindi&quot;</span>, <span class="st">&quot;Mtwara&quot;</span>)) <span class="op">+</span></span>
<span id="cb248-15"><a href="plotting-in-r-with-ggplot2.html#cb248-15"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})))<span class="op">+</span><span class="st"> </span></span>
<span id="cb248-16"><a href="plotting-in-r-with-ggplot2.html#cb248-16"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>depth.class, <span class="dt">nrow =</span> <span class="dv">1</span>) </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-143-1.png" width="672" /></p>
</div>
<div id="allow-scales-to-roam-free-scales" class="section level3" number="7.5.10">
<h3><span class="header-section-number">7.5.10</span> Allow scales to roam free (scales)</h3>
<p>The default for multi-panel plots in <strong>ggplot2</strong> is to use equivalent scales in each panel. But sometimes you want to allow a panel’s own data to determine the scale. This may mislead to the audience since it give creaes plots with different scales. You can specify the <code>scales="free"</code> in the <code>facet_wrap()</code> layer written as;</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="plotting-in-r-with-ggplot2.html#cb249-1"></a><span class="co">## filter the pressure and break them into class of 50,100,200</span></span>
<span id="cb249-2"><a href="plotting-in-r-with-ggplot2.html#cb249-2"></a>ctd.class.depth =<span class="st"> </span>ctd <span class="op">%&gt;%</span></span>
<span id="cb249-3"><a href="plotting-in-r-with-ggplot2.html#cb249-3"></a><span class="st">  </span><span class="kw">filter</span>(pressure <span class="op">&lt;</span><span class="st"> </span><span class="dv">201</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb249-4"><a href="plotting-in-r-with-ggplot2.html#cb249-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">depth.class =</span> <span class="kw">cut</span>(pressure, </span>
<span id="cb249-5"><a href="plotting-in-r-with-ggplot2.html#cb249-5"></a>                           <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>), </span>
<span id="cb249-6"><a href="plotting-in-r-with-ggplot2.html#cb249-6"></a>                           <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Below 50&quot;</span>, <span class="st">&quot;50-100&quot;</span>, <span class="st">&quot;Above 100&quot;</span>))) </span>
<span id="cb249-7"><a href="plotting-in-r-with-ggplot2.html#cb249-7"></a>  </span>
<span id="cb249-8"><a href="plotting-in-r-with-ggplot2.html#cb249-8"></a>  </span>
<span id="cb249-9"><a href="plotting-in-r-with-ggplot2.html#cb249-9"></a>  <span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.class.depth, </span>
<span id="cb249-10"><a href="plotting-in-r-with-ggplot2.html#cb249-10"></a>         <span class="kw">aes</span>(<span class="dt">x =</span> transect,<span class="dt">y =</span> fluorescence, <span class="dt">fill =</span> transect)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb249-11"><a href="plotting-in-r-with-ggplot2.html#cb249-11"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb249-12"><a href="plotting-in-r-with-ggplot2.html#cb249-12"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span></span>
<span id="cb249-13"><a href="plotting-in-r-with-ggplot2.html#cb249-13"></a><span class="st">    </span><span class="kw">scale_fill_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;transect 1&quot;</span>, <span class="st">&quot;transect 2&quot;</span>, <span class="st">&quot;transect 3&quot;</span>, <span class="st">&quot;transect 4&quot;</span>), </span>
<span id="cb249-14"><a href="plotting-in-r-with-ggplot2.html#cb249-14"></a>                        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Pemba&quot;</span>, <span class="st">&quot;Kimbiji&quot;</span>, <span class="st">&quot;Lindi&quot;</span>, <span class="st">&quot;Mtwara&quot;</span>)) <span class="op">+</span></span>
<span id="cb249-15"><a href="plotting-in-r-with-ggplot2.html#cb249-15"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="kw">expression</span>(Fluorescence<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})))<span class="op">+</span><span class="st"> </span></span>
<span id="cb249-16"><a href="plotting-in-r-with-ggplot2.html#cb249-16"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>depth.class, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-144-1.png" width="672" /></p>
</div>
</div>
<div id="basic-plots" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Basic plots</h2>
<p>The <strong>ggplot2</strong> package provides a set of functions that mirror the <em>Grammar of Graphics</em>, enabling you to efficaciously specify what you want a plot to look like. To have a glimpse of <strong>ggplot2</strong>, we start with five basic types of plots that are familiar to most people. These include:</p>
<ol style="list-style-type: decimal">
<li>scatterplot</li>
<li>linegraphs</li>
<li>boxplots</li>
<li>histograms</li>
<li>barplots</li>
</ol>
<blockquote>
<p>Note that the four graphs works with quantitative data and barplots are appropriate for categorical data. Thus, understanding the type of data you want to plot is a fundamental principle before you throw the variable into <strong>ggplot2</strong> to make plot for you.</p>
</blockquote>
<div id="scatterplot" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> scatterplot</h3>
<p>Scatterplots are also called bivariate, allows you to visualize the association between two numerical variables. They are among the widely used plot because they can provide an immediate way to see the pattern of association between two numerical variables.</p>
<div class="figure"><span id="fig:unnamed-chunk-145"></span>
<img src="geoMarine_files/figure-html/unnamed-chunk-145-1.png" alt="scatterplot from base R" width="672" />
<p class="caption">
Figure 7.2: scatterplot from base R
</p>
</div>
<p>Most of us are familiar with scatterplot shown in figure  and made several of them using base R, but probably you have not made one based on the fundamental theorem of <em>grammar of graphics</em>. We will visualize the relationship between temperature and fluorescence. Because the ctd is profile data frame with variable as function of pressure, we want to check for the association of all the 22 station but at fixed depth of 10 meters. What this means is that we will take the ctd data and filter all variable at all station measured at water depth of 10 meters from the surface and save this in a new data frame called ctd10d. This can be written as:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="plotting-in-r-with-ggplot2.html#cb250-1"></a>ctd10d =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb250-2"><a href="plotting-in-r-with-ggplot2.html#cb250-2"></a><span class="st">  </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>)</span></code></pre></div>
<p>Let’s now dive into the code of using the *grammar of graphics<strong> to create the scatterplot. We use the <code>ggplot()</code> function from </strong>ggplot2** package. The code to create figure <a href="#fig:"><strong>??</strong></a> is written as;</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="plotting-in-r-with-ggplot2.html#cb251-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd10d,</span>
<span id="cb251-2"><a href="plotting-in-r-with-ggplot2.html#cb251-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb251-3"><a href="plotting-in-r-with-ggplot2.html#cb251-3"></a><span class="st">  </span><span class="kw">geom_point</span>() </span></code></pre></div>
<p>Let’s explore the block above piece-by-piece</p>
<ul>
<li>The plotting in <strong>ggplot2</strong> begin with <code>ggplot()</code> function, where the two components of <em>grammar of graphics</em> are required. in the <code>data</code> component we specify the data frame of variables measured at 10 meter water below the surface by setting <code>data = ctd10d</code>. Then the second argument <code>aes</code>thetic that map the plot with coordinate was set by <code>aes(x = temperature, y = fluorescence))</code>. In a nutshell, the <code>aes()</code> define the variable–axis specifications. For the code above we set the variables <code>temperature</code> into the <code>x</code> coordinate and the variable <code>fluorescence</code> into the <code>y-axis</code>.</li>
<li>We then add a layer to the <code>ggplot()</code> function calll using the <code>+</code> sign. The added layer specify the third part of the *grammar—the <code>geom</code>etric component. Becasue we want to plot scatterplot, the appropriate <code>geom</code> for this case is the <code>geom_point()</code>.</li>
</ul>
<div class="figure"><span id="fig:unnamed-chunk-148"></span>
<img src="geoMarine_files/figure-html/unnamed-chunk-148-1.png" alt="Scatterplot showing the association between temperature and fluorescence at 10  meter water from the surface" width="672" />
<p class="caption">
Figure 7.3: Scatterplot showing the association between temperature and fluorescence at 10 meter water from the surface
</p>
</div>
<p>Once the code is run, it produce two outputs: a warning message and figure <a href="#fig:"><strong>??</strong></a>. The warning message notify us that out of the 22 stations, there are three stations with missing data at 10 meter water. We can check station with missing values with code written below;</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="plotting-in-r-with-ggplot2.html#cb252-1"></a>ctd10d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb252-2"><a href="plotting-in-r-with-ggplot2.html#cb252-2"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(temperature)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb252-3"><a href="plotting-in-r-with-ggplot2.html#cb252-3"></a><span class="st">  </span><span class="kw">select</span>(station, pressure, temperature, fluorescence)</span></code></pre></div>
<pre><code># A tibble: 3 x 4
  station pressure temperature fluorescence
  &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 st10          10          NA           NA
2 st4           10          NA           NA
3 st5           10          NA           NA</code></pre>
</div>
<div id="adding-regression-line" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> adding regression line</h3>
<p>you can simply add the regression line by addign a <code>geom_smooth()</code> layer and specify the <code>method = "lm"</code> and we dont need to show the confidence errors, hence we specify <code>se = FALSE</code></p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="plotting-in-r-with-ggplot2.html#cb254-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd10d,</span>
<span id="cb254-2"><a href="plotting-in-r-with-ggplot2.html#cb254-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb254-3"><a href="plotting-in-r-with-ggplot2.html#cb254-3"></a><span class="st">  </span><span class="kw">geom_point</span>()  <span class="op">+</span></span>
<span id="cb254-4"><a href="plotting-in-r-with-ggplot2.html#cb254-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<p>While the geom_point() and geom_smooth() layers in this code both use the same aesthetic mappings, there’s no reason you couldn’t assign different aesthetic mappings to each geometry. Note that if the layers do share some aesthetic mappings, you can specify those as an argument to the ggplot() function</p>
<p>Looking on the generated scatterplot (Figure <a href="#fig:"><strong>??</strong></a>), we notice a negative relation exist between temperature and fluorescence—stations with high temperature have relatively low concentration of fluorescence and viceversa. We also notice that 16 stations are clustered within <span class="math inline">\(25-25.25^{\circ}\)</span> C and only three are found at temperature range between <span class="math inline">\(25.75-26^{\circ}\)</span> C. We can identify these pattern by adding a <code>col</code> argument in <code>aes</code> by setting <code>aes(x = temperature, y = fluorescence, col = Lat.label))</code>. The code for creating figure <a href="#fig:"><strong>??</strong></a> is written as;</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="plotting-in-r-with-ggplot2.html#cb255-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd10d,</span>
<span id="cb255-2"><a href="plotting-in-r-with-ggplot2.html#cb255-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">col =</span> Lat.label)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb255-3"><a href="plotting-in-r-with-ggplot2.html#cb255-3"></a><span class="st">  </span><span class="kw">geom_point</span>() </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<p>Looking on the color of thelegend, it clearly indicate the two stations with temperatur above <span class="math inline">\(25.75^{\circ}\)</span> C are found along the transect lies along latitude 5.49°S in Pemba Channel and and one at latitde7.04°S off the Kimbiji.</p>
<p>We may also be interested to knwo whether dissolved oxygen has influrence on the the association of temperature and fluoresce. We can achieve that by simply parsing the the <code>shape = oxygen</code>, arguments into the <code>aes</code>thetic component. Figure <a href="#fig:"><strong>??</strong></a> clearly shows the stations with relatively high chlorophyll value have bigger shape (high DO value) and found in relatively less warmer waters in contrast to stations with low chl-value have smaller shape size, indicating low DO and found in relatively warmer water. The chunk for making figure <a href="#fig:"><strong>??</strong></a> is written as:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="plotting-in-r-with-ggplot2.html#cb256-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd10d,</span>
<span id="cb256-2"><a href="plotting-in-r-with-ggplot2.html#cb256-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> fluorescence, <span class="dt">size =</span> oxygen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb256-3"><a href="plotting-in-r-with-ggplot2.html#cb256-3"></a><span class="st">  </span><span class="kw">geom_point</span>() </span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<div class="figure"><span id="fig:unnamed-chunk-154"></span>
<img src="geoMarine_files/figure-html/unnamed-chunk-154-1.png" alt="Scatterplot showing the association between temperature and fluorescence at 10  meter water from the surface and the influence of dissolved oxygen" width="672" />
<p class="caption">
Figure 7.4: Scatterplot showing the association between temperature and fluorescence at 10 meter water from the surface and the influence of dissolved oxygen
</p>
</div>
</div>
</div>
<div id="linegraph" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Linegraph</h2>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="plotting-in-r-with-ggplot2.html#cb257-1"></a><span class="co"># I donwloaded the data using the code below and save it into the project directory. This chunk will never run but rather the proceeding step will use the data that was downloade and processed with code in this chunk.</span></span>
<span id="cb257-2"><a href="plotting-in-r-with-ggplot2.html#cb257-2"></a>result =<span class="st"> </span>xtractomatic<span class="op">::</span><span class="kw">searchData</span>(<span class="st">&quot;datasetname:mday&quot;</span>)</span>
<span id="cb257-3"><a href="plotting-in-r-with-ggplot2.html#cb257-3"></a></span>
<span id="cb257-4"><a href="plotting-in-r-with-ggplot2.html#cb257-4"></a><span class="co">##  sst, Aqua MODIS, NPP, L3SMI, Global,0.041, Science Quality (Monthly Composite)</span></span>
<span id="cb257-5"><a href="plotting-in-r-with-ggplot2.html#cb257-5"></a>xtractomatic<span class="op">::</span><span class="kw">getInfo</span>(<span class="dt">dtype =</span> <span class="st">&quot;mhsstdmday&quot;</span>)</span>
<span id="cb257-6"><a href="plotting-in-r-with-ggplot2.html#cb257-6"></a><span class="co">##  Chlorophyll-a, Aqua MODIS, NPP, L3SMI, Global,0.041, Science Quality (Monthly Composite)</span></span>
<span id="cb257-7"><a href="plotting-in-r-with-ggplot2.html#cb257-7"></a>xtractomatic<span class="op">::</span><span class="kw">getInfo</span>(<span class="dt">dtype =</span> <span class="st">&quot;mhchlamday&quot;</span>)</span>
<span id="cb257-8"><a href="plotting-in-r-with-ggplot2.html#cb257-8"></a></span>
<span id="cb257-9"><a href="plotting-in-r-with-ggplot2.html#cb257-9"></a></span>
<span id="cb257-10"><a href="plotting-in-r-with-ggplot2.html#cb257-10"></a>sst =<span class="st"> </span>xtractomatic<span class="op">::</span><span class="kw">xtracto_3D</span>(<span class="dt">dtype =</span> <span class="st">&quot;mhsstdmday&quot;</span>, </span>
<span id="cb257-11"><a href="plotting-in-r-with-ggplot2.html#cb257-11"></a>                               <span class="dt">xpos =</span> <span class="kw">c</span>(<span class="fl">38.79272</span>,<span class="fl">40.24292</span>), </span>
<span id="cb257-12"><a href="plotting-in-r-with-ggplot2.html#cb257-12"></a>                               <span class="dt">ypos =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">5.692232</span>,<span class="op">-</span><span class="fl">5.451759</span>), </span>
<span id="cb257-13"><a href="plotting-in-r-with-ggplot2.html#cb257-13"></a>                               <span class="dt">tpos =</span> <span class="kw">c</span>(<span class="st">&quot;2014-11-02&quot;</span>, <span class="st">&quot;2019-04-16&quot;</span>))</span>
<span id="cb257-14"><a href="plotting-in-r-with-ggplot2.html#cb257-14"></a></span>
<span id="cb257-15"><a href="plotting-in-r-with-ggplot2.html#cb257-15"></a>chl =<span class="st"> </span>xtractomatic<span class="op">::</span><span class="kw">xtracto_3D</span>(<span class="dt">dtype =</span> <span class="st">&quot;mhchlamday&quot;</span>, </span>
<span id="cb257-16"><a href="plotting-in-r-with-ggplot2.html#cb257-16"></a>                               <span class="dt">xpos =</span> <span class="kw">c</span>(<span class="fl">38.79272</span>, <span class="fl">40.24292</span>), </span>
<span id="cb257-17"><a href="plotting-in-r-with-ggplot2.html#cb257-17"></a>                               <span class="dt">ypos =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">5.692232</span>, <span class="fl">-5.451759</span>), </span>
<span id="cb257-18"><a href="plotting-in-r-with-ggplot2.html#cb257-18"></a>                               <span class="dt">tpos =</span> <span class="kw">c</span>(<span class="st">&quot;2003-01-17&quot;</span>, <span class="st">&quot;2019-04-16&quot;</span>))</span></code></pre></div>
<p>The next basic graph of ggplot2 is the linegraph. Linegraphs is similar to drawing points, except that it conncets the points with line. often times you dont show the points. Linegraphs are commonly used to show time series data. Its inappropriate to use the linegraphs for data that has no clear sequential ordering . Let’s illustrate how to create linegraphs using another dataset of<code>chlorophyll</code> concentration in the Pemba channel. This is a monthly average data from MODIS satellite. I processed the data and stored them in <code>.RData</code> format. We can load this dataset from the working directory with the <code>load()</code> function as shown in the chunk below;</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="plotting-in-r-with-ggplot2.html#cb258-1"></a><span class="kw">load</span>(<span class="st">&quot;data/modis_pemba.RData&quot;</span>)</span></code></pre></div>
<p>Exploring further the dataset, we notice that its an array with 35 longitude spacing and 7 latitude spacing and 196 matrix collected every month from 2003-01-16 to 2019-04-16. Being an array, this dataset is not in the right format, since <strong>ggplot2</strong> only accept the data frame format.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="plotting-in-r-with-ggplot2.html#cb259-1"></a>chl<span class="op">$</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">class</span>();chl<span class="op">$</span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">dim</span>()</span></code></pre></div>
<pre><code>[1] &quot;array&quot;</code></pre>
<pre><code>[1]  35   7 196</code></pre>
<p>Therefore, we need to tidy this dataset from the array into the data frame and find average chlorophyll concentration for each month for 196 months. Because there are 196 matrix, that is a lot of work to do it one after the other. The easiest solution is to loop the process with a <code>for</code> loop. If you are not familiar with how loop works in R, I suggest you check section__ of chapter__, which describe in details. The chunk below highlight the <code>for</code> loop used to convert an array to matrix</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="plotting-in-r-with-ggplot2.html#cb262-1"></a><span class="co">## preallocate object</span></span>
<span id="cb262-2"><a href="plotting-in-r-with-ggplot2.html#cb262-2"></a>sst.tb =<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb262-3"><a href="plotting-in-r-with-ggplot2.html#cb262-3"></a>chl.tb =<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb262-4"><a href="plotting-in-r-with-ggplot2.html#cb262-4"></a></span>
<span id="cb262-5"><a href="plotting-in-r-with-ggplot2.html#cb262-5"></a><span class="co">## loop sst</span></span>
<span id="cb262-6"><a href="plotting-in-r-with-ggplot2.html#cb262-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sst<span class="op">$</span>time)){</span>
<span id="cb262-7"><a href="plotting-in-r-with-ggplot2.html#cb262-7"></a>  </span>
<span id="cb262-8"><a href="plotting-in-r-with-ggplot2.html#cb262-8"></a>  sst.tb[[i]] =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> sst<span class="op">$</span>longitude, </span>
<span id="cb262-9"><a href="plotting-in-r-with-ggplot2.html#cb262-9"></a>                          <span class="dt">y =</span> sst<span class="op">$</span>latitude, </span>
<span id="cb262-10"><a href="plotting-in-r-with-ggplot2.html#cb262-10"></a>                          <span class="dt">data =</span> sst<span class="op">$</span>data[,,i]) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-11"><a href="plotting-in-r-with-ggplot2.html#cb262-11"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">time =</span> sst<span class="op">$</span>time[i] <span class="op">%&gt;%</span><span class="kw">as.Date</span>()) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb262-12"><a href="plotting-in-r-with-ggplot2.html#cb262-12"></a><span class="st">    </span><span class="kw">select</span>(<span class="dt">date =</span> time,<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">sst =</span> value) </span>
<span id="cb262-13"><a href="plotting-in-r-with-ggplot2.html#cb262-13"></a>}</span>
<span id="cb262-14"><a href="plotting-in-r-with-ggplot2.html#cb262-14"></a></span>
<span id="cb262-15"><a href="plotting-in-r-with-ggplot2.html#cb262-15"></a><span class="co">## loop chl</span></span>
<span id="cb262-16"><a href="plotting-in-r-with-ggplot2.html#cb262-16"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(chl<span class="op">$</span>time)){</span>
<span id="cb262-17"><a href="plotting-in-r-with-ggplot2.html#cb262-17"></a>  chl.tb[[j]] =<span class="st"> </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> chl<span class="op">$</span>longitude, </span>
<span id="cb262-18"><a href="plotting-in-r-with-ggplot2.html#cb262-18"></a>                          <span class="dt">y =</span> chl<span class="op">$</span>latitude, </span>
<span id="cb262-19"><a href="plotting-in-r-with-ggplot2.html#cb262-19"></a>                          <span class="dt">data =</span> chl<span class="op">$</span>data[,,j]) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-20"><a href="plotting-in-r-with-ggplot2.html#cb262-20"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">time =</span> chl<span class="op">$</span>time[j] <span class="op">%&gt;%</span><span class="kw">as.Date</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb262-21"><a href="plotting-in-r-with-ggplot2.html#cb262-21"></a><span class="st">    </span><span class="kw">select</span>(<span class="dt">date =</span> time,<span class="dt">lon =</span> x, <span class="dt">lat =</span> y, <span class="dt">chl =</span> value) </span>
<span id="cb262-22"><a href="plotting-in-r-with-ggplot2.html#cb262-22"></a>}</span>
<span id="cb262-23"><a href="plotting-in-r-with-ggplot2.html#cb262-23"></a><span class="co">## unlist the listed sst and chl files</span></span>
<span id="cb262-24"><a href="plotting-in-r-with-ggplot2.html#cb262-24"></a>sst.tb =<span class="st"> </span>sst.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(sst.tb)</span>
<span id="cb262-25"><a href="plotting-in-r-with-ggplot2.html#cb262-25"></a>chl.tb =<span class="st"> </span>chl.tb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(chl.tb)</span></code></pre></div>
<p>We then used the function in <code>lubridate::year()</code> and <code>lubridate::month()</code> to create the <code>year</code> and <code>month</code> variables from the <code>date</code> variables</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="plotting-in-r-with-ggplot2.html#cb263-1"></a>chl.decompose =<span class="st"> </span>chl.tb <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb263-2"><a href="plotting-in-r-with-ggplot2.html#cb263-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> lubridate<span class="op">::</span><span class="kw">month</span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>, <span class="dt">abb =</span> <span class="ot">TRUE</span>), </span>
<span id="cb263-3"><a href="plotting-in-r-with-ggplot2.html#cb263-3"></a>         <span class="dt">year =</span> lubridate<span class="op">::</span><span class="kw">year</span>(date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.integer</span>()) </span></code></pre></div>
<p>To make a plot of annual average of chlorophyll concentration in the Pemba Channel, we need to monthly mean. We exclude data for year 2003 and 2019 because there only seven months in 2003 and four months in 2019, which can affect the analysis. computing annual average can be written as;</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="plotting-in-r-with-ggplot2.html#cb264-1"></a>chl.yearly =<span class="st"> </span>chl.decompose <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb264-2"><a href="plotting-in-r-with-ggplot2.html#cb264-2"></a><span class="st">  </span><span class="kw">filter</span>( year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2003</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2018</span>)<span class="op">%&gt;%</span></span>
<span id="cb264-3"><a href="plotting-in-r-with-ggplot2.html#cb264-3"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb264-4"><a href="plotting-in-r-with-ggplot2.html#cb264-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">chl =</span> <span class="kw">mean</span>(chl, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<p>Let’s create linegraph of annual average chlorophyll-a concentration in the Pemba Channel. Like the scatterplot we made earlier, where supply the data frame in <code>data</code> argument and specified the <code>aes</code>thetic mapping with <code>x</code> and <code>y</code> cooridnates, but instead of using <code>geom_point()</code>, we use the <code>geom_line()</code>. The code to make the line graphy of annual average chlorophyll-a conceration shown in figure <a href="#fig:"><strong>??</strong></a> are written as;</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="plotting-in-r-with-ggplot2.html#cb265-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.yearly, </span>
<span id="cb265-2"><a href="plotting-in-r-with-ggplot2.html#cb265-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> chl))<span class="op">+</span></span>
<span id="cb265-3"><a href="plotting-in-r-with-ggplot2.html#cb265-3"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
<p>Since the selected area is affected with monsoon season, we can further decode the months into their respective southeast (SE) and northeast (NE) and inter-monsoon (IN) seasons using the <code>decode()</code> function from <strong>dplyr</strong> package as the chunk below show;</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="plotting-in-r-with-ggplot2.html#cb266-1"></a>chl.season =<span class="st"> </span>chl.decompose <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb266-2"><a href="plotting-in-r-with-ggplot2.html#cb266-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">season =</span> month <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>(), </span>
<span id="cb266-3"><a href="plotting-in-r-with-ggplot2.html#cb266-3"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Jan =</span> <span class="st">&quot;NE&quot;</span>),</span>
<span id="cb266-4"><a href="plotting-in-r-with-ggplot2.html#cb266-4"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Feb =</span> <span class="st">&quot;NE&quot;</span>),</span>
<span id="cb266-5"><a href="plotting-in-r-with-ggplot2.html#cb266-5"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Mar =</span> <span class="st">&quot;NE&quot;</span>),</span>
<span id="cb266-6"><a href="plotting-in-r-with-ggplot2.html#cb266-6"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Apr =</span> <span class="st">&quot;IN&quot;</span>),</span>
<span id="cb266-7"><a href="plotting-in-r-with-ggplot2.html#cb266-7"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">May =</span> <span class="st">&quot;SE&quot;</span>),</span>
<span id="cb266-8"><a href="plotting-in-r-with-ggplot2.html#cb266-8"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Jun =</span> <span class="st">&quot;SE&quot;</span>),</span>
<span id="cb266-9"><a href="plotting-in-r-with-ggplot2.html#cb266-9"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Jul =</span> <span class="st">&quot;SE&quot;</span>),</span>
<span id="cb266-10"><a href="plotting-in-r-with-ggplot2.html#cb266-10"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Aug =</span> <span class="st">&quot;SE&quot;</span>),</span>
<span id="cb266-11"><a href="plotting-in-r-with-ggplot2.html#cb266-11"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Sep =</span> <span class="st">&quot;SE&quot;</span>),</span>
<span id="cb266-12"><a href="plotting-in-r-with-ggplot2.html#cb266-12"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Oct =</span> <span class="st">&quot;IN&quot;</span>),</span>
<span id="cb266-13"><a href="plotting-in-r-with-ggplot2.html#cb266-13"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Nov =</span> <span class="st">&quot;NE&quot;</span>),</span>
<span id="cb266-14"><a href="plotting-in-r-with-ggplot2.html#cb266-14"></a>         <span class="dt">season =</span> <span class="kw">recode</span>(<span class="dt">.x =</span> season, <span class="dt">Dec =</span> <span class="st">&quot;NE&quot;</span>))</span></code></pre></div>
<p>We then compute the year average of chlorophyll-a at each season as written in the chunk below</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="plotting-in-r-with-ggplot2.html#cb267-1"></a>chl.season =<span class="st"> </span>chl.season <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb267-2"><a href="plotting-in-r-with-ggplot2.html#cb267-2"></a><span class="st">  </span><span class="kw">filter</span>( year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2003</span> <span class="op">&amp;</span><span class="st"> </span>year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2019</span>)<span class="op">%&gt;%</span></span>
<span id="cb267-3"><a href="plotting-in-r-with-ggplot2.html#cb267-3"></a><span class="st">  </span><span class="kw">group_by</span>(year,season) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb267-4"><a href="plotting-in-r-with-ggplot2.html#cb267-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">chl =</span> <span class="kw">mean</span>(chl, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<p>To make a linegraphy that show annual average of chlorophyll-a concetration for each season as in figure <a href="#fig:"><strong>??</strong></a>, we simply parse the argument <code>col == season</code> in the <code>aes()</code> component as the chunk below hightlight</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="plotting-in-r-with-ggplot2.html#cb268-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season, </span>
<span id="cb268-2"><a href="plotting-in-r-with-ggplot2.html#cb268-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> chl, <span class="dt">col =</span> season))<span class="op">+</span></span>
<span id="cb268-3"><a href="plotting-in-r-with-ggplot2.html#cb268-3"></a><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></span>
<span id="cb268-4"><a href="plotting-in-r-with-ggplot2.html#cb268-4"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2002</span>,<span class="dv">2019</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<div id="histogram" class="section level3" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> histogram</h3>
<p>A histogram is a plot that can be used to examine the shape and spread of continuous data. It looks very similar to a bar graph and organized in intervals or classes.
. It divides the range of the data into <code>bin</code> equal intervals (also called bins or classes), count the number of observations n in each bin, and display the frequency distribution of observations as a bar plot. Such histogram plots provide valuable information on the characteristics of the data, such as the <code>central tendency</code>, the <code>dispersion</code> and the general <code>shape</code> of the distribution.</p>
<p>Let’s consider the <code>chl</code> variable in the <code>chl.tb</code> data frame. Since histogram works for single variable that contains quantitative values, you can not bother looking for relationship as we have seen in previous plots, but histogram offers an opportunity to answer question like</p>
<ol style="list-style-type: decimal">
<li>What are the smallest and largest values of chl-a?</li>
<li>What is the center value?
3 How does these values spread out?</li>
</ol>
<p>We can make a histogram shown in figure <a href="#fig:"><strong>??</strong></a> by simply setting <code>aes(x = chl)</code> and add <code>geom_histogram()</code>. Within the geom_histogram(), we simply specify the number of bins <code>bins = 28</code> and also the color seprating each column of the histogram with <code>col == "white"</code>. The code to create figure <a href="#fig:"><strong>??</strong></a>, which displays a histogram with twenty eight classes, is written as;</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="plotting-in-r-with-ggplot2.html#cb269-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.decompose <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(chl <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>), </span>
<span id="cb269-2"><a href="plotting-in-r-with-ggplot2.html#cb269-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> chl))<span class="op">+</span></span>
<span id="cb269-3"><a href="plotting-in-r-with-ggplot2.html#cb269-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">28</span>, <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-168"></span>
<img src="geoMarine_files/figure-html/unnamed-chunk-168-1.png" alt="Histogram showing the distribution of chlorophyll concentration" width="672" />
<p class="caption">
Figure 7.5: Histogram showing the distribution of chlorophyll concentration
</p>
</div>
</div>
<div id="boxplot" class="section level3" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> boxplot</h3>
<p>The box plot is a standardized way of displaying the distribution of data based on the five number summary: minimum, first quartile, median, third quartile, and maximum. Box plots are useful for detecting outliers and for comparing distributions. These five number summary also called the 25<sup>th</sup> percentile, median, and 75<sup>th</sup> percentile of the quantitative data. The whisker (vertical lines) capture reoungly 99% of a distribution, and observaion outside this range are plottted as points representing outliers as shown in figure <a href="plotting-in-r-with-ggplot2.html#fig:boxplot">7.6</a>.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="plotting-in-r-with-ggplot2.html#cb270-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;./images/boxplot-01.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:boxplot"></span>
<img src="images/boxplot-01.png" alt="Boxplot five numbers" width="298" />
<p class="caption">
Figure 7.6: Boxplot five numbers
</p>
</div>
<p>Box plots can be created by using the <code>geom_boxplot()</code> function and specify the data variable.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="plotting-in-r-with-ggplot2.html#cb271-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.decompose <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-2"><a href="plotting-in-r-with-ggplot2.html#cb271-2"></a><span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">y =</span> chl))<span class="op">+</span></span>
<span id="cb271-3"><a href="plotting-in-r-with-ggplot2.html#cb271-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
<p>The firstinput must be a categorical variable and the second must be a continuous variable.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="plotting-in-r-with-ggplot2.html#cb272-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb272-2"><a href="plotting-in-r-with-ggplot2.html#cb272-2"></a><span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl))<span class="op">+</span></span>
<span id="cb272-3"><a href="plotting-in-r-with-ggplot2.html#cb272-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
<p>the <code>geom_boxplot()</code> has <code>outlier_</code> arguments that allows to highlight and modify the color, shape, size, alpha … etc of outliers —extreme observation. For instance, you can highlight the outlier with;</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="plotting-in-r-with-ggplot2.html#cb273-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb273-2"><a href="plotting-in-r-with-ggplot2.html#cb273-2"></a><span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl))<span class="op">+</span></span>
<span id="cb273-3"><a href="plotting-in-r-with-ggplot2.html#cb273-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<p>We can also map the fill and color to variable in to distinguish boxplot. for example, we can specify the <code>fill = season</code> argument in the <code>aes()</code> to fill the boxplot based on season.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="plotting-in-r-with-ggplot2.html#cb274-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> sst.season , </span>
<span id="cb274-2"><a href="plotting-in-r-with-ggplot2.html#cb274-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> sst, <span class="dt">fill =</span> season))<span class="op">+</span></span>
<span id="cb274-3"><a href="plotting-in-r-with-ggplot2.html#cb274-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>( <span class="dt">outlier.colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">outlier.shape =</span> <span class="dv">8</span>, <span class="dt">outlier.size =</span><span class="fl">1.2</span>)<span class="op">+</span></span>
<span id="cb274-4"><a href="plotting-in-r-with-ggplot2.html#cb274-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
<p>We can add the points on top of the boxplot with the <code>geom_jitter()</code>. It also allows for specifying other arguments like colors and width of the points.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="plotting-in-r-with-ggplot2.html#cb275-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> chl.season <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb275-2"><a href="plotting-in-r-with-ggplot2.html#cb275-2"></a><span class="st">         </span><span class="kw">filter</span>( chl <span class="op">&lt;</span><span class="st">  </span><span class="fl">.25</span>), <span class="kw">aes</span>(<span class="dt">x =</span> season, <span class="dt">y =</span> chl))<span class="op">+</span></span>
<span id="cb275-3"><a href="plotting-in-r-with-ggplot2.html#cb275-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()<span class="op">+</span></span>
<span id="cb275-4"><a href="plotting-in-r-with-ggplot2.html#cb275-4"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">.05</span>, <span class="dt">height =</span> <span class="fl">.05</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
</div>
<div id="barplot" class="section level3" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> barplot</h3>
<p>Bar graphs are perhaps the widely used plot. They are typically used to display numeric values on the y-axis for different groups on the x-axis. There is an important distiction you should be aware of when making bar graphs. The heigh of a bar in barplot may represent either the counts or values of elements in the dataset. Let’s begin with the former—count. We use the drifter observations, which passed at the confluence—where the South Equatorial Current splits to form the northward flowing called the East Africa Coastal Current and the southward flowing the Mozambique Current. We first load the daset as the code highlight;</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="plotting-in-r-with-ggplot2.html#cb276-1"></a>drifter_confluence =<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/drifter_confluence.csv&quot;</span>)</span></code></pre></div>
<div id="barplot-for-count" class="section level4" number="7.7.3.1">
<h4><span class="header-section-number">7.7.3.1</span> barplot for count</h4>
<p>To make the bar graph that show the number of drifters crossed the ares per month over the entire period you you simply specify the the variable <code>month</code> in the <code>x</code> coordinates in the <code>aes</code>thetic and add the <code>geom_bar()</code></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="plotting-in-r-with-ggplot2.html#cb277-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter_confluence, </span>
<span id="cb277-2"><a href="plotting-in-r-with-ggplot2.html#cb277-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month)) <span class="op">+</span></span>
<span id="cb277-3"><a href="plotting-in-r-with-ggplot2.html#cb277-3"></a><span class="st">  </span><span class="kw">geom_bar</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
<p>Sometimes you may wish to stack bars. For instance drifter have drogued—an anchor, which reduce speed of the drifter wind effect. When the drogue is lost, drifter slip and tend to overestimate the current speed. In our dataset, the drogue are coded with <code>0 == Absent</code>, and <code>1 = Present</code>. Because zero and ones make no sense, we create a new variables of that replace zero with <code>LOST</code> and ones with <code>PRESENT.</code> we use the <code>if_else()</code> function from <strong>dplyr</strong> to convert these values and assign the object as <code>drifter.drogue</code>. The conversion can be attained with code written as;</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="plotting-in-r-with-ggplot2.html#cb278-1"></a>drifter.drouge =<span class="st"> </span>drifter_confluence <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb278-2"><a href="plotting-in-r-with-ggplot2.html#cb278-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">drogue.status =</span> <span class="kw">if_else</span>(<span class="dt">condition =</span> drogue<span class="op">==</span><span class="dv">1</span>, <span class="dt">true =</span> <span class="st">&quot;PRESENT&quot;</span>, <span class="dt">false =</span> <span class="st">&quot;LOST&quot;</span>))</span></code></pre></div>
<p>Then to stack the bar based on the drogue status, we simpy add the <code>fill = drogue.status</code> in <code>aes()</code> part</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="plotting-in-r-with-ggplot2.html#cb279-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, </span>
<span id="cb279-2"><a href="plotting-in-r-with-ggplot2.html#cb279-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span></span>
<span id="cb279-3"><a href="plotting-in-r-with-ggplot2.html#cb279-3"></a><span class="st">  </span><span class="kw">geom_bar</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<p>You can flip the order of bar with <code>position = position_stack(reverse = TRUE)</code></p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="plotting-in-r-with-ggplot2.html#cb280-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, </span>
<span id="cb280-2"><a href="plotting-in-r-with-ggplot2.html#cb280-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span></span>
<span id="cb280-3"><a href="plotting-in-r-with-ggplot2.html#cb280-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_stack</span>(<span class="dt">reverse =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<p>Instead of stacking, you can dodge the bar with <code>position = position_dodge()</code> argument</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="plotting-in-r-with-ggplot2.html#cb281-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, </span>
<span id="cb281-2"><a href="plotting-in-r-with-ggplot2.html#cb281-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span></span>
<span id="cb281-3"><a href="plotting-in-r-with-ggplot2.html#cb281-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<p>To add a black stroke color of the bar, add the argument <code>col = "black"</code> inside the <code>geom_bar()</code></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="plotting-in-r-with-ggplot2.html#cb282-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, </span>
<span id="cb282-2"><a href="plotting-in-r-with-ggplot2.html#cb282-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span></span>
<span id="cb282-3"><a href="plotting-in-r-with-ggplot2.html#cb282-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
<p>And to specify the width of the bar you specify a value in <code>width</code> argument in <code>geom_bar()</code></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="plotting-in-r-with-ggplot2.html#cb283-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.drouge, </span>
<span id="cb283-2"><a href="plotting-in-r-with-ggplot2.html#cb283-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">fill =</span> drogue.status))<span class="op">+</span></span>
<span id="cb283-3"><a href="plotting-in-r-with-ggplot2.html#cb283-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">width =</span> <span class="fl">.75</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
<p>Sometimes you want to map bar with different colors for negative and positive values. For this case we will use the sea surface temperature from drifter observation and create a new variable called anomaly—indicate the temperature value above (positive value) and below (negative) the climatological mean. The code for computing anomaly is;</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="plotting-in-r-with-ggplot2.html#cb284-1"></a>sst.anomaly =<span class="st"> </span>drifter_confluence <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb284-2"><a href="plotting-in-r-with-ggplot2.html#cb284-2"></a><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb284-3"><a href="plotting-in-r-with-ggplot2.html#cb284-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">average =</span> <span class="kw">mean</span>(sst, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb284-4"><a href="plotting-in-r-with-ggplot2.html#cb284-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">anomaly =</span> average <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(average), </span>
<span id="cb284-5"><a href="plotting-in-r-with-ggplot2.html#cb284-5"></a>         <span class="dt">anomaly.status =</span> <span class="kw">if_else</span>(anomaly <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> , <span class="st">&quot;Above&quot;</span>, <span class="st">&quot;Below&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb284-6"><a href="plotting-in-r-with-ggplot2.html#cb284-6"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">&gt;</span><span class="st"> </span><span class="dv">1996</span>)</span></code></pre></div>
<p>once we have computed the anomaly of sea surface temperature for each year, we can plot the withe <code>geom_col()</code> and specify <code>x = year</code>, and <code>y = anomaly</code> and <code>fill = anomaly.status</code>. We also need to specify the <code>position == "identity"</code> to prevent notification message of poor defined stacking for bar with negative values.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="plotting-in-r-with-ggplot2.html#cb285-1"></a>  <span class="kw">ggplot</span>(<span class="dt">data =</span>sst.anomaly,</span>
<span id="cb285-2"><a href="plotting-in-r-with-ggplot2.html#cb285-2"></a>         <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> anomaly, <span class="dt">fill =</span> anomaly.status)) <span class="op">+</span></span>
<span id="cb285-3"><a href="plotting-in-r-with-ggplot2.html#cb285-3"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">.8</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
<p>Although the plot looks good but sometimes we may wish to reverse the filled color.We can reorder the color with the <code>scale</code> layer. Because the variable used to fill the bar is categorical, the appropriate scale is <code>scale_fill_discrete()</code> and you specify the limits with <code>limits =  c("Below", "Above")</code>. The legend is this plot is not important and we can remove from th plot with <code>guides(fill = FALSE)</code></p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="plotting-in-r-with-ggplot2.html#cb286-1"></a>  <span class="kw">ggplot</span>(<span class="dt">data =</span>sst.anomaly,</span>
<span id="cb286-2"><a href="plotting-in-r-with-ggplot2.html#cb286-2"></a>         <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> anomaly, <span class="dt">fill =</span> anomaly.status)) <span class="op">+</span></span>
<span id="cb286-3"><a href="plotting-in-r-with-ggplot2.html#cb286-3"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">.8</span>)<span class="op">+</span></span>
<span id="cb286-4"><a href="plotting-in-r-with-ggplot2.html#cb286-4"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Below&quot;</span>, <span class="st">&quot;Above&quot;</span>))<span class="op">+</span></span>
<span id="cb286-5"><a href="plotting-in-r-with-ggplot2.html#cb286-5"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-186-1.png" width="672" />
The red</p>
</div>
</div>
<div id="barplot-for-values" class="section level3" number="7.7.4">
<h3><span class="header-section-number">7.7.4</span> barplot for values</h3>
<p>We have seen how to make barplot that show the count with <code>geom_bar()</code>. You can also use the barplot to show the values with the <code>geom_col()</code> function and specify what variables you want on the <code>x</code> and <code>y</code> axis. For instance, we want to show how surface current varies over twelve months. Because the <code>geom_col()</code> requires summarized statistics, we need to compute the average current speed for each month. The chunk below highlight how to compute the mean, maximum, minimum and standard deviation of surface current velocity for each month.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="plotting-in-r-with-ggplot2.html#cb287-1"></a>current.speed.monthly =<span class="st"> </span>drifter.drouge <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb287-2"><a href="plotting-in-r-with-ggplot2.html#cb287-2"></a><span class="st">  </span><span class="kw">filter</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">speed =</span> <span class="kw">sqrt</span>(u<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>v<span class="op">^</span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb287-3"><a href="plotting-in-r-with-ggplot2.html#cb287-3"></a><span class="st">  </span><span class="kw">group_by</span>(month, drogue.status) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb287-4"><a href="plotting-in-r-with-ggplot2.html#cb287-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">speed_min =</span> <span class="kw">min</span>(speed, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb287-5"><a href="plotting-in-r-with-ggplot2.html#cb287-5"></a>            <span class="dt">speed_mean =</span> <span class="kw">mean</span>(speed, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb287-6"><a href="plotting-in-r-with-ggplot2.html#cb287-6"></a>            <span class="dt">speed_max =</span> <span class="kw">max</span>(speed, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </span>
<span id="cb287-7"><a href="plotting-in-r-with-ggplot2.html#cb287-7"></a>            <span class="dt">speed_sd =</span> <span class="kw">sd</span>(speed, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb287-8"><a href="plotting-in-r-with-ggplot2.html#cb287-8"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<p>Once we have computed the statistics, we can use them to make barplot. Note that unlike the <code>geom_bar()</code> that need only the <code>x</code> variable, <code>geom_col()</code> requires <code>x</code> and <code>y</code> variables specified. For illustration, we specified the <code>x = month</code>, and <code>y = speed_mean</code> in the <code>aes()</code> to make a barplot that show the monthly monthly mean surface current.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="plotting-in-r-with-ggplot2.html#cb288-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> current.speed.monthly, </span>
<span id="cb288-2"><a href="plotting-in-r-with-ggplot2.html#cb288-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month,<span class="dt">y =</span> speed_mean))<span class="op">+</span></span>
<span id="cb288-3"><a href="plotting-in-r-with-ggplot2.html#cb288-3"></a><span class="st">  </span><span class="kw">geom_col</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-188-1.png" width="672" /></p>
<p>Although ggplot2 allows to stack the barplot that present values, although they seems appealing, you must avoid making such kind of plot, because they tend to mislead and difficult to distinguish betwen the groups.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="plotting-in-r-with-ggplot2.html#cb289-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> current.speed.monthly, </span>
<span id="cb289-2"><a href="plotting-in-r-with-ggplot2.html#cb289-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month,<span class="dt">y =</span> speed_max, <span class="dt">fill =</span> drogue.status))<span class="op">+</span></span>
<span id="cb289-3"><a href="plotting-in-r-with-ggplot2.html#cb289-3"></a><span class="st">  </span><span class="kw">geom_col</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-189-1.png" width="672" /></p>
<p>The appropriate way if you want to compare two or more groups with <code>geom_col()</code>, you better doge the bar instead of stacking them. This makes easier to compare. For instance, in the case here, its cleary to see months of which drifter with lost drogues move relatively faster than those with droguue.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="plotting-in-r-with-ggplot2.html#cb290-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> current.speed.monthly, </span>
<span id="cb290-2"><a href="plotting-in-r-with-ggplot2.html#cb290-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> month,<span class="dt">y =</span> speed_max, <span class="dt">fill =</span> drogue.status))<span class="op">+</span></span>
<span id="cb290-3"><a href="plotting-in-r-with-ggplot2.html#cb290-3"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
<p>Note: the basic barplot that present count or frequency has one categorical variable on the x axis and you can make with <code>geom_bar()</code>And the barplot that present the values for instance the average of the variable has one categorical variable on the <code>x</code> axis and continuos variable on the <code>y</code> axis and you create them with <code>geom_col()</code> function. You can make a grouped bar plot by mapping that variable to <code>fill</code>, which represent the fill color of the bars. Like the variables mapped to the x axis, variables that are specified to the fill color of bars must be categorical instead of continuous.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="plotting-in-r-with-ggplot2.html#cb291-1"></a>drifter.interest =<span class="st"> </span>drifter_confluence <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(), <span class="dt">begin =</span> dplyr<span class="op">::</span><span class="kw">first</span>(date), <span class="dt">end =</span> dplyr<span class="op">::</span><span class="kw">last</span>(date), <span class="dt">period =</span> lubridate<span class="op">::</span><span class="kw">interval</span>(<span class="dt">start =</span> begin, <span class="dt">end =</span> end, <span class="dt">tzone =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>lubridate<span class="op">::</span><span class="kw">as.duration</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.numeric</span>(<span class="st">&quot;hours&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(period <span class="op">&gt;</span><span class="dv">1000</span>)</span>
<span id="cb291-2"><a href="plotting-in-r-with-ggplot2.html#cb291-2"></a></span>
<span id="cb291-3"><a href="plotting-in-r-with-ggplot2.html#cb291-3"></a>drifter.interest.point =<span class="st"> </span>drifter.interest <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(drifter_confluence, <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">id.drifter =</span> <span class="kw">paste</span>(<span class="st">&quot;ids&quot;</span>, id, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb291-4"><a href="plotting-in-r-with-ggplot2.html#cb291-4"></a></span>
<span id="cb291-5"><a href="plotting-in-r-with-ggplot2.html#cb291-5"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> drifter.interest.point , <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">col =</span> id.drifter))<span class="op">+</span><span class="kw">geom_path</span>()<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb291-6"><a href="plotting-in-r-with-ggplot2.html#cb291-6"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_x_longitude</span>(<span class="dt">ticks =</span> <span class="fl">.3</span>)<span class="op">+</span></span>
<span id="cb291-7"><a href="plotting-in-r-with-ggplot2.html#cb291-7"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">scale_y_latitude</span>(<span class="dt">ticks =</span> <span class="fl">.4</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-191-1.png" width="672" /></p>
</div>
</div>
<div id="advanced-plots" class="section level2" number="7.8">
<h2><span class="header-section-number">7.8</span> Advanced plots</h2>
<p><strong>ggplot2</strong> with its add-in packages provides extensive capabilities for visualizing your data. You can produce 2D plots, 3D plots, and animations; you can view images; and you can create histograms, contour and surfaces plots, and other graphical representations of your data.</p>
<p>its’s fun to explore pattern over time with linegraphy. Time is so embedded in our day–to–day life tha so many aspects of visualizing temporal data are fairly intuitive. You understand thing changing and evolving—the hard part is figuring out by how much is changing and look for that change in the graph. It’s easy to glance over some lines on a plot and say something is increasing, which is good as that is the core function of visualization to help you see the patterns. But, because of averaging, we sometimes miss some subtle changes that hidden when we lumped data together.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="plotting-in-r-with-ggplot2.html#cb292-1"></a>chl.tb <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb292-2"><a href="plotting-in-r-with-ggplot2.html#cb292-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> lubridate<span class="op">::</span><span class="kw">month</span>(date), <span class="dt">year =</span> lubridate<span class="op">::</span><span class="kw">year</span>(date)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb292-3"><a href="plotting-in-r-with-ggplot2.html#cb292-3"></a><span class="st">  </span><span class="kw">group_by</span>(year, month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb292-4"><a href="plotting-in-r-with-ggplot2.html#cb292-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">chl =</span> <span class="kw">mean</span>(chl, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))<span class="op">%&gt;%</span></span>
<span id="cb292-5"><a href="plotting-in-r-with-ggplot2.html#cb292-5"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2019</span>) <span class="op">%$%</span></span>
<span id="cb292-6"><a href="plotting-in-r-with-ggplot2.html#cb292-6"></a><span class="st">  </span><span class="kw">interpolate2</span>(<span class="dt">x =</span> year , <span class="dt">y =</span> month, <span class="dt">z =</span> chl, <span class="dt">n =</span> <span class="dv">16</span>)<span class="op">%&gt;%</span></span>
<span id="cb292-7"><a href="plotting-in-r-with-ggplot2.html#cb292-7"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">year =</span> x, <span class="dt">month =</span> y, <span class="dt">chl =</span> z) <span class="op">%&gt;%</span></span>
<span id="cb292-8"><a href="plotting-in-r-with-ggplot2.html#cb292-8"></a><span class="st">  </span><span class="kw">filter</span>(chl <span class="op">&lt;</span><span class="st"> </span><span class="fl">.4</span>)<span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb292-9"><a href="plotting-in-r-with-ggplot2.html#cb292-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span>year, <span class="dt">y =</span> month, <span class="dt">z =</span> chl))<span class="op">+</span></span>
<span id="cb292-10"><a href="plotting-in-r-with-ggplot2.html#cb292-10"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb292-11"><a href="plotting-in-r-with-ggplot2.html#cb292-11"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colorsJet</span>(<span class="dt">n =</span> <span class="dv">120</span>))<span class="op">+</span></span>
<span id="cb292-12"><a href="plotting-in-r-with-ggplot2.html#cb292-12"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, </span>
<span id="cb292-13"><a href="plotting-in-r-with-ggplot2.html#cb292-13"></a>                  <span class="dt">label =</span> <span class="kw">seq</span>(lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">010119</span>), </span>
<span id="cb292-14"><a href="plotting-in-r-with-ggplot2.html#cb292-14"></a>                              lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">311219</span>), <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb292-15"><a href="plotting-in-r-with-ggplot2.html#cb292-15"></a><span class="st">                    </span>lubridate<span class="op">::</span><span class="kw">month</span>(<span class="dt">abbr =</span> <span class="ot">TRUE</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>))<span class="op">+</span></span>
<span id="cb292-16"><a href="plotting-in-r-with-ggplot2.html#cb292-16"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2002</span>,<span class="dv">2017</span>,<span class="dv">2</span>))<span class="op">+</span></span>
<span id="cb292-17"><a href="plotting-in-r-with-ggplot2.html#cb292-17"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb292-18"><a href="plotting-in-r-with-ggplot2.html#cb292-18"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></span>
<span id="cb292-19"><a href="plotting-in-r-with-ggplot2.html#cb292-19"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">%+%</span></span>
<span id="cb292-20"><a href="plotting-in-r-with-ggplot2.html#cb292-20"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="op">+</span></span>
<span id="cb292-21"><a href="plotting-in-r-with-ggplot2.html#cb292-21"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb292-22"><a href="plotting-in-r-with-ggplot2.html#cb292-22"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), </span>
<span id="cb292-23"><a href="plotting-in-r-with-ggplot2.html#cb292-23"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,</span>
<span id="cb292-24"><a href="plotting-in-r-with-ggplot2.html#cb292-24"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb292-25"><a href="plotting-in-r-with-ggplot2.html#cb292-25"></a>                               <span class="dt">title =</span> <span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concetration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}))))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
<p>I used <code>oce::oce.colorsJet(120)</code> and specify 120 color gradient to obtain color scheme similar to the Matlab Jet scheme. It widely used for maps but works great for general visualization like heatmaps.</p>
<div id="facets" class="section level3" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> Facets</h3>
<p>Sometimes you may wish to split your plot into facets—subplots that each display one subset of the data. Faceting is used when you wish make subplots from categorical variables. It creates multiple copies of the same type of plot with matching x and y axes. There is a <code>scale()</code>, which allows you to adjust the x and y axes according to groups in the categorical variable.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="plotting-in-r-with-ggplot2.html#cb293-1"></a><span class="co">## list files from the working directory</span></span>
<span id="cb293-2"><a href="plotting-in-r-with-ggplot2.html#cb293-2"></a></span>
<span id="cb293-3"><a href="plotting-in-r-with-ggplot2.html#cb293-3"></a>tafiri =<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data/&quot;</span>,<span class="dt">pattern =</span> <span class="st">&quot;tafiri_&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</span>
<span id="cb293-4"><a href="plotting-in-r-with-ggplot2.html#cb293-4"></a></span>
<span id="cb293-5"><a href="plotting-in-r-with-ggplot2.html#cb293-5"></a><span class="co">## make a vector of variables. The order must be consistency with the files order in </span></span>
<span id="cb293-6"><a href="plotting-in-r-with-ggplot2.html#cb293-6"></a>var =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chl&quot;</span>, <span class="st">&quot;pp&quot;</span>, <span class="st">&quot;sst&quot;</span>)</span>
<span id="cb293-7"><a href="plotting-in-r-with-ggplot2.html#cb293-7"></a><span class="co">## make a vector of site. The order must be consistency with the sheets in files</span></span>
<span id="cb293-8"><a href="plotting-in-r-with-ggplot2.html#cb293-8"></a>sites =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Pemba&quot;</span>, <span class="st">&quot;Zanzibar&quot;</span>, <span class="st">&quot;Mafia&quot;</span>, <span class="st">&quot;EEZ&quot;</span>)</span>
<span id="cb293-9"><a href="plotting-in-r-with-ggplot2.html#cb293-9"></a></span>
<span id="cb293-10"><a href="plotting-in-r-with-ggplot2.html#cb293-10"></a><span class="co">## preallocate an empty object</span></span>
<span id="cb293-11"><a href="plotting-in-r-with-ggplot2.html#cb293-11"></a>tafiri.data =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb293-12"><a href="plotting-in-r-with-ggplot2.html#cb293-12"></a></span>
<span id="cb293-13"><a href="plotting-in-r-with-ggplot2.html#cb293-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(var)){</span>
<span id="cb293-14"><a href="plotting-in-r-with-ggplot2.html#cb293-14"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(sites)){</span>
<span id="cb293-15"><a href="plotting-in-r-with-ggplot2.html#cb293-15"></a>    </span>
<span id="cb293-16"><a href="plotting-in-r-with-ggplot2.html#cb293-16"></a>  data =<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_excel</span>(<span class="dt">path =</span> tafiri[i], <span class="dt">sheet =</span> j)<span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb293-17"><a href="plotting-in-r-with-ggplot2.html#cb293-17"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">date =</span> <span class="dv">1</span>, <span class="dt">year =</span> <span class="dv">2</span>, <span class="dt">value =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb293-18"><a href="plotting-in-r-with-ggplot2.html#cb293-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">month =</span> lubridate<span class="op">::</span><span class="kw">month</span>(date), </span>
<span id="cb293-19"><a href="plotting-in-r-with-ggplot2.html#cb293-19"></a>         <span class="dt">day =</span> <span class="dv">15</span>,</span>
<span id="cb293-20"><a href="plotting-in-r-with-ggplot2.html#cb293-20"></a>         <span class="dt">site =</span> sites[j], </span>
<span id="cb293-21"><a href="plotting-in-r-with-ggplot2.html#cb293-21"></a>         <span class="dt">variable =</span> var[i],</span>
<span id="cb293-22"><a href="plotting-in-r-with-ggplot2.html#cb293-22"></a>         <span class="dt">date =</span> lubridate<span class="op">::</span><span class="kw">make_date</span>(<span class="dt">year =</span> year, <span class="dt">month =</span> month, <span class="dt">day =</span> day)) <span class="op">%&gt;%</span></span>
<span id="cb293-23"><a href="plotting-in-r-with-ggplot2.html#cb293-23"></a><span class="st">  </span><span class="kw">arrange</span>(date)</span>
<span id="cb293-24"><a href="plotting-in-r-with-ggplot2.html#cb293-24"></a>    </span>
<span id="cb293-25"><a href="plotting-in-r-with-ggplot2.html#cb293-25"></a><span class="co">## stitch processed data frame from each sheet    </span></span>
<span id="cb293-26"><a href="plotting-in-r-with-ggplot2.html#cb293-26"></a>tafiri.data =<span class="st"> </span>tafiri.data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb293-27"><a href="plotting-in-r-with-ggplot2.html#cb293-27"></a><span class="st">  </span><span class="kw">bind_rows</span>(data)</span>
<span id="cb293-28"><a href="plotting-in-r-with-ggplot2.html#cb293-28"></a> </span>
<span id="cb293-29"><a href="plotting-in-r-with-ggplot2.html#cb293-29"></a>  }</span>
<span id="cb293-30"><a href="plotting-in-r-with-ggplot2.html#cb293-30"></a>}</span></code></pre></div>
<p>For instance, suppose we’re interested in looking at how the hovmoller of monthly primary productivity varies over time across the four stations, We split this heatmaps by the four stations. We achieve this by simply adding <code>facet_wrap(~site, nrow = 2)</code> layer;</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="plotting-in-r-with-ggplot2.html#cb294-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb294-2"><a href="plotting-in-r-with-ggplot2.html#cb294-2"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> tafiri.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;pp&quot;</span>),</span>
<span id="cb294-3"><a href="plotting-in-r-with-ggplot2.html#cb294-3"></a>                          <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> month, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb294-4"><a href="plotting-in-r-with-ggplot2.html#cb294-4"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb294-5"><a href="plotting-in-r-with-ggplot2.html#cb294-5"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">11</span>,<span class="dv">2</span>), <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;February&quot;</span>, <span class="st">&quot;April&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="st">&quot;August&quot;</span>, <span class="st">&quot;October&quot;</span>))<span class="op">+</span></span>
<span id="cb294-6"><a href="plotting-in-r-with-ggplot2.html#cb294-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="op">+</span></span>
<span id="cb294-7"><a href="plotting-in-r-with-ggplot2.html#cb294-7"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb294-8"><a href="plotting-in-r-with-ggplot2.html#cb294-8"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+replace%</span></span>
<span id="cb294-9"><a href="plotting-in-r-with-ggplot2.html#cb294-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb294-10"><a href="plotting-in-r-with-ggplot2.html#cb294-10"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}),</span>
<span id="cb294-11"><a href="plotting-in-r-with-ggplot2.html#cb294-11"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb294-12"><a href="plotting-in-r-with-ggplot2.html#cb294-12"></a>                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb294-13"><a href="plotting-in-r-with-ggplot2.html#cb294-13"></a>                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb294-14"><a href="plotting-in-r-with-ggplot2.html#cb294-14"></a>                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, </span>
<span id="cb294-15"><a href="plotting-in-r-with-ggplot2.html#cb294-15"></a>                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb294-16"><a href="plotting-in-r-with-ggplot2.html#cb294-16"></a>                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span></span>
<span id="cb294-17"><a href="plotting-in-r-with-ggplot2.html#cb294-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></span>
<span id="cb294-18"><a href="plotting-in-r-with-ggplot2.html#cb294-18"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb294-19"><a href="plotting-in-r-with-ggplot2.html#cb294-19"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), </span>
<span id="cb294-20"><a href="plotting-in-r-with-ggplot2.html#cb294-20"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,</span>
<span id="cb294-21"><a href="plotting-in-r-with-ggplot2.html#cb294-21"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb294-22"><a href="plotting-in-r-with-ggplot2.html#cb294-22"></a>                               <span class="dt">title =</span> <span class="kw">expression</span>(Primary<span class="op">~</span>Productivity<span class="op">~</span>(Cm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}<span class="op">~</span>yr<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}))))<span class="op">+</span></span>
<span id="cb294-23"><a href="plotting-in-r-with-ggplot2.html#cb294-23"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>site, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-194-1.png" width="672" />
Note the use of the tilde <code>~</code> before the <code>site</code> in <code>facet_wrap()</code>. The tilde is required when you want specify the variable that will be used to split the plots into subplots. We can add other arguments in the <code>facet_wrap()</code> function. Let say we want our plot to be in one rows and four columns by simply adding the argument <code>nrow = 1</code></p>
</div>
<div id="sea-surface-temperature" class="section level3" number="7.8.2">
<h3><span class="header-section-number">7.8.2</span> Sea Surface Temperature</h3>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="plotting-in-r-with-ggplot2.html#cb295-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb295-2"><a href="plotting-in-r-with-ggplot2.html#cb295-2"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> tafiri.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;sst&quot;</span>),</span>
<span id="cb295-3"><a href="plotting-in-r-with-ggplot2.html#cb295-3"></a>                          <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> month, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb295-4"><a href="plotting-in-r-with-ggplot2.html#cb295-4"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb295-5"><a href="plotting-in-r-with-ggplot2.html#cb295-5"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">11</span>,<span class="dv">2</span>), <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;February&quot;</span>, <span class="st">&quot;April&quot;</span>, <span class="st">&quot;June&quot;</span>, <span class="st">&quot;August&quot;</span>, <span class="st">&quot;October&quot;</span>))<span class="op">+</span></span>
<span id="cb295-6"><a href="plotting-in-r-with-ggplot2.html#cb295-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="op">+</span></span>
<span id="cb295-7"><a href="plotting-in-r-with-ggplot2.html#cb295-7"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>))<span class="op">+</span></span>
<span id="cb295-8"><a href="plotting-in-r-with-ggplot2.html#cb295-8"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+replace%</span></span>
<span id="cb295-9"><a href="plotting-in-r-with-ggplot2.html#cb295-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="dv">1</span>), <span class="dt">axis.title =</span> <span class="kw">element_blank</span>())<span class="op">+</span></span>
<span id="cb295-10"><a href="plotting-in-r-with-ggplot2.html#cb295-10"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}),</span>
<span id="cb295-11"><a href="plotting-in-r-with-ggplot2.html#cb295-11"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb295-12"><a href="plotting-in-r-with-ggplot2.html#cb295-12"></a>                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb295-13"><a href="plotting-in-r-with-ggplot2.html#cb295-13"></a>                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb295-14"><a href="plotting-in-r-with-ggplot2.html#cb295-14"></a>                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, </span>
<span id="cb295-15"><a href="plotting-in-r-with-ggplot2.html#cb295-15"></a>                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb295-16"><a href="plotting-in-r-with-ggplot2.html#cb295-16"></a>                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span></span>
<span id="cb295-17"><a href="plotting-in-r-with-ggplot2.html#cb295-17"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">10</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb295-18"><a href="plotting-in-r-with-ggplot2.html#cb295-18"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), </span>
<span id="cb295-19"><a href="plotting-in-r-with-ggplot2.html#cb295-19"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,</span>
<span id="cb295-20"><a href="plotting-in-r-with-ggplot2.html#cb295-20"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb295-21"><a href="plotting-in-r-with-ggplot2.html#cb295-21"></a>                               <span class="dt">title =</span> <span class="kw">expression</span>(Sea<span class="op">~</span>Surface<span class="op">~</span>Temperature<span class="op">~</span>(degree<span class="op">*</span>C))))<span class="op">+</span></span>
<span id="cb295-22"><a href="plotting-in-r-with-ggplot2.html#cb295-22"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>site, <span class="dt">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-195-1.png" width="960" /></p>
</div>
<div id="subplot" class="section level3" number="7.8.3">
<h3><span class="header-section-number">7.8.3</span> Subplot</h3>
<p>There are occasions when it is convenient to display several plots side-by-side. In these instances,
you will want to use the <strong>cowplot</strong> package. we first create <strong>ggplot2</strong> object of Primary productivity for the channels we are interested: for Mafia Channel we assign the name <code>mafia.pp</code> and for Zanzibar Channel <code>zanzibar.pp</code>. The chunk below show how to create the these object.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="plotting-in-r-with-ggplot2.html#cb296-1"></a>mafia.pp =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb296-2"><a href="plotting-in-r-with-ggplot2.html#cb296-2"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> tafiri.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;pp&quot;</span> <span class="op">&amp;</span><span class="st"> </span>site <span class="op">==</span><span class="st"> &quot;Mafia&quot;</span>),</span>
<span id="cb296-3"><a href="plotting-in-r-with-ggplot2.html#cb296-3"></a>                          <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> month, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb296-4"><a href="plotting-in-r-with-ggplot2.html#cb296-4"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb296-5"><a href="plotting-in-r-with-ggplot2.html#cb296-5"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">label =</span> <span class="kw">seq</span>(lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">010119</span>), </span>
<span id="cb296-6"><a href="plotting-in-r-with-ggplot2.html#cb296-6"></a>                                            lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">311219</span>), <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb296-7"><a href="plotting-in-r-with-ggplot2.html#cb296-7"></a><span class="st">                    </span>lubridate<span class="op">::</span><span class="kw">month</span>(<span class="dt">abbr =</span> <span class="ot">TRUE</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb296-8"><a href="plotting-in-r-with-ggplot2.html#cb296-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="op">+</span></span>
<span id="cb296-9"><a href="plotting-in-r-with-ggplot2.html#cb296-9"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>),<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">1700</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb296-10"><a href="plotting-in-r-with-ggplot2.html#cb296-10"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+replace%</span></span>
<span id="cb296-11"><a href="plotting-in-r-with-ggplot2.html#cb296-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>), <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></span>
<span id="cb296-12"><a href="plotting-in-r-with-ggplot2.html#cb296-12"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}),</span>
<span id="cb296-13"><a href="plotting-in-r-with-ggplot2.html#cb296-13"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb296-14"><a href="plotting-in-r-with-ggplot2.html#cb296-14"></a>                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb296-15"><a href="plotting-in-r-with-ggplot2.html#cb296-15"></a>                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb296-16"><a href="plotting-in-r-with-ggplot2.html#cb296-16"></a>                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, </span>
<span id="cb296-17"><a href="plotting-in-r-with-ggplot2.html#cb296-17"></a>                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb296-18"><a href="plotting-in-r-with-ggplot2.html#cb296-18"></a>                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span></span>
<span id="cb296-19"><a href="plotting-in-r-with-ggplot2.html#cb296-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></span>
<span id="cb296-20"><a href="plotting-in-r-with-ggplot2.html#cb296-20"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb296-21"><a href="plotting-in-r-with-ggplot2.html#cb296-21"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), </span>
<span id="cb296-22"><a href="plotting-in-r-with-ggplot2.html#cb296-22"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,</span>
<span id="cb296-23"><a href="plotting-in-r-with-ggplot2.html#cb296-23"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb296-24"><a href="plotting-in-r-with-ggplot2.html#cb296-24"></a>                               <span class="dt">title =</span> <span class="kw">expression</span>(Primary<span class="op">~</span>Productivity<span class="op">~</span>(Cm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}<span class="op">~</span>yr<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}))))</span>
<span id="cb296-25"><a href="plotting-in-r-with-ggplot2.html#cb296-25"></a></span>
<span id="cb296-26"><a href="plotting-in-r-with-ggplot2.html#cb296-26"></a>zanzibar.pp =<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb296-27"><a href="plotting-in-r-with-ggplot2.html#cb296-27"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> tafiri.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;pp&quot;</span> <span class="op">&amp;</span><span class="st"> </span>site <span class="op">==</span><span class="st"> &quot;Zanzibar&quot;</span>),</span>
<span id="cb296-28"><a href="plotting-in-r-with-ggplot2.html#cb296-28"></a>                          <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> month, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb296-29"><a href="plotting-in-r-with-ggplot2.html#cb296-29"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb296-30"><a href="plotting-in-r-with-ggplot2.html#cb296-30"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">label =</span> <span class="kw">seq</span>(lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">010119</span>), </span>
<span id="cb296-31"><a href="plotting-in-r-with-ggplot2.html#cb296-31"></a>                                            lubridate<span class="op">::</span><span class="kw">dmy</span>(<span class="dv">311219</span>), <span class="dt">by =</span> <span class="st">&quot;month&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb296-32"><a href="plotting-in-r-with-ggplot2.html#cb296-32"></a><span class="st">                    </span>lubridate<span class="op">::</span><span class="kw">month</span>(<span class="dt">abbr =</span> <span class="ot">TRUE</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>))<span class="op">+</span><span class="st">  </span></span>
<span id="cb296-33"><a href="plotting-in-r-with-ggplot2.html#cb296-33"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="op">+</span></span>
<span id="cb296-34"><a href="plotting-in-r-with-ggplot2.html#cb296-34"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colors =</span> oce<span class="op">::</span><span class="kw">oce.colors9A</span>(<span class="dv">120</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">300</span>,<span class="dv">1700</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb296-35"><a href="plotting-in-r-with-ggplot2.html#cb296-35"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">%+replace%</span></span>
<span id="cb296-36"><a href="plotting-in-r-with-ggplot2.html#cb296-36"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">colour =</span> <span class="dv">1</span>), <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>())<span class="op">+</span></span>
<span id="cb296-37"><a href="plotting-in-r-with-ggplot2.html#cb296-37"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="kw">expression</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}),</span>
<span id="cb296-38"><a href="plotting-in-r-with-ggplot2.html#cb296-38"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb296-39"><a href="plotting-in-r-with-ggplot2.html#cb296-39"></a>                               <span class="dt">title.hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb296-40"><a href="plotting-in-r-with-ggplot2.html#cb296-40"></a>                               <span class="dt">direction =</span> <span class="st">&quot;vertical&quot;</span>,</span>
<span id="cb296-41"><a href="plotting-in-r-with-ggplot2.html#cb296-41"></a>                               <span class="dt">reverse =</span> <span class="ot">FALSE</span>, </span>
<span id="cb296-42"><a href="plotting-in-r-with-ggplot2.html#cb296-42"></a>                               <span class="dt">barwidth =</span> <span class="kw">unit</span>(.<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb296-43"><a href="plotting-in-r-with-ggplot2.html#cb296-43"></a>                               <span class="dt">barheight =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;cm&quot;</span>)))<span class="op">+</span></span>
<span id="cb296-44"><a href="plotting-in-r-with-ggplot2.html#cb296-44"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></span>
<span id="cb296-45"><a href="plotting-in-r-with-ggplot2.html#cb296-45"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">raster =</span> <span class="ot">FALSE</span>, <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb296-46"><a href="plotting-in-r-with-ggplot2.html#cb296-46"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">13</span>), </span>
<span id="cb296-47"><a href="plotting-in-r-with-ggplot2.html#cb296-47"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">title.hjust =</span> <span class="fl">.5</span>,</span>
<span id="cb296-48"><a href="plotting-in-r-with-ggplot2.html#cb296-48"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>),</span>
<span id="cb296-49"><a href="plotting-in-r-with-ggplot2.html#cb296-49"></a>                               <span class="dt">title =</span> <span class="kw">expression</span>(Primary<span class="op">~</span>Productivity<span class="op">~</span>(Cm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}<span class="op">~</span>yr<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span>}))))</span></code></pre></div>
<p>Once we have the <strong>ggplot2</strong> objects, we can now combine them side by side with the <code>cowplot::plot_grid()</code> function.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="plotting-in-r-with-ggplot2.html#cb297-1"></a>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(mafia.pp, </span>
<span id="cb297-2"><a href="plotting-in-r-with-ggplot2.html#cb297-2"></a>                   zanzibar.pp, </span>
<span id="cb297-3"><a href="plotting-in-r-with-ggplot2.html#cb297-3"></a>                   <span class="dt">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb297-4"><a href="plotting-in-r-with-ggplot2.html#cb297-4"></a>                   <span class="dt">rel_widths =</span> <span class="kw">c</span>(.<span class="dv">8</span>,<span class="dv">1</span>), </span>
<span id="cb297-5"><a href="plotting-in-r-with-ggplot2.html#cb297-5"></a>                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Mafia&quot;</span>, <span class="st">&quot;Zanzibar&quot;</span>), </span>
<span id="cb297-6"><a href="plotting-in-r-with-ggplot2.html#cb297-6"></a>                   <span class="dt">label_x =</span> <span class="kw">c</span>(.<span class="dv">2</span>,.<span class="dv">001</span>), </span>
<span id="cb297-7"><a href="plotting-in-r-with-ggplot2.html#cb297-7"></a>                   <span class="dt">label_y =</span> <span class="fl">.98</span>, </span>
<span id="cb297-8"><a href="plotting-in-r-with-ggplot2.html#cb297-8"></a>                   <span class="dt">label_fontface =</span> <span class="st">&quot;plain&quot;</span>, </span>
<span id="cb297-9"><a href="plotting-in-r-with-ggplot2.html#cb297-9"></a>                   <span class="dt">label_size =</span> <span class="dv">12</span>)</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
<hr />
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="plotting-in-r-with-ggplot2.html#cb298-1"></a>profile =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(station <span class="op">==</span><span class="st"> &quot;st2&quot;</span>)</span>
<span id="cb298-2"><a href="plotting-in-r-with-ggplot2.html#cb298-2"></a></span>
<span id="cb298-3"><a href="plotting-in-r-with-ggplot2.html#cb298-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, </span>
<span id="cb298-4"><a href="plotting-in-r-with-ggplot2.html#cb298-4"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb298-5"><a href="plotting-in-r-with-ggplot2.html#cb298-5"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
<p>This produce a scatterplot shown in figure <a href="#fig:"><strong>??</strong></a>, which shows a strong correlation as the water depth increase the temperature decrease. Using the *grammar of graphics<strong> of the </strong>ggplot2**, the structure of the code used to make figure <a href="#fig:"><strong>??</strong></a> is defined by;</p>
<ul>
<li>Data: <code>profile</code>,</li>
<li>Aesthetic mapping: <code>temperature</code> values mapped to <code>x</code> position, pressure values mapped to <code>y</code> position</li>
<li>Geometry: <code>points</code></li>
</ul>
<p>In <strong>ggplot2</strong>, a plot is created with the <code>ggplot()</code> function, where data and aesthetic mappings are supplied as arguments, then layers are added on with <code>+</code>.</p>
</div>
</div>
<div id="colour" class="section level2" number="7.9">
<h2><span class="header-section-number">7.9</span> Colour</h2>
<p>The aesthetic component in <strong>ggplot2</strong> allows to add additional variables to a graph. For instance, We can map the colors of the points to the temperature variable to reveal the gradient of dissolved oxygen as a function of depth</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="plotting-in-r-with-ggplot2.html#cb299-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, </span>
<span id="cb299-2"><a href="plotting-in-r-with-ggplot2.html#cb299-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, </span>
<span id="cb299-3"><a href="plotting-in-r-with-ggplot2.html#cb299-3"></a>           <span class="dt">y =</span> pressure, </span>
<span id="cb299-4"><a href="plotting-in-r-with-ggplot2.html#cb299-4"></a>           <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb299-5"><a href="plotting-in-r-with-ggplot2.html#cb299-5"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
</div>
<div id="size" class="section level2" number="7.10">
<h2><span class="header-section-number">7.10</span> size</h2>
<p>The aesthetic component in <strong>ggplot2</strong> also allows to distinguish the plot with <code>size</code> of the variableh. For instance, We can map the size of the points to the temperature variable to reveal the gradient of dissolved oxygen as a function of depth</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="plotting-in-r-with-ggplot2.html#cb300-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> profile <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_frac</span>(.<span class="dv">25</span>), </span>
<span id="cb300-2"><a href="plotting-in-r-with-ggplot2.html#cb300-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen, <span class="dt">size =</span> oxygen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb300-3"><a href="plotting-in-r-with-ggplot2.html#cb300-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
<p>Although we can map the temperature profile as points, it is appropriate to plot this profile as line. We can replace the <code>geom_point()</code> with <code>geom_path()</code> for that purpose</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="plotting-in-r-with-ggplot2.html#cb301-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, </span>
<span id="cb301-2"><a href="plotting-in-r-with-ggplot2.html#cb301-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb301-3"><a href="plotting-in-r-with-ggplot2.html#cb301-3"></a><span class="st">  </span><span class="kw">geom_path</span>()</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
</div>
<div id="scaling" class="section level2" number="7.11">
<h2><span class="header-section-number">7.11</span> scaling</h2>
<p>A scale controls the mapping from data to aesthetic attributes. Its recommended to manipulate the scale for every aesthetic used on a plot. For example we want the x-axis labels to be position at the top and reverse the y-axis. The code can be writeen as;</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="plotting-in-r-with-ggplot2.html#cb302-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, </span>
<span id="cb302-2"><a href="plotting-in-r-with-ggplot2.html#cb302-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb302-3"><a href="plotting-in-r-with-ggplot2.html#cb302-3"></a><span class="st">  </span><span class="kw">geom_path</span>()<span class="op">+</span></span>
<span id="cb302-4"><a href="plotting-in-r-with-ggplot2.html#cb302-4"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">name =</span> <span class="st">&quot;Pressure [m]&quot;</span>, </span>
<span id="cb302-5"><a href="plotting-in-r-with-ggplot2.html#cb302-5"></a>                  <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="op">+</span></span>
<span id="cb302-6"><a href="plotting-in-r-with-ggplot2.html#cb302-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb302-7"><a href="plotting-in-r-with-ggplot2.html#cb302-7"></a>                     <span class="dt">name =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)), </span>
<span id="cb302-8"><a href="plotting-in-r-with-ggplot2.html#cb302-8"></a>                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-202-1.png" width="672" /></p>
<p>We might want to change the default color provided with <strong>ggplot2</strong> on the legend. Since we commanded the plot to display gradient colors from dissolved oxygen, We use the <code>scale_color_gradientn()</code> function. The code can be writeen as;</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="plotting-in-r-with-ggplot2.html#cb303-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, </span>
<span id="cb303-2"><a href="plotting-in-r-with-ggplot2.html#cb303-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb303-3"><a href="plotting-in-r-with-ggplot2.html#cb303-3"></a><span class="st">  </span><span class="kw">geom_path</span>()<span class="op">+</span></span>
<span id="cb303-4"><a href="plotting-in-r-with-ggplot2.html#cb303-4"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">name =</span> <span class="st">&quot;Pressure [m]&quot;</span>, </span>
<span id="cb303-5"><a href="plotting-in-r-with-ggplot2.html#cb303-5"></a>                  <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="op">+</span></span>
<span id="cb303-6"><a href="plotting-in-r-with-ggplot2.html#cb303-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb303-7"><a href="plotting-in-r-with-ggplot2.html#cb303-7"></a>                     <span class="dt">name =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)), </span>
<span id="cb303-8"><a href="plotting-in-r-with-ggplot2.html#cb303-8"></a>                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))<span class="op">+</span></span>
<span id="cb303-9"><a href="plotting-in-r-with-ggplot2.html#cb303-9"></a><span class="st">  </span><span class="kw">scale_color_gradientn</span>(<span class="dt">colours =</span> <span class="kw">rainbow</span>(<span class="dv">11</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rev</span>())</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
</div>
<div id="guides" class="section level2" number="7.12">
<h2><span class="header-section-number">7.12</span> Guides</h2>
<p>Context is provided by <em>guides</em>. A guide help a human reader to understand the meaning of the visual cues. For example</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="plotting-in-r-with-ggplot2.html#cb304-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> profile, </span>
<span id="cb304-2"><a href="plotting-in-r-with-ggplot2.html#cb304-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> pressure, <span class="dt">col =</span> oxygen)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb304-3"><a href="plotting-in-r-with-ggplot2.html#cb304-3"></a><span class="st">  </span><span class="kw">geom_path</span>()<span class="op">+</span></span>
<span id="cb304-4"><a href="plotting-in-r-with-ggplot2.html#cb304-4"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">name =</span> <span class="st">&quot;Pressure [m]&quot;</span>, </span>
<span id="cb304-5"><a href="plotting-in-r-with-ggplot2.html#cb304-5"></a>                  <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="op">+</span></span>
<span id="cb304-6"><a href="plotting-in-r-with-ggplot2.html#cb304-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>, </span>
<span id="cb304-7"><a href="plotting-in-r-with-ggplot2.html#cb304-7"></a>                     <span class="dt">name =</span> <span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)), </span>
<span id="cb304-8"><a href="plotting-in-r-with-ggplot2.html#cb304-8"></a>                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))<span class="op">+</span></span>
<span id="cb304-9"><a href="plotting-in-r-with-ggplot2.html#cb304-9"></a><span class="st">  </span><span class="kw">scale_color_gradientn</span>(<span class="dt">colours =</span> <span class="kw">rainbow</span>(<span class="dv">11</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rev</span>())<span class="op">+</span></span>
<span id="cb304-10"><a href="plotting-in-r-with-ggplot2.html#cb304-10"></a><span class="st">  </span><span class="co"># theme(legend.position = &quot;right&quot;) +</span></span>
<span id="cb304-11"><a href="plotting-in-r-with-ggplot2.html#cb304-11"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span> <span class="st">&quot;Dissolved oxygen (ml/L)&quot;</span>, </span>
<span id="cb304-12"><a href="plotting-in-r-with-ggplot2.html#cb304-12"></a>                                <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb304-13"><a href="plotting-in-r-with-ggplot2.html#cb304-13"></a>                                <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>),</span>
<span id="cb304-14"><a href="plotting-in-r-with-ggplot2.html#cb304-14"></a>                                <span class="dt">barheight =</span> <span class="dv">15</span>, </span>
<span id="cb304-15"><a href="plotting-in-r-with-ggplot2.html#cb304-15"></a>                                <span class="dt">barwidth =</span> <span class="fl">.95</span>, </span>
<span id="cb304-16"><a href="plotting-in-r-with-ggplot2.html#cb304-16"></a>                                <span class="dt">title.hjust =</span> <span class="fl">.5</span>, </span>
<span id="cb304-17"><a href="plotting-in-r-with-ggplot2.html#cb304-17"></a>                                <span class="dt">ticks.colour =</span> <span class="st">&quot;black&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-204-1.png" width="672" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="plotting-in-r-with-ggplot2.html#cb305-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(pressure <span class="op">==</span><span class="st"> </span><span class="dv">10</span>),</span>
<span id="cb305-2"><a href="plotting-in-r-with-ggplot2.html#cb305-2"></a>             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat))<span class="op">+</span></span>
<span id="cb305-3"><a href="plotting-in-r-with-ggplot2.html#cb305-3"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb305-4"><a href="plotting-in-r-with-ggplot2.html#cb305-4"></a><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> station))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
</div>
<div id="add-on-packages" class="section level2" number="7.13">
<h2><span class="header-section-number">7.13</span> Add-on packages</h2>
<p>The R community has developed packages that extend the capability of <strong>ggplot2</strong>. Some of the packages include:</p>
<ul>
<li><strong>metR</strong>: Provide addition tools for plotting filled contour, and label contour lines</li>
<li><strong>ggrepel</strong>: Contains tools for automatically position non-overlapping text labels</li>
<li><strong>ggspatial</strong>: Spatial Data Framework for <strong>ggplot2</strong></li>
<li><strong>RcolorBrewer</strong>: Contains color palettes for continuous and discrete plots</li>
<li><strong>cowplot</strong>: Contains addition themes and tools to combine <strong>ggplot2</strong> plots in one panel</li>
<li><strong>egg</strong>: Provide tools for plot aligning and symmetrised <strong>ggplot2</strong> plots</li>
<li><strong>oce</strong>: Provide color pallete for visualization of Oceanographic Data</li>
<li><strong>ggsn</strong>: Provide tools for mapping North symbols and scale bars on maps created with <strong>ggplot2</strong></li>
<li><strong>gganimate</strong>: convert static ggplot2 plots to animations</li>
<li><strong>ggformula</strong>: adds some additional plot options to <strong>ggplot2</strong></li>
<li><strong>sf</strong> : Add capabilities of <strong>ggplot2</strong> to map spatial data such as simple features</li>
<li><strong>ggthemes</strong>: contains extra themes, scales, and geoms, and functions for and related to ggplot2</li>
<li><strong>ggridges</strong>: extend the geom_density function by plotiing closed polygons insted of ridgelines</li>
</ul>
</div>
<div id="ggridges" class="section level2" number="7.14">
<h2><span class="header-section-number">7.14</span> ggridges</h2>
<p>Althoug ehe <strong>ggridges</strong> package provides <code>geom_ridgeline</code> and <code>geom_density_ridges</code>, we focus on the latter because it has ability to estimates data densities and then draws those using ridgelines.The geom <code>geom_density_ridges</code> calculates density estimates from the provided data and then plots those, using the ridgeline visualization.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="plotting-in-r-with-ggplot2.html#cb306-1"></a>ctd =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb306-2"><a href="plotting-in-r-with-ggplot2.html#cb306-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strata =</span> <span class="kw">cut</span>(<span class="dt">x =</span> pressure, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="dv">120</span>,<span class="dv">200</span>), </span>
<span id="cb306-3"><a href="plotting-in-r-with-ggplot2.html#cb306-3"></a>                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Upper&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Lower&quot;</span>)))</span>
<span id="cb306-4"><a href="plotting-in-r-with-ggplot2.html#cb306-4"></a></span>
<span id="cb306-5"><a href="plotting-in-r-with-ggplot2.html#cb306-5"></a>ctd.strata =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb306-6"><a href="plotting-in-r-with-ggplot2.html#cb306-6"></a><span class="st">  </span><span class="kw">group_by</span>(strata, pressure, lon,lat) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb306-7"><a href="plotting-in-r-with-ggplot2.html#cb306-7"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">temperature =</span> <span class="kw">mean</span>(temperature, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </span>
<span id="cb306-8"><a href="plotting-in-r-with-ggplot2.html#cb306-8"></a>            <span class="dt">salinity =</span> <span class="kw">mean</span>(salinity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </span>
<span id="cb306-9"><a href="plotting-in-r-with-ggplot2.html#cb306-9"></a>            <span class="dt">oxygen =</span> <span class="kw">mean</span>(oxygen, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </span>
<span id="cb306-10"><a href="plotting-in-r-with-ggplot2.html#cb306-10"></a>            <span class="dt">fluorescence =</span> <span class="kw">mean</span>(fluorescence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb306-11"><a href="plotting-in-r-with-ggplot2.html#cb306-11"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb306-12"><a href="plotting-in-r-with-ggplot2.html#cb306-12"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(strata))</span>
<span id="cb306-13"><a href="plotting-in-r-with-ggplot2.html#cb306-13"></a></span>
<span id="cb306-14"><a href="plotting-in-r-with-ggplot2.html#cb306-14"></a></span>
<span id="cb306-15"><a href="plotting-in-r-with-ggplot2.html#cb306-15"></a></span>
<span id="cb306-16"><a href="plotting-in-r-with-ggplot2.html#cb306-16"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata))<span class="op">+</span></span>
<span id="cb306-17"><a href="plotting-in-r-with-ggplot2.html#cb306-17"></a><span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>()<span class="op">+</span></span>
<span id="cb306-18"><a href="plotting-in-r-with-ggplot2.html#cb306-18"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-206-1.png" width="672" /></p>
<p>Trailing tails can be cut off using the <code>rel_min_height()</code> aesthetic. This aesthetic sets a percent cutoff relative to the highest point of any of the density curves. A value of 0.01 usually works well, but you may have to modify this parameter for different datasets.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="plotting-in-r-with-ggplot2.html#cb307-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata))<span class="op">+</span></span>
<span id="cb307-2"><a href="plotting-in-r-with-ggplot2.html#cb307-2"></a><span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="dt">rel_min_height =</span> <span class="fl">0.01</span>)<span class="op">+</span></span>
<span id="cb307-3"><a href="plotting-in-r-with-ggplot2.html#cb307-3"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="plotting-in-r-with-ggplot2.html#cb308-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata))<span class="op">+</span></span>
<span id="cb308-2"><a href="plotting-in-r-with-ggplot2.html#cb308-2"></a><span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="dt">scale =</span> <span class="dv">8</span>,<span class="dt">rel_min_height =</span> <span class="fl">0.01</span>)<span class="op">+</span><span class="co"># scale =80, substantial overlap</span></span>
<span id="cb308-3"><a href="plotting-in-r-with-ggplot2.html#cb308-3"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-208-1.png" width="672" /></p>
</div>
<div id="varying-fill-colors-along-the-x-axis" class="section level2" number="7.15">
<h2><span class="header-section-number">7.15</span> Varying fill colors along the x axis</h2>
<p>Sometimes we would like to have the area under a ridgeline not filled with a single solid color but rather with colors that vary in some form along the x axis. This effect can be achieved with the geoms geom_ridgeline_gradient and geom_density_ridges_gradient. Both geoms work just like geom_ridgeline and geom_density_ridges, except that they allow for varying fill colors. However, they do not allow for alpha transparency in the fill. For technical reasons, we can have changing fill colors or transparency but not both.</p>
<p>Here is a simple example of changing fill colors with geom_ridgeline_gradient:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="plotting-in-r-with-ggplot2.html#cb309-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata,  <span class="dt">fill =</span> strata))<span class="op">+</span></span>
<span id="cb309-2"><a href="plotting-in-r-with-ggplot2.html#cb309-2"></a><span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges_gradient</span>(<span class="dt">scale =</span> <span class="dv">5</span>,<span class="dt">rel_min_height =</span> <span class="fl">0.01</span>)<span class="op">+</span><span class="co"># scale =5, substantial overlap</span></span>
<span id="cb309-3"><a href="plotting-in-r-with-ggplot2.html#cb309-3"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="plotting-in-r-with-ggplot2.html#cb310-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> ctd.strata, <span class="kw">aes</span>(<span class="dt">x =</span> temperature, <span class="dt">y =</span> strata,  <span class="dt">fill =</span> ..x..))<span class="op">+</span></span>
<span id="cb310-2"><a href="plotting-in-r-with-ggplot2.html#cb310-2"></a><span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges_gradient</span>(<span class="dt">scale =</span> <span class="dv">5</span>,<span class="dt">rel_min_height =</span> <span class="fl">0.01</span>)<span class="op">+</span><span class="co"># scale =5, substantial overlap</span></span>
<span id="cb310-3"><a href="plotting-in-r-with-ggplot2.html#cb310-3"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="st">&quot;Lower&quot;</span>, <span class="st">&quot;Middle&quot;</span>, <span class="st">&quot;Upper&quot;</span>))<span class="op">+</span></span>
<span id="cb310-4"><a href="plotting-in-r-with-ggplot2.html#cb310-4"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oce.colorsTemperature</span>(<span class="dv">120</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">14</span>,<span class="dv">26</span>,<span class="dv">2</span>))<span class="op">+</span></span>
<span id="cb310-5"><a href="plotting-in-r-with-ggplot2.html#cb310-5"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Temperature<span class="op">~</span><span class="er">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb310-6"><a href="plotting-in-r-with-ggplot2.html#cb310-6"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb310-7"><a href="plotting-in-r-with-ggplot2.html#cb310-7"></a>                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">TRUE</span>,</span>
<span id="cb310-8"><a href="plotting-in-r-with-ggplot2.html#cb310-8"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb310-9"><a href="plotting-in-r-with-ggplot2.html#cb310-9"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),</span>
<span id="cb310-10"><a href="plotting-in-r-with-ggplot2.html#cb310-10"></a>                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
</div>
<div id="metr" class="section level2" number="7.16">
<h2><span class="header-section-number">7.16</span> metR</h2>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="plotting-in-r-with-ggplot2.html#cb311-1"></a>transect2 =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>( lat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-8</span> <span class="op">&amp;</span>lat <span class="op">&lt;</span><span class="st"> </span><span class="dv">-6</span> <span class="op">&amp;</span><span class="st">  </span>pressure <span class="op">&lt;</span><span class="st"> </span><span class="dv">205</span>)</span>
<span id="cb311-2"><a href="plotting-in-r-with-ggplot2.html#cb311-2"></a></span>
<span id="cb311-3"><a href="plotting-in-r-with-ggplot2.html#cb311-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> transect2,</span>
<span id="cb311-4"><a href="plotting-in-r-with-ggplot2.html#cb311-4"></a>             <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> pressure, <span class="dt">z =</span> fluorescence))<span class="op">+</span></span>
<span id="cb311-5"><a href="plotting-in-r-with-ggplot2.html#cb311-5"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb311-6"><a href="plotting-in-r-with-ggplot2.html#cb311-6"></a><span class="st">  </span><span class="co"># metR::geom_contour2()+</span></span>
<span id="cb311-7"><a href="plotting-in-r-with-ggplot2.html#cb311-7"></a><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">205</span>,<span class="dv">30</span>))<span class="op">+</span></span>
<span id="cb311-8"><a href="plotting-in-r-with-ggplot2.html#cb311-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> transect2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(lon) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(), </span>
<span id="cb311-9"><a href="plotting-in-r-with-ggplot2.html#cb311-9"></a>                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(transect2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(lon) <span class="op">%&gt;%</span></span>
<span id="cb311-10"><a href="plotting-in-r-with-ggplot2.html#cb311-10"></a><span class="st">                                               </span><span class="kw">pull</span>()<span class="op">%&gt;%</span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)))<span class="op">+</span></span>
<span id="cb311-11"><a href="plotting-in-r-with-ggplot2.html#cb311-11"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,.<span class="dv">2</span>))<span class="op">+</span></span>
<span id="cb311-12"><a href="plotting-in-r-with-ggplot2.html#cb311-12"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb311-13"><a href="plotting-in-r-with-ggplot2.html#cb311-13"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concentration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),</span>
<span id="cb311-14"><a href="plotting-in-r-with-ggplot2.html#cb311-14"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb311-15"><a href="plotting-in-r-with-ggplot2.html#cb311-15"></a>                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,</span>
<span id="cb311-16"><a href="plotting-in-r-with-ggplot2.html#cb311-16"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb311-17"><a href="plotting-in-r-with-ggplot2.html#cb311-17"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),</span>
<span id="cb311-18"><a href="plotting-in-r-with-ggplot2.html#cb311-18"></a>                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))<span class="op">+</span></span>
<span id="cb311-19"><a href="plotting-in-r-with-ggplot2.html#cb311-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="st">&quot;Water depth [m]&quot;</span>)<span class="op">+</span></span>
<span id="cb311-20"><a href="plotting-in-r-with-ggplot2.html#cb311-20"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> transect2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(lon) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(), </span>
<span id="cb311-21"><a href="plotting-in-r-with-ggplot2.html#cb311-21"></a>             <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;ivory&quot;</span>)<span class="op">+</span></span>
<span id="cb311-22"><a href="plotting-in-r-with-ggplot2.html#cb311-22"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb311-23"><a href="plotting-in-r-with-ggplot2.html#cb311-23"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>), <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="plotting-in-r-with-ggplot2.html#cb312-1"></a>depth  =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>)</span>
<span id="cb312-2"><a href="plotting-in-r-with-ggplot2.html#cb312-2"></a>algoa =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb312-3"><a href="plotting-in-r-with-ggplot2.html#cb312-3"></a></span>
<span id="cb312-4"><a href="plotting-in-r-with-ggplot2.html#cb312-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(depth)){</span>
<span id="cb312-5"><a href="plotting-in-r-with-ggplot2.html#cb312-5"></a></span>
<span id="cb312-6"><a href="plotting-in-r-with-ggplot2.html#cb312-6"></a>strata =<span class="st"> </span>ctd <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb312-7"><a href="plotting-in-r-with-ggplot2.html#cb312-7"></a><span class="st">  </span><span class="kw">filter</span>(lon <span class="op">&gt;</span><span class="st"> </span><span class="fl">39.3</span> <span class="op">&amp;</span><span class="st"> </span>lon <span class="op">&lt;</span><span class="st"> </span><span class="fl">40.5</span> <span class="op">&amp;</span><span class="st"> </span>lat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-10</span> <span class="op">&amp;</span><span class="st"> </span>pressure <span class="op">==</span><span class="st"> </span>depth[i]) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">9</span>)</span>
<span id="cb312-8"><a href="plotting-in-r-with-ggplot2.html#cb312-8"></a></span>
<span id="cb312-9"><a href="plotting-in-r-with-ggplot2.html#cb312-9"></a>Lon =<span class="st"> </span>strata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(lon)</span>
<span id="cb312-10"><a href="plotting-in-r-with-ggplot2.html#cb312-10"></a>Lat =<span class="st"> </span>strata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(lat)</span>
<span id="cb312-11"><a href="plotting-in-r-with-ggplot2.html#cb312-11"></a>data =<span class="st"> </span>strata <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>)</span>
<span id="cb312-12"><a href="plotting-in-r-with-ggplot2.html#cb312-12"></a></span>
<span id="cb312-13"><a href="plotting-in-r-with-ggplot2.html#cb312-13"></a></span>
<span id="cb312-14"><a href="plotting-in-r-with-ggplot2.html#cb312-14"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq_along</span>(data)){</span>
<span id="cb312-15"><a href="plotting-in-r-with-ggplot2.html#cb312-15"></a>  </span>
<span id="cb312-16"><a href="plotting-in-r-with-ggplot2.html#cb312-16"></a>  algoa.interp =<span class="st"> </span>strata <span class="op">%$%</span><span class="st"> </span>oce<span class="op">::</span><span class="kw">interpBarnes</span>(<span class="dt">x =</span> Lon, <span class="dt">y =</span> Lat, <span class="dt">z =</span> data[j]<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>())</span>
<span id="cb312-17"><a href="plotting-in-r-with-ggplot2.html#cb312-17"></a>  </span>
<span id="cb312-18"><a href="plotting-in-r-with-ggplot2.html#cb312-18"></a>  algoa.tb =<span class="st"> </span>algoa.interp <span class="op">%$%</span><span class="st"> </span></span>
<span id="cb312-19"><a href="plotting-in-r-with-ggplot2.html#cb312-19"></a><span class="st">    </span><span class="kw">matrix_tb</span>(<span class="dt">x =</span> xg, <span class="dt">y =</span> yg, <span class="dt">data =</span> zg) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb312-20"><a href="plotting-in-r-with-ggplot2.html#cb312-20"></a><span class="st">    </span><span class="kw">rename</span>(<span class="dt">lon =</span> x, <span class="dt">lat =</span> y) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb312-21"><a href="plotting-in-r-with-ggplot2.html#cb312-21"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">variable =</span> <span class="kw">colnames</span>(data[j]), <span class="dt">pressure =</span> depth[i])</span>
<span id="cb312-22"><a href="plotting-in-r-with-ggplot2.html#cb312-22"></a>  </span>
<span id="cb312-23"><a href="plotting-in-r-with-ggplot2.html#cb312-23"></a>  algoa =<span class="st"> </span>algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(algoa.tb)</span>
<span id="cb312-24"><a href="plotting-in-r-with-ggplot2.html#cb312-24"></a>  }</span>
<span id="cb312-25"><a href="plotting-in-r-with-ggplot2.html#cb312-25"></a>}</span>
<span id="cb312-26"><a href="plotting-in-r-with-ggplot2.html#cb312-26"></a></span>
<span id="cb312-27"><a href="plotting-in-r-with-ggplot2.html#cb312-27"></a><span class="co"># algoa  %&gt;% group_by(pressure, variable) %&gt;% summarise(average = mean(value, na.rm = TRUE))</span></span></code></pre></div>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="plotting-in-r-with-ggplot2.html#cb313-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb313-2"><a href="plotting-in-r-with-ggplot2.html#cb313-2"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;fluorescence&quot;</span>),</span>
<span id="cb313-3"><a href="plotting-in-r-with-ggplot2.html#cb313-3"></a>              <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb313-4"><a href="plotting-in-r-with-ggplot2.html#cb313-4"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>))<span class="op">+</span></span>
<span id="cb313-5"><a href="plotting-in-r-with-ggplot2.html#cb313-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), </span>
<span id="cb313-6"><a href="plotting-in-r-with-ggplot2.html#cb313-6"></a>                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="op">+</span></span>
<span id="cb313-7"><a href="plotting-in-r-with-ggplot2.html#cb313-7"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>), </span>
<span id="cb313-8"><a href="plotting-in-r-with-ggplot2.html#cb313-8"></a>                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>)))<span class="op">+</span></span>
<span id="cb313-9"><a href="plotting-in-r-with-ggplot2.html#cb313-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pressure)<span class="op">+</span></span>
<span id="cb313-10"><a href="plotting-in-r-with-ggplot2.html#cb313-10"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></span>
<span id="cb313-11"><a href="plotting-in-r-with-ggplot2.html#cb313-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb313-12"><a href="plotting-in-r-with-ggplot2.html#cb313-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span></span>
<span id="cb313-13"><a href="plotting-in-r-with-ggplot2.html#cb313-13"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb313-14"><a href="plotting-in-r-with-ggplot2.html#cb313-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Chlorophyll<span class="op">~</span>concentration<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),</span>
<span id="cb313-15"><a href="plotting-in-r-with-ggplot2.html#cb313-15"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb313-16"><a href="plotting-in-r-with-ggplot2.html#cb313-16"></a>                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,</span>
<span id="cb313-17"><a href="plotting-in-r-with-ggplot2.html#cb313-17"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb313-18"><a href="plotting-in-r-with-ggplot2.html#cb313-18"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),</span>
<span id="cb313-19"><a href="plotting-in-r-with-ggplot2.html#cb313-19"></a>                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-213-1.png" width="672" /></p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="plotting-in-r-with-ggplot2.html#cb314-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb314-2"><a href="plotting-in-r-with-ggplot2.html#cb314-2"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;temperature&quot;</span>),</span>
<span id="cb314-3"><a href="plotting-in-r-with-ggplot2.html#cb314-3"></a>              <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb314-4"><a href="plotting-in-r-with-ggplot2.html#cb314-4"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>))<span class="op">+</span></span>
<span id="cb314-5"><a href="plotting-in-r-with-ggplot2.html#cb314-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), </span>
<span id="cb314-6"><a href="plotting-in-r-with-ggplot2.html#cb314-6"></a>                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="op">+</span></span>
<span id="cb314-7"><a href="plotting-in-r-with-ggplot2.html#cb314-7"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>), </span>
<span id="cb314-8"><a href="plotting-in-r-with-ggplot2.html#cb314-8"></a>                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>)))<span class="op">+</span></span>
<span id="cb314-9"><a href="plotting-in-r-with-ggplot2.html#cb314-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pressure)<span class="op">+</span></span>
<span id="cb314-10"><a href="plotting-in-r-with-ggplot2.html#cb314-10"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></span>
<span id="cb314-11"><a href="plotting-in-r-with-ggplot2.html#cb314-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb314-12"><a href="plotting-in-r-with-ggplot2.html#cb314-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span></span>
<span id="cb314-13"><a href="plotting-in-r-with-ggplot2.html#cb314-13"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb314-14"><a href="plotting-in-r-with-ggplot2.html#cb314-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Temperature<span class="op">~</span>(degree<span class="op">*</span>C)),</span>
<span id="cb314-15"><a href="plotting-in-r-with-ggplot2.html#cb314-15"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb314-16"><a href="plotting-in-r-with-ggplot2.html#cb314-16"></a>                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,</span>
<span id="cb314-17"><a href="plotting-in-r-with-ggplot2.html#cb314-17"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb314-18"><a href="plotting-in-r-with-ggplot2.html#cb314-18"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),</span>
<span id="cb314-19"><a href="plotting-in-r-with-ggplot2.html#cb314-19"></a>                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="plotting-in-r-with-ggplot2.html#cb315-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb315-2"><a href="plotting-in-r-with-ggplot2.html#cb315-2"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;oxygen&quot;</span>),</span>
<span id="cb315-3"><a href="plotting-in-r-with-ggplot2.html#cb315-3"></a>              <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb315-4"><a href="plotting-in-r-with-ggplot2.html#cb315-4"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> oce<span class="op">::</span><span class="kw">oceColors9A</span>(<span class="dv">120</span>))<span class="op">+</span></span>
<span id="cb315-5"><a href="plotting-in-r-with-ggplot2.html#cb315-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), </span>
<span id="cb315-6"><a href="plotting-in-r-with-ggplot2.html#cb315-6"></a>                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LatLabel</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="fl">8.5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="op">+</span></span>
<span id="cb315-7"><a href="plotting-in-r-with-ggplot2.html#cb315-7"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span>), </span>
<span id="cb315-8"><a href="plotting-in-r-with-ggplot2.html#cb315-8"></a>                     <span class="dt">labels =</span> metR<span class="op">::</span><span class="kw">LonLabel</span>(<span class="kw">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="dt">length.out =</span> <span class="dv">3</span>)))<span class="op">+</span></span>
<span id="cb315-9"><a href="plotting-in-r-with-ggplot2.html#cb315-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pressure)<span class="op">+</span></span>
<span id="cb315-10"><a href="plotting-in-r-with-ggplot2.html#cb315-10"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></span>
<span id="cb315-11"><a href="plotting-in-r-with-ggplot2.html#cb315-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb315-12"><a href="plotting-in-r-with-ggplot2.html#cb315-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>))<span class="op">+</span></span>
<span id="cb315-13"><a href="plotting-in-r-with-ggplot2.html#cb315-13"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb315-14"><a href="plotting-in-r-with-ggplot2.html#cb315-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Dissolved<span class="op">~</span>oxygen<span class="op">~</span>(mgm<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})),</span>
<span id="cb315-15"><a href="plotting-in-r-with-ggplot2.html#cb315-15"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb315-16"><a href="plotting-in-r-with-ggplot2.html#cb315-16"></a>                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,</span>
<span id="cb315-17"><a href="plotting-in-r-with-ggplot2.html#cb315-17"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb315-18"><a href="plotting-in-r-with-ggplot2.html#cb315-18"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),</span>
<span id="cb315-19"><a href="plotting-in-r-with-ggplot2.html#cb315-19"></a>                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</span></code></pre></div>
<p><img src="geoMarine_files/figure-html/unnamed-chunk-215-1.png" width="672" /></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="plotting-in-r-with-ggplot2.html#cb316-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb316-2"><a href="plotting-in-r-with-ggplot2.html#cb316-2"></a><span class="st">  </span>metR<span class="op">::</span><span class="kw">geom_contour_fill</span>(<span class="dt">data =</span> algoa <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(variable <span class="op">==</span><span class="st"> &quot;salinity&quot;</span>),</span>
<span id="cb316-3"><a href="plotting-in-r-with-ggplot2.html#cb316-3"></a>              <span class="kw">aes</span>(<span class="dt">x =</span> lon, <span class="dt">y =</span> lat, <span class="dt">z =</span> value), <span class="dt">na.fill =</span> <span class="ot">TRUE</span>, <span class="dt">bins =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb316-4"><a href="plotting-in-r-with-ggplot2.html#cb316-4"></a><span class="st">  </span><span class="co"># scale_fill_gradientn(colours = oce::oceColors9A(120))+</span></span>
<span id="cb316-5"><a href="plotting-in-r-with-ggplot2.html#cb316-5"></a><span class="st">  </span><span class="co"># scale_y_continuous(breaks = seq(-8.5,-6,2.5), </span></span>
<span id="cb316-6"><a href="plotting-in-r-with-ggplot2.html#cb316-6"></a><span class="st">  </span><span class="co">#                    labels = metR::LatLabel(seq(-8.5,-6,2.5)))+</span></span>
<span id="cb316-7"><a href="plotting-in-r-with-ggplot2.html#cb316-7"></a><span class="st">  </span><span class="co"># scale_x_continuous(breaks = seq(39.55,40.25,length.out = 3) %&gt;% round(2), </span></span>
<span id="cb316-8"><a href="plotting-in-r-with-ggplot2.html#cb316-8"></a><span class="st">  </span><span class="co">#                    labels = metR::LonLabel(seq(39.55,40.25,length.out = 3)))+</span></span>
<span id="cb316-9"><a href="plotting-in-r-with-ggplot2.html#cb316-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>pressure)<span class="op">+</span></span>
<span id="cb316-10"><a href="plotting-in-r-with-ggplot2.html#cb316-10"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>)<span class="op">+</span></span>
<span id="cb316-11"><a href="plotting-in-r-with-ggplot2.html#cb316-11"></a><span class="st">  </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb316-12"><a href="plotting-in-r-with-ggplot2.html#cb316-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>))<span class="op">+</span></span>
<span id="cb316-13"><a href="plotting-in-r-with-ggplot2.html#cb316-13"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">expand =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb316-14"><a href="plotting-in-r-with-ggplot2.html#cb316-14"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_colorbar</span>(<span class="dt">title =</span><span class="kw">expression</span>(Salinity),</span>
<span id="cb316-15"><a href="plotting-in-r-with-ggplot2.html#cb316-15"></a>                               <span class="dt">title.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb316-16"><a href="plotting-in-r-with-ggplot2.html#cb316-16"></a>                               <span class="dt">title.hjust =</span> <span class="fl">.5</span>, <span class="dt">raster =</span> <span class="ot">FALSE</span>,</span>
<span id="cb316-17"><a href="plotting-in-r-with-ggplot2.html#cb316-17"></a>                               <span class="dt">title.theme =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="dv">12</span>),</span>
<span id="cb316-18"><a href="plotting-in-r-with-ggplot2.html#cb316-18"></a>                               <span class="dt">label.theme =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>),</span>
<span id="cb316-19"><a href="plotting-in-r-with-ggplot2.html#cb316-19"></a>                               <span class="dt">barheight =</span> <span class="dv">15</span>, <span class="dt">barwidth =</span> <span class="fl">.95</span>))</span></code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-metr">
<p>Campitelli, Elio. 2019. <em>MetR: Tools for Easier Analysis of Meteorological Fields</em>. <a href="https://CRAN.R-project.org/package=metR">https://CRAN.R-project.org/package=metR</a>.</p>
</div>
<div id="ref-ggspatial">
<p>Dunnington, Dewey. 2020. <em>Ggspatial: Spatial Data Framework for Ggplot2</em>. <a href="https://CRAN.R-project.org/package=ggspatial">https://CRAN.R-project.org/package=ggspatial</a>.</p>
</div>
<div id="ref-patchwork">
<p>Pedersen, Thomas Lin. 2020. <em>Patchwork: The Composer of Plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>.</p>
</div>
<div id="ref-ggrepel">
<p>Slowikowski, Kamil. 2020. <em>Ggrepel: Automatically Position Non-Overlapping Text Labels with ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=ggrepel">https://CRAN.R-project.org/package=ggrepel</a>.</p>
</div>
<div id="ref-ggplot">
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
<div id="ref-cowplot">
<p>Wilke, Claus O. 2018. <em>Cowplot: Streamlined Plot Theme and Plot Annotations for ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=cowplot">https://CRAN.R-project.org/package=cowplot</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-grammar-for-graphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["geoMarine.pdf", "geoMarine.epub"],
"toc": {
"collapse": "section",
"toc_depth": 3,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
